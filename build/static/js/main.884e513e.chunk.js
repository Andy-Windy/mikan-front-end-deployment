(this["webpackJsonpmikan-peel"]=this["webpackJsonpmikan-peel"]||[]).push([[0],{134:function(e,a,t){e.exports=t.p+"static/media/cover.d753b4ce.jpeg"},5618:function(e,a,t){e.exports=t(5742)},5742:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(26),c=t.n(l),i=t(5791),o=t(168),u=t(429),m=t(148),s=t.n(m),d=t(433),f=t.n(d),p=Object(o.a)({palette:{primary:s.a,secondary:f.a}}),g=Object(u.a)(p),E=t(34),b=t(25),h=t(181),v=t.n(h),y=t(277),O=t(6),j=t(31),x=t(5778),w=t(81),k=t(428),S=t(97),C=t(5775),_=t(5749),z=t(5745),T=t(153),N=t(476),I=t(5773),D=t(392),A=t(5744),R=t(28),B=Object(w.a)((function(e){return{popover:{pointerEvents:"none"},paper:{padding:e.spacing(1)},listItem:Object(j.a)({},e.breakpoints.up("md"),{paddingTop:0,paddingBottom:0})}}));function W(e){var a=e.name,t=e.to,n=e.sidebarToggle,l=r.a.useState(null),c=Object(O.a)(l,2),i=c[0],o=c[1],u=Object(b.j)({path:t,exact:"/"===t}),m=B(),s=Object(R.a)(),d=Object(A.a)(s.breakpoints.up("md")),f=function(){o(null)},p=Boolean(i);return r.a.createElement("div",null,r.a.createElement(z.a,{button:!0,disableGutters:d,className:m.listItem,onClick:d?null:n,component:E.b,to:t,selected:null!==u},r.a.createElement(k.a,{smDown:!0},r.a.createElement(T.a,{onMouseEnter:function(e){o(e.currentTarget)},onMouseLeave:f},e.children)),r.a.createElement(k.a,{mdUp:!0},r.a.createElement(I.a,{style:{minWidth:"40px"}},e.children),r.a.createElement(D.a,{primary:a}))),r.a.createElement(N.a,{className:m.popover,classes:{paper:m.paper},open:p,anchorEl:i,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},onClose:f,disableRestoreFocus:!0},a))}var F=t(328),L=t(435),P=t.n(L),G=t(437),M=t.n(G),q=t(438),U=t.n(q),V=t(439),H=t.n(V),Y=t(440),$=t.n(Y),J=t(441),K=t.n(J),X=t(436),Q=t.n(X),Z=t(8),ee=t(5807),ae=Object(w.a)((function(e){var a;return{drawer:Object(j.a)({},e.breakpoints.up("md"),{width:80,flexShrink:0}),placeholder:e.mixins.toolbar,drawerPaper:(a={},Object(j.a)(a,e.breakpoints.up("md"),{width:80}),Object(j.a)(a,"width",150),a)}}));function te(e){var a=e.sidebarToggle,t=e.openStatus,n=ae(),l=Object(R.a)(),c=Object(A.a)(l.breakpoints.up("md")),i=Object(Z.d)((function(e){return e.user.privilege})),o=r.a.createElement("span",{style:{height:"100%"}},r.a.createElement(F.a,{style:{height:"100%"},display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch"},r.a.createElement(F.a,null,r.a.createElement("div",{className:n.placeholder}),r.a.createElement(C.a,null),r.a.createElement(_.a,{disablePadding:!0},r.a.createElement(W,{to:"/",name:"\u6f2b\u753b",sidebarToggle:a},r.a.createElement(P.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/magazinePage",name:"\u6742\u5fd7",sidebarToggle:a},r.a.createElement(Q.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/tasks",name:"\u4efb\u52a1",sidebarToggle:a},r.a.createElement(M.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/runningTasks",name:"\u8fdb\u884c\u4e2d\u7684\u4efb\u52a1",sidebarToggle:a},r.a.createElement(ee.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/cloud",name:"\u6587\u4ef6",sidebarToggle:a},r.a.createElement(U.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/users",name:"\u6210\u5458",sidebarToggle:a},r.a.createElement(H.a,{style:c?{fontSize:62}:{}})),i>99&&r.a.createElement(W,{to:"/stat",name:"\u7edf\u8ba1",sidebarToggle:a},r.a.createElement($.a,{style:c?{fontSize:62}:{}})))),i>99&&r.a.createElement(F.a,null,r.a.createElement(C.a,null),r.a.createElement(_.a,null,r.a.createElement(W,{name:"\u7ba1\u7406",sidebarToggle:a},r.a.createElement(K.a,{style:c?{fontSize:62}:{}}))))));return r.a.createElement("nav",{className:n.drawer},r.a.createElement(k.a,{mdUp:!0,implementation:"css"},r.a.createElement(S.a,{variant:"temporary",anchor:"left",open:t,onClose:a,classes:{paper:n.drawerPaper},ModalProps:{keepMounted:!0}},o)),r.a.createElement(k.a,{smDown:!0,implementation:"css"},r.a.createElement(S.a,{classes:{paper:n.drawerPaper},variant:"permanent",open:!0},o)))}var ne=t(345),re=t(183),le=t(443),ce=t.n(le),ie=t(5776),oe=t(446),ue=t.n(oe),me=t(445),se=t.n(me),de=t(5777),fe=t(346),pe=t(403),ge=t(5805),Ee=t(217),be=t.n(Ee),he=t(218),ve=t.n(he),ye=t(281),Oe=t.n(ye),je=t(219),xe=t.n(je),we=t(220),ke=t.n(we),Se=t(282),Ce=t.n(Se),_e=t(283),ze=t.n(_e),Te=t(284),Ne=t.n(Te),Ie=t(285),De=t.n(Ie),Ae=t(150),Re=t.n(Ae);function Be(e){switch(e){case 0:return be.a[500];case 1:return ve.a[300];case 2:return Oe.a[500];case 3:return xe.a[900];case 4:return ke.a[500];case 5:return Ce.a[500];case 6:return ze.a[500];case 7:return Ne.a[600];case 8:return s.a[500];case 9:return De.a[500];case 10:return Re.a[500];default:return Re.a[200]}}function We(e){switch(e){case 0:case 1:case 2:case 3:case 4:return"white";case 5:return"black";case 6:return"white";case 7:case 8:return"black";case 9:return"white";case 10:default:return"black"}}function Fe(e){var a=e.avatar,t=e.name,n=function(e){var a,t=0;for(a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t|=0;return t};return r.a.createElement(ge.a,Object.assign({alt:t,src:a},e,{style:{color:We(n(t)%11),backgroundColor:Be(n(t)%11)}}),t[0]?t[0]:"\u67d1")}var Le=t(444),Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{broadcast:"",snackMsg:{message:""},busy:0,showCherry:!0},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_BROADCAST":return Object.assign({},e,{broadcast:a.broadcast});case"SET_SNACK_MSG":return Object.assign({},e,{snackMsg:a.snackMsg});case"SET_BUSY":return Object.assign({},e,{busy:e.busy+(a.isBusy?1:-1)});case"SET_SHOW_CHERRY":return Object.assign({},e,{showCherry:a.showCherry});default:return e}},Ge=t(11),Me=t.n(Ge),qe="https://api.mikan.mom",Ue=qe+"/user",Ve=qe+"/manga",He=qe+"/magazine";var Ye=t(442),$e=t.n(Ye),Je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{privilege:0,logging:!0},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"FILL_USER":return{uid:a.uid,nickname:a.nickname,avatar:a.avatar,privilege:a.privilege,number_of_notifications:a.number_of_notifications,goo_timestamp:a.goo_timestamp};case"CLEAN_USER":return{privilege:0};case"SET_LOGGING":return Object.assign({},e,{logging:a.logging});case"SET_NOTIFICATIONS":return Object.assign({},e,{number_of_notifications:e.number_of_notifications+a.number});case"SET_GOO":return Object.assign({},e,{goo_timestamp:a.goo_timestamp});default:return e}};function Ke(){return function(){var e=Object(y.a)(v.a.mark((function e(a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(Qe(!0)),a(ta(!0)),e.next=4,Me.a.get(qe+"/profile",{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){a(Object.assign({type:"FILL_USER"},e)),Me.a.get(qe+"/refresh_token",{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){window.localStorage.setItem("access_token",e.access_token)}))})).catch((function(e){console.log("\u672a\u767b\u5f55")})).finally((function(){a(ta(!1)),a(Qe(!1))}));case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()}function Xe(){return{Authorization:"Bearer "+window.localStorage.getItem("access_token")}}function Qe(e){return function(a){a({type:"SET_LOGGING",logging:e})}}function Ze(){var e=new Date;return function(a){a(Object.assign({type:"SET_GOO"},{goo_timestamp:(Date.now()-6e4*e.getTimezoneOffset())/1e3}))}}function ea(){return function(e){"1"===window.localStorage.getItem("noCherry")&&e(na(!1)),Me.a.get(qe+"/env",{params:{key:"broadcast"},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(a){e(ra(a.result))})).catch((function(a){try{console.log(a.response.data.detail),e(aa(a.response.data.detail,"error"))}catch(t){e(aa("\u65e0\u6cd5\u62c9\u53d6\u7ad9\u70b9\uff0c\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return e(ta(!1))}))}}function aa(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(n){return n(Object.assign({type:"SET_SNACK_MSG"},{snackMsg:{message:e,variant:a,dismissable:t}}))}}function ta(e){return function(a){a(Object.assign({type:"SET_BUSY"},{isBusy:e}))}}function na(e){return window.localStorage.setItem("noCherry",e?"0":"1"),function(a){return a(Object.assign({type:"SET_SHOW_CHERRY"},{showCherry:e}))}}function ra(e){return function(a){return a(Object.assign({type:"SET_BROADCAST"},{broadcast:e}))}}function la(e){"string"===typeof e&&(document.title=""!==e?e+"-\u6c49\u5316\u5de5\u623f\u4e5d\u4e5d\u7ec4":"\u6c49\u5316\u5de5\u623f\u4e5d\u4e5d\u7ec4")}function ca(e){if("number"!==typeof e)return"";var a=new Date;return e+=60*a.getTimezoneOffset(),(a=new Date(1e3*e)).getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5"}function ia(e){if("number"!==typeof e)return"";var a=new Date;return e+=60*a.getTimezoneOffset(),(a=new Date(1e3*e)).getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5 "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)}var oa=Object(w.a)((function(e){var a;return{menuButton:(a={},Object(j.a)(a,e.breakpoints.up("md"),{display:"none"}),Object(j.a)(a,"padding",0),a),appBar:{zIndex:e.zIndex.drawer+1},popover:{pointerEvents:"none"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));function ua(e){var a=e.sidebarToggle,t=oa(),n=Object(Z.c)(),l=Object(Z.d)((function(e){return e.user.privilege})),c=Object(Z.d)((function(e){return e.site.busy})),i=Object(Z.d)((function(e){return e.user.logging})),o=Object(Z.d)((function(e){return e.user.number_of_notifications})),u=Object(Z.d)((function(e){return e.user.nickname})),m=Object(Z.d)((function(e){return e.user.avatar})),s=Object(Z.d)((function(e){return e.user.goo_timestamp})),d=r.a.useState(null),f=Object(O.a)(d,2),p=f[0],g=f[1],b=r.a.useState(""),h=Object(O.a)(b,2),v=h[0],y=h[1],j=function(e,a){y(a),g(e.currentTarget)},x=function(){g(null)},w=Boolean(p);return r.a.createElement(ie.a,{position:"fixed",className:t.appBar},r.a.createElement(ne.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(F.a,{display:"flex",justifyContent:"space-between",alignItems:"center"},r.a.createElement(F.a,null,r.a.createElement(re.a,{onClick:a,className:t.menuButton},r.a.createElement(ce.a,null))),r.a.createElement(F.a,null,l>0&&r.a.createElement(re.a,{onMouseEnter:function(e){return j(e,"\u5495~")},onMouseLeave:x,"aria-label":"goo",onClick:function(){n(aa(function(e){if("number"!==typeof e)return"";var a=new Date;return e+=60*a.getTimezoneOffset(),a=new Date(1e3*e),function(e){var a=(e=(e-e%1e3)/1e3)%60,t=(e=(e-a)/60)%60,n=(e=(e-t)/60)%24,r=(e-n)/24;return(0!==r?r+"\u5929":"")+(0!==n||0!==r?("0"+n).slice(-2)+"\u5c0f\u65f6":"")+(0!==t||0!==n||0!==r?("0"+t).slice(-2)+"\u5206\u949f":"")+("0"+a).slice(-2)+"\u79d2"}((new Date).getTime()-a)}(s),"info"))}},r.a.createElement(Le.a,{fontSize:"large"})),l>0&&r.a.createElement(re.a,{onMouseEnter:function(e){return j(e,"\u901a\u77e5")},onMouseLeave:x,"aria-label":"notification",component:E.b,to:"/message"},r.a.createElement(de.a,{badgeContent:o,overlap:"circle",color:"secondary"},r.a.createElement(se.a,{fontSize:"large"}))),r.a.createElement(re.a,{onMouseEnter:function(e){return j(e,u||"\u767b\u5f55")},onMouseLeave:x,"aria-label":"account",component:E.b,to:"/me"},u?r.a.createElement(Fe,{name:u,avatar:m}):r.a.createElement(ue.a,{fontSize:"large"}),i&&r.a.createElement(pe.a,{size:24,className:t.buttonProgress})))))),c>0?r.a.createElement(fe.a,null):r.a.createElement(r.a.Fragment,null),r.a.createElement(N.a,{className:t.popover,classes:{paper:t.paper},open:w,anchorEl:p,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:x,disableRestoreFocus:!0},v))}var ma=t(58),sa=Object(w.a)((function(e){return{placeholder:{height:e.spacing(4)}}}));function da(e){var a=e.ver,t=sa(),l=r.a.useState("0"),c=Object(O.a)(l,2),i=c[0],o=c[1],u=Object(Z.c)();return Object(n.useEffect)((function(){u(ta(!0)),Me.a.get(qe+"/ver",{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){o(e.version)})).catch((function(e){u(aa("\u83b7\u53d6\u540e\u53f0\u7248\u672c\u5931\u8d25","error"))})).finally((function(){return u(ta(!1))}))}),[]),r.a.createElement("div",null,r.a.createElement("div",{className:t.placeholder}),r.a.createElement(C.a,null),r.a.createElement(ma.a,{variant:"body2",color:"textSecondary",align:"center"},"Mikan v",i,", Mikan-Peel v",a))}var fa=Object(w.a)((function(e){var a;return{root:{display:"flex",alignItems:"stretch"},placeholder:e.mixins.toolbar,content:{flexGrow:1},mainArea:(a={minWidth:600,width:600},Object(j.a)(a,e.breakpoints.up("md"),{width:960}),Object(j.a)(a,e.breakpoints.up("lg"),{width:"calc(1280px - ".concat(80,"px)")}),Object(j.a)(a,e.breakpoints.up("xl"),{width:"calc(1920px - ".concat(80,"px)")}),a)}}));var pa=function(e){var a=fa(),t=Object(Z.c)(),n=r.a.useState(!1),l=Object(O.a)(n,2),c=l[0],i=l[1];r.a.useEffect((function(){function e(){return(e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(ea()),e.next=3,t(Ke());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var o=function(){i(!c)};return r.a.createElement("div",{className:a.root},r.a.createElement(x.a,null),r.a.createElement(ua,{sidebarToggle:o}),r.a.createElement(te,{sidebarToggle:o,openStatus:c}),r.a.createElement("main",{className:a.content},r.a.createElement("div",{className:a.placeholder}),e.children,r.a.createElement(da,{ver:"1.0.0"})))},ga=t(5786),Ea=t(80),ba=t.n(Ea),ha=t(226),va=t(5756),ya=t(2),Oa=t(404),ja=t(5803),xa=t(5787),wa=t(5754),ka=t(5757),Sa=t(5755),Ca=t(5780),_a=t(65),za=t(5763),Ta=t(184),Na=t(136);function Ia(e){var a=e.input,t=e.label,n=e.initVal,l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=r.a.useState(!1),m=Object(O.a)(u,2),s=m[0],d=m[1],f=r.a.useState([]),p=Object(O.a)(f,2),g=p[0],E=p[1],b=Object(Z.c)();return r.a.useEffect((function(){i&&!s&&0===g.length&&(d(!0),Me.a.get(Ue,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.users&&E(e.users)})).catch((function(e){b(aa("\u62c9\u53d6\u7528\u6237\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","error"))})).finally((function(){return d(!1)})))}),[i]),r.a.createElement(za.a,Object.assign({open:i,onOpen:function(){return o(!0)},onClose:function(){return o(!1)},loading:s,loadingText:"\u52a0\u8f7d\u4e2d...",noOptionsText:"\u6ca1\u6709\u8fd9\u4e2a\u4eba",options:g},e,{onChange:function(e,t){return a.onChange(t?t.uid:null)},getOptionLabel:function(e){return e.uid},defaultValue:n,renderOption:function(e){return e.nickname+"@"+e.uid},getOptionSelected:function(e,a){return e.uid===a.uid},filterOptions:function(e,a){var t=a.inputValue;return Object(Na.a)(e,t,{keys:["nickname","uid"]})},renderInput:function(e){return r.a.createElement(Ta.a,Object.assign({required:!0},e,{label:t,InputProps:Object(_a.a)({},e.InputProps,{endAdornment:r.a.createElement(r.a.Fragment,null,s?r.a.createElement(pe.a,{size:20}):null,e.InputProps.endAdornment)})}))}}))}function Da(e){var a=e.input,t=e.initVal;return r.a.useEffect((function(){var e=document.createElement("script");e.src="https://imgchr.com/sdk/pup.js",e.setAttribute("data-url","https://imgchr.com/upload"),e.setAttribute("data-auto-insert","direct-links"),e.setAttribute("data-mode","manual"),e.async=!0,document.head.appendChild(e)}),[]),r.a.createElement(F.a,{display:"flex",alignItems:"flex-end"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(Ta.a,{margin:"dense",id:"cover",name:"cover",label:"\u5c01\u9762URL",type:"string",fullWidth:!0,defaultValue:t,onChange:function(e){return a.onChange(e.target.value)}})),r.a.createElement(F.a,null,r.a.createElement(T.a,{"data-chevereto-pup-trigger":!0,"data-target":"#cover",ariant:"contained",color:"secondary",component:"span"},"\u56fe\u5e8a\u4e0a\u4f20")))}var Aa=t(117);function Ra(e){var a=e.input,t=e.label,n=e.initVal,l=e.isRequired,c=Object(Aa.a)(e,["input","label","initVal","isRequired"]),i=r.a.useState(!1),o=Object(O.a)(i,2),u=o[0],m=o[1],s=r.a.useState(!1),d=Object(O.a)(s,2),f=d[0],p=d[1],g=r.a.useState([]),E=Object(O.a)(g,2),b=E[0],h=E[1],v=r.a.useState(null),y=Object(O.a)(v,2),j=y[0],x=y[1],w=Object(Z.c)();return r.a.useEffect((function(){f||0!==b.length||(p(!0),Me.a.get(He,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){if("object"===typeof e.magazines&&(h(e.magazines),n)){var a=e.magazines.find((function(e){return e.id===n}));a&&x(a)}})).catch((function(e){w(aa("\u62c9\u53d6\u6742\u5fd7\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","error"))})).finally((function(){return p(!1)})))}),[u]),r.a.createElement(za.a,Object.assign({open:u,onOpen:function(){return m(!0)},onClose:function(){return m(!1)},loading:f,loadingText:"\u52a0\u8f7d\u4e2d...",noOptionsText:"\u6ca1\u6709\u6b64\u6742\u5fd7",options:b,value:j,onChange:function(e,t){x(t),a.onChange(t?{id:t.id,name:t.name}:null)},getOptionLabel:function(e){return e.name},renderOption:function(e){return e.name+"@"+e.id},getOptionSelected:function(e,a){return e.id===a.id},filterOptions:function(e,a){var t=a.inputValue;return Object(Na.a)(e,t,{keys:["name","id"]})},renderInput:function(e){return r.a.createElement(Ta.a,Object.assign({required:l},e,{label:t,InputProps:Object(_a.a)({},e.InputProps,{endAdornment:r.a.createElement(r.a.Fragment,null,f?r.a.createElement(pe.a,{size:20}):null,e.InputProps.endAdornment)})}))}},c))}var Ba=t(16),Wa=t(21);function Fa(){var e=r.a.useState(!1),a=Object(O.a)(e,2),t=a[0],n=a[1],l=Object(Z.c)(),c=function(){n(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"contained",color:"primary",onClick:function(){n(!0)}},"\u521b\u5efa\u6f2b\u753b"),r.a.createElement(wa.a,{open:t,onClose:c,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ba.b,{onSubmit:function(e){var a;e.cover=document.getElementById("cover").value,e.cherry=!0===e.cherry,e.attribute_magazine=null===(a=e.attribute_magazine)||void 0===a?void 0:a.id,e.ps="",console.log(e),Me.a.put(Ve,e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),l(aa(e.response.data.detail,"error"))}catch(a){l(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u521b\u5efa\u6f2b\u753b"),r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u6f2b\u753b\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u6f2b\u753bID",type:"string",fullWidth:!0,required:!0,helperText:"\u6f2b\u753bID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002\u5efa\u8bae\uff1a\u7f57\u9a6c\u5b57/\u82f1\u6587\u7b80\u5199\u3002"}),r.a.createElement(Ba.a,{component:Ia,name:"producer",label:"\u5236\u4f5c\u4eba",id:"producer"}),r.a.createElement(Ba.a,{component:Ra,name:"attribute_magazine",label:"\u6742\u5fd7",id:"attribute_magazine",fullWidth:!0,isRequired:!1}),r.a.createElement(Ba.a,{component:Da,name:"cover"})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:c,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u521b\u5efa")))}})))}var La=t(5785),Pa=t(5781),Ga=t(5782),Ma=t(5784),qa=t(5783),Ua=t(134),Va=t.n(Ua),Ha=t(430);function Ya(e){switch(e){case"red":return be.a[500];case"pink":return ve.a[300];case"purple":return Oe.a[500];case"indigo":return xe.a[900];case"blue":return ke.a[500];case"cyan":return Ce.a[500];case"teal":return ze.a[500];case"lime":return Ne.a[600];case"orange":return s.a[500];case"brown":return De.a[500];case"grey":return Re.a[500];default:return Re.a[200]}}function $a(e){switch(e){case"red":case"pink":case"purple":case"indigo":case"blue":return"white";case"cyan":return"black";case"teal":return"white";case"lime":case"orange":return"black";case"brown":return"white";case"grey":default:return"black"}}function Ja(e){var a=e.tag,t=e.mid,n=e.cid,l=e.tid,c=e.deletable,i=e.lid,o=Object(Z.c)();return r.a.createElement(Ha.a,Object.assign({style:{backgroundColor:Ya(a.color),color:$a(a.color)},label:a.name,onDelete:"true"===c?function(){var e=2;"string"!==typeof i?("string"!==typeof l&&(e=1),"string"!==typeof n&&(e=0)):e=3,Me.a.post("https://api.mikan.mom/tag_delete",{name:a.name,color:a.color,mid:t,cid:e>0?n:"",tid:e>1?l:"",lid:e<3?"":i,level:e},{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),o(aa(e.response.data.detail,"error"))}catch(a){o(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))}:null},e))}var Ka=Object(w.a)((function(e){var a;return{root:(a={maxWidth:175},Object(j.a)(a,e.breakpoints.up("md"),{maxWidth:275}),Object(j.a)(a,"position","relative"),Object(j.a)(a,"margin",e.spacing(2)),a),labels:{position:"absolute",right:e.spacing(0),top:e.spacing(0)},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)},content:{width:"100%",position:"absolute",bottom:0,backgroundColor:"black",opacity:.8},details:{opacity:1,color:"white"}}}));function Xa(e){var a=Ka(),t=e.manga,l=Object(n.useState)(Va.a),c=Object(O.a)(l,2),i=c[0],o=c[1];return r.a.useEffect((function(){var e=new Image;e.src=t.cover,e.onload=function(){o(t.cover)}}),[]),r.a.createElement(Pa.a,{className:a.root,component:E.b,to:"/manga/"+t.id},r.a.createElement(Ga.a,null,r.a.createElement(qa.a,{component:"img",image:i,title:t.name}),r.a.createElement(F.a,{display:"flex",flexDirection:"row-reverse",flexWrap:"wrap",className:a.labels},"object"===typeof t.tags&&t.tags.map((function(e,t){return r.a.createElement(Ja,{className:a.label,tag:e,size:"small",key:t})}))),r.a.createElement(Ma.a,{className:a.content},r.a.createElement("div",{className:a.details},r.a.createElement(ma.a,{gutterBottom:!0,variant:"h5",component:"h2"},t.name||r.a.createElement(pe.a,null))))))}function Qa(e){var a=e.showFinished,t=Object(n.useState)([]),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(Z.d)((function(e){return e.site.showCherry})),u=Object(Z.c)();return r.a.useEffect((function(){u(ta(!0)),Me.a.get(Ve,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.mangas&&i(e.mangas)})).catch((function(e){u(aa("\u83b7\u53d6\u6f2b\u753b\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return u(ta(!1))}))}),[]),r.a.createElement(La.a,{container:!0,spacing:1},c.map((function(e){if((!e.cherry||o)&&(0===e.status||a))return r.a.createElement(La.a,{item:!0,xs:6,sm:3,md:3,lg:2,key:e.id},r.a.createElement(Xa,{manga:e}))})))}var Za=Object(w.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},cardsArea:{margin:e.spacing(5)},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}}}));function et(e){var a=Za(),t=Object(Z.d)((function(e){return e.user.privilege})),l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=r.a.useState(!1),m=Object(O.a)(u,2),s=m[0],d=m[1],f=Object(Z.d)((function(e){return e.site.showCherry})),p=Object(Z.d)((function(e){return e.site.broadcast}));Object(Z.c)();Object(n.useEffect)((function(){return la("")}),[]);return r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},"\u6c49\u5316\u5de5\u623f"),r.a.createElement(ma.a,{variant:"h2"},"\u4e5d\u4e5d\u7ec4")),r.a.createElement(F.a,{alignSelf:"flex-end"},r.a.createElement(re.a,{className:Object(ya.default)(a.expand,Object(j.a)({},a.expandOpen,i)),onClick:function(){o(!i)},"aria-expanded":i,"aria-label":"\u66f4\u591a\u9009\u9879"},r.a.createElement(ba.a,null)))),r.a.createElement(Oa.a,{className:a.filterArea,in:i,timeout:"auto",unmountOnExit:!0},r.a.createElement(F.a,{flexGrow:1}),r.a.createElement(F.a,{display:"flex",justifyContent:"flex-end"},t>=2&&r.a.createElement(Fa,null),r.a.createElement(ha.a,{checked:s,onChange:function(e){d(e.target.checked)},value:f,size:"small",control:r.a.createElement(va.a,{color:"primary"}),label:"\u663e\u793a\u6c49\u5316\u5b8c\u6210\u7684\u4f5c\u54c1",labelPlacement:"start"}))),""!==p&&r.a.createElement(ja.a,{variant:"outlined",severity:"info"},r.a.createElement(xa.a,null,"\u516c\u544a"),p),r.a.createElement(Qa,{showFinished:s}))}var at=t(135),tt=t(95),nt=t.n(tt),rt=t(453),lt=t.n(rt),ct=t(454),it=t.n(ct),ot=t(358),ut=t.n(ot),mt=t(455),st=t.n(mt),dt=t(359),ft=t.n(dt),pt=t(299),gt=t.n(pt),Et=t(456),bt=t.n(Et),ht=t(457),vt=t.n(ht),yt=t(458),Ot=t.n(yt),jt=t(459),xt=t.n(jt),wt=t(460),kt=t.n(wt),St=t(461),Ct=t.n(St),_t=t(462),zt=t.n(_t),Tt=t(463),Nt=t.n(Tt),It=t(464),Dt=t.n(It),At={Add:Object(n.forwardRef)((function(e,a){return r.a.createElement(lt.a,Object.assign({},e,{ref:a}))})),Check:Object(n.forwardRef)((function(e,a){return r.a.createElement(it.a,Object.assign({},e,{ref:a}))})),Clear:Object(n.forwardRef)((function(e,a){return r.a.createElement(ut.a,Object.assign({},e,{ref:a}))})),Delete:Object(n.forwardRef)((function(e,a){return r.a.createElement(st.a,Object.assign({},e,{ref:a}))})),DetailPanel:Object(n.forwardRef)((function(e,a){return r.a.createElement(ft.a,Object.assign({},e,{ref:a}))})),Edit:Object(n.forwardRef)((function(e,a){return r.a.createElement(gt.a,Object.assign({},e,{ref:a}))})),Export:Object(n.forwardRef)((function(e,a){return r.a.createElement(bt.a,Object.assign({},e,{ref:a}))})),Filter:Object(n.forwardRef)((function(e,a){return r.a.createElement(vt.a,Object.assign({},e,{ref:a}))})),FirstPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(Ot.a,Object.assign({},e,{ref:a}))})),LastPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(xt.a,Object.assign({},e,{ref:a}))})),NextPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(ft.a,Object.assign({},e,{ref:a}))})),PreviousPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(kt.a,Object.assign({},e,{ref:a}))})),ResetSearch:Object(n.forwardRef)((function(e,a){return r.a.createElement(ut.a,Object.assign({},e,{ref:a}))})),Search:Object(n.forwardRef)((function(e,a){return r.a.createElement(Ct.a,Object.assign({},e,{ref:a}))})),SortArrow:Object(n.forwardRef)((function(e,a){return r.a.createElement(zt.a,Object.assign({},e,{ref:a}))})),ThirdStateCheck:Object(n.forwardRef)((function(e,a){return r.a.createElement(Nt.a,Object.assign({},e,{ref:a}))})),ViewColumn:Object(n.forwardRef)((function(e,a){return r.a.createElement(Dt.a,Object.assign({},e,{ref:a}))}))},Rt=Object(w.a)((function(e){return{smallBadge:{minWidth:"14px",width:"14px",height:"14px",fontSize:"10px",padding:"0",borderRadius:"50%"},lightBlueBadge:{backgroundColor:"lightBlue"},lightYellowBadge:{backgroundColor:"rgba(255, 255, 0, 0.5)"},lightRedBadge:{backgroundColor:"rgba(255, 82, 82, 0.5)"}}})),Bt=function(e,a,t){return e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).length},Wt=function(e,a,t){var n=e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).map((function(e){return e.wait_status%4}));return n.length>0?Math.max.apply(Math,Object(at.a)(n)):0};function Ft(e){var a=Rt(),t=Object(b.g)(),n=e.tasks,l=function(e){switch(e){case 1:return"".concat(a.smallBadge," ").concat(a.lightBlueBadge);case 2:return"".concat(a.smallBadge," ").concat(a.lightYellowBadge);case 3:return"".concat(a.smallBadge," ").concat(a.lightRedBadge);default:return a.smallBadge}};return r.a.createElement(nt.a,{icons:At,columns:[{title:"\u6f2b\u753b",field:"mname",defaultGroupOrder:1,render:function(e){var a=e.split("\u9e2a\u9e2a\u9e2a"),t=Object(O.a)(a,2),c=t[0],i=t[1];return r.a.createElement(de.a,{badgeContent:Bt(n,e,i),anchorOrigin:{vertical:"top",horizontal:"right"},overlap:"rectangle",classes:{badge:l(Wt(n,e,i))}},r.a.createElement("span",{style:{paddingRight:"10px"}},c))}},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"},defaultGroupOrder:0},{title:"\u6807\u7b7e",field:"tags",grouping:!1,render:function(e){return r.a.createElement(r.a.Fragment,null,e.tags.map((function(e,a){return r.a.createElement(Ja,{tag:e,size:"small",key:a})})))},sorting:!1},{title:"\u4e0a\u4e00\u6b21\u6d3b\u8dc3",field:"last_update",render:function(e){return ia(e.last_update)},grouping:!1}],options:{pageSize:20,grouping:!0,rowStyle:function(e){return{backgroundColor:{0:"transparent",1:"lightBlue",2:"rgba(255, 255, 0, 0.5)",3:"rgba(255, 82, 82, 0.5)"}[e.wait_status%4]||"transparent"}}},data:n,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,n){t.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})}var Lt=Object(w.a)((function(e){return{title:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},taskListItem:{marginTop:e.spacing(1)}}}));function Pt(){var e=Lt(),a=Object(n.useState)([]),t=Object(O.a)(a,2),l=t[0],c=t[1],i=Object(Z.c)();return Object(n.useEffect)((function(){la("\u4efb\u52a1\u5e7f\u573a"),i(ta(!0)),Me.a.get("https://api.mikan.mom/task",{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=e.tasks.map((function(e){return Object(_a.a)({},e,{mname:"".concat(e.mname,"\u9e2a\u9e2a\u9e2a").concat(e.type)})}));c(a)})).catch((function(e){i(aa("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return i(ta(!1))}))}),[]),r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement("div",{className:e.title},r.a.createElement(ma.a,{variant:"h2"},"\u4efb\u52a1\u5e7f\u573a")),r.a.createElement(Ft,{tasks:l})))}var Gt=t(167),Mt=t.n(Gt),qt=Object(w.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function Ut(){var e=qt(),a=Object(Z.c)(),t=Object(b.g)(),l=(Object(b.h)().state||{from:{pathname:"/"}}).from;Object(n.useEffect)((function(){return la("\u767b\u5f55")}),[]);return r.a.createElement(ga.a,{component:"main",maxWidth:"xs"},r.a.createElement(x.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(ge.a,{className:e.avatar},r.a.createElement(Mt.a,null)),r.a.createElement(ma.a,{component:"h1",variant:"h5"},"\u767b\u5f55"),r.a.createElement("form",{className:e.form,onSubmit:function(e){e.preventDefault(),e.stopPropagation(),a(function(e,a,t,n){return function(r){r(ta(!0)),Me.a.post(qe+"/token",$e.a.stringify({username:e,password:a}),{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){window.localStorage.setItem("access_token",e.access_token),r(Ke()),t.replace(n)})).catch((function(e){try{console.log(e.response.data.detail),r(aa(e.response.data.detail,"error"))}catch(a){r(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return r(ta(!1))}))}}(document.getElementById("uid").value,document.getElementById("pass").value,t,l))}},r.a.createElement(Ta.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"uid",label:"\u7528\u6237ID",name:"uid",autoComplete:"uid",autoFocus:!0}),r.a.createElement(Ta.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"pass",label:"\u5bc6\u7801",type:"password",id:"pass",autoComplete:"current-password"}),r.a.createElement(T.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,type:"submit"},"\u767b\u5f55"))))}var Vt=t(5802),Ht=t(154),Yt=t(307),$t=t(363),Jt=t(353);function Kt(e){var a=e.mid,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=r.a.useState({no1:!0,no2:!1,no4:!0,no8:!0,empty:!1}),o=Object(O.a)(i,2),u=o[0],m=o[1],s=Object(Z.c)(),d=function(){c(!1)},f=function(e){m(Object(_a.a)({},u,Object(j.a)({},e.target.name,e.target.checked)))};return r.a.createElement("div",null,r.a.createElement(T.a,{color:"primary",onClick:function(){c(!0)},variant:"outlined"},"\u65b0\u5efa\u7ae0\u8282"),r.a.createElement(wa.a,{open:l,onClose:d,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u65b0\u5efa\u7ae0\u8282"),r.a.createElement(Ba.b,{onSubmit:function(e){var t=u.no1?1:0;t+=u.no2?2:0,t+=u.no4?4:0,t+=u.no8?8:0,t+=u.empty?16:0,e.ps="",Me.a.put(Ve+"/"+a+"/chapter",e,{params:{type:t},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),s(aa(e.response.data.detail,"error"))}catch(a){s(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u7ae0\u8282\u6807\u9898",type:"string",fullWidth:!0,required:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u7ae0\u8282ID",type:"string",fullWidth:!0,required:!0,helperText:"\u7ae0\u8282ID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u540c\u4e00\u6f2b\u753b\u5185\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002"}),r.a.createElement(Ht.a,{component:"fieldset"},r.a.createElement(Yt.a,{component:"legend"},"\u81ea\u5b9a\u4e49\u4efb\u52a1\u6d41\u7a0b"),r.a.createElement($t.a,{row:!0},r.a.createElement(ha.a,{control:r.a.createElement(Jt.a,{checked:u.no1,onChange:f,name:"no1"}),label:"\u65e0\u56fe\u6e90",disabled:u.empty}),r.a.createElement(ha.a,{control:r.a.createElement(Jt.a,{checked:u.no2,onChange:f,name:"no2"}),label:"\u65e0\u6821\u5bf9",disabled:u.empty}),r.a.createElement(ha.a,{control:r.a.createElement(Jt.a,{checked:u.no4,onChange:f,name:"no4"}),label:"\u65e0\u5ba1\u6838",disabled:u.empty}),r.a.createElement(ha.a,{control:r.a.createElement(Jt.a,{checked:u.no8,onChange:f,name:"no8"}),label:"\u65e0\u53d1\u5e03",disabled:u.empty}),r.a.createElement(ha.a,{control:r.a.createElement(Jt.a,{checked:u.empty,onChange:f,name:"empty"}),label:"\u7a7a\u9879\u76ee"})))),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:d,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}var Xt=t(5800),Qt=t(5799),Zt=t(5760),en=t(5798),an=t(265),tn=t.n(an),nn=t(266),rn=t.n(nn),ln=t(465),cn=t.n(ln),on=t(267),un=t.n(on),mn=t(268),sn=t.n(mn),dn=t(269),fn=t.n(dn),pn=t(270),gn=t.n(pn);function En(e){return{0:r.a.createElement(tn.a,null),1:r.a.createElement(rn.a,null),2:r.a.createElement(cn.a,null),3:r.a.createElement(un.a,null),4:r.a.createElement(sn.a,null),5:r.a.createElement(fn.a,null),6:r.a.createElement(gn.a,null)}[e]}function bn(e){var a=e.label;return r.a.createElement("div",null,r.a.createElement(Ha.a,Object.assign({},e,{variant:""===a.accept_by.uid?"outlined":"default",icon:En(a.type),color:0===a.status||1===a.status?"primary":2===a.status?"secondary":"",size:"small",label:a.name,clickable:!0,"aria-label":"Task Chip",to:"/manga/"+a.mid+"/"+a.cid+"/"+a.id})))}function hn(e){var a=e.user,t=Object(b.g)();if(void 0===a)return r.a.createElement(r.a.Fragment,null);return r.a.createElement(Ha.a,Object.assign({variant:"outlined","aria-label":"User Chip",onClick:function(){t.push("/user/"+a.uid)},clickable:!0,avatar:r.a.createElement(Fe,{avatar:a.avatar,name:a.nickname}),label:a.nickname},e))}var vn=Object(w.a)((function(e){return{root:{width:"100%"},nominee:{marginBottom:10},completed:{color:e.palette.primary}}}));function yn(e){var a=vn(),t=e.vertical,n=e.chapter,l=e.mid,c=n.tasks,i=n.id;return r.a.createElement("div",{className:a.root},r.a.createElement(Xt.a,{alternativeLabel:!t,nonLinear:!0,activeStep:-1,orientation:t?"vertical":"horizontal"},c.map((function(e,a){return r.a.createElement(en.a,{key:e.name},r.a.createElement(Qt.a,{component:E.b,to:"/manga/"+l+"/"+i+"/"+e.id,completed:1===e.status},r.a.createElement(Zt.a,null,r.a.createElement(bn,{label:e}))),0!==e.accept_on&&(t?r.a.createElement(Zt.a,{icon:r.a.createElement("span",{style:{display:"inline-block",width:"24px",height:"24px"}})},r.a.createElement(hn,{user:e.accept_by,size:"small",style:{marginTop:"5px"}})):r.a.createElement(Zt.a,{icon:null},r.a.createElement(hn,{user:e.accept_by,size:"small"}))))}))))}var On=t(5806),jn=t(5794),xn=t(5795),wn=t(5793),kn=t(5792),Sn=t(474),Cn=t(348);function _n(e){var a=e.chapter,t=e.order,n=Object(Z.c)(),l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=function(){o(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,{size:"small",color:"primary",onClick:function(){o(!0)}},"\u65b0\u5efa\u4efb\u52a1"),r.a.createElement(wa.a,{open:i,onClose:u,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u65b0\u5efa\u4efb\u52a1"),r.a.createElement(Ba.b,{onSubmit:function(e){console.log(e),Me.a.put(Ve+"/"+a.mid+"/chapter/"+a.id+"/task",e,{params:{order:t},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),n(aa(e.response.data.detail,"error"))}catch(a){n(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},initialValues:{type:0},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Sa.a,null,r.a.createElement(Wa.b,{name:"type",label:"\u7c7b\u578b",required:!0},r.a.createElement(Cn.a,{value:0},En(0),"\u5176\u4ed6"),r.a.createElement(Cn.a,{value:1},En(1),"\u56fe\u6e90"),r.a.createElement(Cn.a,{value:2},En(2),"\u7ffb\u8bd1"),r.a.createElement(Cn.a,{value:3},En(3),"\u6821\u5bf9"),r.a.createElement(Cn.a,{value:4},En(4),"\u5d4c\u5b57"),r.a.createElement(Cn.a,{value:5},En(5),"\u5ba1\u6838"),r.a.createElement(Cn.a,{value:6},En(6),"\u53d1\u5e03")),r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u4efb\u52a1\u6807\u9898",type:"string",required:!0,fullWidth:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u4efb\u52a1ID",type:"string",required:!0,fullWidth:!0})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:u,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}var zn=t(5779),Tn=t(466),Nn=t.n(Tn);function In(e){var a=e.chapter,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=Object(Z.c)(),o=Object(b.g)(),u=function(){c(!1)},m=r.a.useState([]),s=Object(O.a)(m,2),d=s[0],f=s[1];r.a.useEffect((function(){for(var e=a.tasks.slice(),t=0;t<e.length;t++)e[t].order=t;f(e)}),[]);return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"outlined",size:"small",color:"primary",onClick:function(){c(!0)}},"\u7f16\u8f91\u7ae0\u8282"),r.a.createElement(wa.a,{open:l,onClose:u,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u7f16\u8f91\u7ae0\u8282"),r.a.createElement(Ba.b,{onSubmit:function(e){e.tasks=d.map((function(e){return e.order})),e.ps=e.ps?e.ps:"",console.log(e),Me.a.post(Ve+"/"+a.mid+"/chapter/"+a.id,e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){e.id!==a.id&&o.replace("/manga/"+e.mid),window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),i(aa(e.response.data.detail,"error"))}catch(a){i(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},initialValues:{name:a.name,id:a.id,ps:a.ps},render:function(e){var t=e.handleSubmit;return r.a.createElement("form",{onSubmit:t},r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{margin:"dense",name:"name",label:"\u7ae0\u8282\u6807\u9898",type:"string",fullWidth:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u7ae0\u8282ID",type:"string",fullWidth:!0,helperText:"\u7ae0\u8282ID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u540c\u4e00\u6f2b\u753b\u5185\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002\u5efa\u8bae\uff1a\u7ae0\u8282\u6570\u5b57\u3002"}),r.a.createElement(Wa.c,{name:"ps",label:"\u5099\u8003",multiline:!0,rowsMax:5}),r.a.createElement(_.a,{subheader:r.a.createElement(zn.a,{component:"div"},r.a.createElement(F.a,{display:"flex",flexDirection:"row",alignItems:"flex-end"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(kn.a,null,"\u4efb\u52a1")),r.a.createElement(F.a,null,r.a.createElement(_n,{chapter:a,order:a.tasks.length}))))},r.a.createElement(Sn.a,{list:d,setList:f,animation:150},d.map((function(e,a){return r.a.createElement(z.a,{key:a},r.a.createElement(I.a,null,En(e.type)),r.a.createElement(D.a,{primary:e.name}),r.a.createElement(Nn.a,null))}))))),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:u,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}function Dn(e){var a=e.id,t=e.name,n=e.api,l=e.callback,c=e.reload,i=Object(Aa.a)(e,["id","name","api","callback","reload"]),o=r.a.useState(!1),u=Object(O.a)(o,2),m=u[0],s=u[1],d=r.a.useState(),f=Object(O.a)(d,2),p=f[0],g=f[1],E=Object(Z.c)(),h=Object(b.g)(),v=function(){s(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,Object.assign({variant:"contained",color:"secondary",onClick:function(){s(!0)}},i),"\u5220\u9664",t),r.a.createElement(wa.a,{open:m,onClose:v,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u786e\u8ba4\u5220\u9664"),r.a.createElement(Sa.a,null,r.a.createElement(kn.a,null,"\u5220\u9664\u540e\u5c06\u4e0d\u53ef\u6062\u590d"),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(kn.a,null,"\u8bf7\u5728\u4e0b\u65b9\u91cd\u590d\u8f93\u5165ID\u4ee5\u786e\u8ba4"),r.a.createElement(Ta.a,{autoFocus:!0,margin:"dense",name:"name",label:a,type:"string",onChange:function(e){g(e.target.value)},fullWidth:!0,required:!0}))),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:v,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{onClick:function(){Me.a.delete(n,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){c&&window.location.reload(),h.replace(l)})).catch((function(e){try{console.log(e.response.data.detail),E(aa(e.response.data.detail,"error"))}catch(a){E(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},variant:"contained",color:"secondary",disabled:p!==a},"\u5220\u9664"))))}var An=Object(w.a)((function(e){return{root:{width:"100%"},rootExpanded:{width:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15)},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},details:{alignItems:"center"},taskChip:{marginRight:e.spacing(1)},summary:{width:"100%"}}}));function Rn(e){var a=An(),t=Object(R.a)(),n=Object(A.a)(t.breakpoints.up("md")),l=e.chapter,c=e.adminAuth,i=e.mid,o=e.expanded,u=e.setExpanded;return r.a.createElement("div",{className:o===l.id?a.rootExpanded:a.root},r.a.createElement(On.a,{TransitionProps:{unmountOnExit:!0},expanded:o===l.id,onChange:function(){o===l.id?u(""):u(l.id)}},r.a.createElement(xn.a,{expandIcon:r.a.createElement(ba.a,null),"aria-controls":"chapter-summary"},r.a.createElement(F.a,{display:"flex",flexDirection:"row",className:a.summary},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{className:a.heading,noWrap:!0},l.name)),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},l.tasks.map((function(e,t){return 0===e.status&&r.a.createElement(bn,{label:e,key:t,className:a.taskChip,component:E.b})}))))),r.a.createElement(jn.a,{className:a.details},r.a.createElement(F.a,{display:"flex",flexDirection:"column",className:a.summary},r.a.createElement(yn,{vertical:!n,chapter:l,mid:i}),r.a.createElement(ma.a,{className:a.secondaryHeading},l.ps))),c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(wn.a,null,r.a.createElement(Dn,{api:Ve+"/"+i+"/chapter/"+l.id,callback:"/manga/"+i,className:a.button,size:"small",variant:"outlined",reload:!0}),r.a.createElement(In,{chapter:l})))))}var Bn=t(5804),Wn=t(5789),Fn=Object(w.a)((function(e){return{root:{width:"100%"}}}));function Ln(e){var a=Fn(),t=e.mid,n=e.adminAuth,l=r.a.useState(0),c=Object(O.a)(l,2),i=c[0],o=c[1];return r.a.createElement("div",{className:a.root},r.a.createElement(ie.a,{position:"static",color:"transparent"},r.a.createElement(Bn.a,{value:i,onChange:function(e,a){o(a)}},r.a.createElement(Wn.a,{label:"\u672a\u5b8c\u6210"}),r.a.createElement(Wn.a,{label:"\u5df2\u5b8c\u6210"}))),r.a.createElement(Pn,{mid:t,listName:i,adminAuth:n}))}function Pn(e){var a=e.mid,t=e.listName,l=e.adminAuth,c=Object(n.useState)(!0),i=Object(O.a)(c,2),o=i[0],u=i[1],m=Object(n.useState)([]),s=Object(O.a)(m,2),d=s[0],f=s[1],p=Object(n.useState)(""),g=Object(O.a)(p,2),E=g[0],b=g[1],h=Object(Z.c)();return r.a.useEffect((function(){u(!0),f([]),Me.a.get(Ve+"/"+a+"/chapter",{params:{query_status:t},withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.chapters&&f(e.chapters)})).catch((function(e){h(aa("\u62c9\u53d6\u5217\u8868\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return u(!1)}))}),[t]),r.a.createElement(r.a.Fragment,null,o?r.a.createElement(fe.a,null):d.map((function(e){return r.a.createElement(Rn,{chapter:e,adminAuth:l,mid:a,key:e.id,expanded:E,setExpanded:b})})))}function Gn(e){var a=e.manga,t=Object(Z.d)((function(e){return e.user.privilege})),n=r.a.useState(!1),l=Object(O.a)(n,2),c=l[0],i=l[1],o=Object(Z.c)(),u=Object(b.g)(),m=function(){i(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"outlined",color:"primary",size:"small",onClick:function(){i(!0)}},"\u7f16\u8f91\u6f2b\u753b"),r.a.createElement(wa.a,{open:c,onClose:m,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ba.b,{initialValues:{name:a.name,id:a.id,cherry:a.cherry,status:1===a.status,ps:a.ps,status_at_magazine:1===a.status_at_magazine},onSubmit:function(e){var t;e.producer=document.getElementById("producer").value,e.cover=document.getElementById("cover").value,e.attribute_magazine=null===(t=e.attribute_magazine)||void 0===t?void 0:t.id,e.cherry=!0===e.cherry,e.status=!0===e.status?1:0,e.ps=e.ps?e.ps:"",e.status_at_magazine=!0===e.status_at_magazine?1:0,Me.a.post(Ve+"/"+a.id,e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){e.id!==a.id&&u.replace("/manga/"+e.id),window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),o(aa(e.response.data.detail,"error"))}catch(a){o(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var n=e.handleSubmit;return r.a.createElement("form",{onSubmit:n},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u7f16\u8f91\u6f2b\u753b"),r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u6f2b\u753b\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u6f2b\u753bID",type:"string",fullWidth:!0,required:!0,helperText:"\u6f2b\u753bID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002"}),r.a.createElement(Wa.a,{name:"status",data:{label:"\u6c49\u5316\u5b8c\u6210",value:"cherry"}}),r.a.createElement(Wa.a,{name:"status_at_magazine",data:{label:"\u5df2\u5b8c\u7ed3",value:"status_at_magazine"}}),r.a.createElement(Ba.a,{component:Ia,name:"producer",label:"\u5236\u4f5c\u4eba",id:"producer",disabled:t<2,initVal:a.producer,style:{marginBottom:"7px"}}),r.a.createElement(Ba.a,{component:Ra,name:"attribute_magazine",label:"\u6742\u5fd7",id:"attribute_magazine",fullWidth:!0,isRequired:!1,initVal:a.attribute_magazine}),r.a.createElement(Ba.a,{component:Da,name:"cover",initVal:a.cover}),r.a.createElement(Wa.c,{name:"ps",label:"\u5099\u8003",multiline:!0,rowsMax:5})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:m,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fee\u6539")))}})))}function Mn(e){if(!e)return"";var a=new Date(1e3*e),t=a.getUTCFullYear(),n=String(a.getUTCMonth()+1),r=String(a.getUTCDate()),l=String(a.getUTCHours()),c=String(a.getUTCMinutes());return"".concat(t,"\u5e74").concat(n,"\u6708").concat(r,"\u65e5 ").concat(l,"\u65f6").concat(c,"\u5206")}function qn(e){var a=Object(b.g)(),t=e.auths;return r.a.createElement(nt.a,{icons:At,columns:[{title:"\u7528\u6237",field:"nickname"},{title:"\u5b8c\u6210\u8bdd\u6570",field:"count"},{title:"\u6700\u8fd1\u6d3b\u8dc3",field:"lastComplete",render:function(e){return ca(e.lastComplete)}}],options:{pageSize:7,paging:!1},data:t,components:{Pagination:function(){return null},Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,t,n){a.push("/user/"+t.accept_uid)}})}var Un=Object(w.a)((function(e){return{root:{width:"100%"},tabsWrap:{"& .MuiTabs-scrollableX":{overflowX:"auto"},"& .MuiTabs-flexContainer":{justifyContent:"space-around",flexWrap:"wrap"},"& .MuiTab-root":{minWidth:"33%",textAlign:"center"}}}}));function Vn(e){var a=Un(),t=e.mid,n=r.a.useState(0),l=Object(O.a)(n,2),c=l[0],i=l[1],o=r.a.useState(!1),u=Object(O.a)(o,2),m=u[0],s=u[1],d=r.a.useState("\u8fd1\u671f"),f=Object(O.a)(d,2),p=f[0],g=f[1];return r.a.createElement("div",{className:a.root},r.a.createElement(La.a,{container:!0,alignItems:"center",spacing:0},r.a.createElement(La.a,{item:!0,xs:!0},r.a.createElement(Bn.a,{value:c,onChange:function(e,a){i(a)},className:a.tabsWrap},r.a.createElement(Wn.a,{label:"\u7ffb\u8bd1"}),r.a.createElement(Wn.a,{label:"\u6821\u5bf9"}),r.a.createElement(Wn.a,{label:"\u5d4c\u5b57"}))),r.a.createElement(La.a,{item:!0},r.a.createElement(T.a,{variant:"outlined",onClick:function(){g(m?"\u8fd1\u671f":"\u6240\u6709"),s(!m)},style:{borderColor:"lightblue",color:"#34ACE8","&:hover":{backgroundColor:"lightblue",borderColor:"lightblue"}}},p))),r.a.createElement(Hn,{mid:t,listNumber:c,isAll:m}))}function Hn(e){var a=e.mid,t=e.listNumber,l=e.isAll,c=Object(n.useState)(!0),i=Object(O.a)(c,2),o=(i[0],i[1]),u=Object(n.useState)([]),m=Object(O.a)(u,2),s=m[0],d=m[1],f=Object(Z.c)();return r.a.useEffect((function(){void 0!==a&&null!==a&&(o(!0),d([]),Me.a.get("".concat(Ve,"/").concat(a,"/chapterAuth"),{params:{query_status:t,is_all_flag:l},withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.chapterauth&&d(e.chapterauth)})).catch((function(e){f(aa("\u62c9\u53d6\u5217\u8868\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return o(!1)})))}),[a,t,l]),r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement(qn,{auths:s}))}var Yn=t(5796),$n=Object(w.a)((function(e){return{root:{width:"100%",marginTop:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15)},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},details:{alignItems:"center"},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}}}));function Jn(e){var a=$n(),t=e.manga,n=e.adminAuth,l=r.a.useState(!0),c=Object(O.a)(l,2),i=c[0],o=c[1];return r.a.createElement(F.a,{display:"flex",flexDirection:"column",className:a.root},r.a.createElement(F.a,{display:"flex"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},"\u8be6\u7ec6\u4fe1\u606f")),r.a.createElement(F.a,{alignSelf:"flex-end"},r.a.createElement(re.a,{className:Object(ya.default)(a.expand,Object(j.a)({},a.expandOpen,i)),onClick:function(){o(!i)},"aria-expanded":i,"aria-label":"\u8be6\u60c5"},r.a.createElement(ba.a,null)))),r.a.createElement(Oa.a,{in:i,timeout:"auto",unmountOnExit:!0},r.a.createElement(jn.a,{className:a.details},r.a.createElement(F.a,{display:"flex",flexDirection:"column",style:{width:"100%"}},r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u5236\u4f5c\u4eba")),r.a.createElement(F.a,null,r.a.createElement(hn,{user:t.producer,size:"small"}))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u5f00\u5751\u65f6\u95f4")),r.a.createElement(F.a,null,ca(t.create_on))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u6700\u540e\u4e00\u6b21\u6d3b\u8dc3")),r.a.createElement(F.a,null,ca(t.last_update))),t.magazine_name&&r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u6240\u5c5e\u6742\u5fd7")),r.a.createElement(F.a,null,r.a.createElement(Yn.a,{component:E.b,to:"/magazine/"+t.attribute_magazine,color:"inherit"},t.magazine_name)||r.a.createElement(Vt.a,null))),0!==t.next_update_time&&0===t.status_at_magazine&&0===t.magazine_status&&r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u4e0b\u4e00\u6b21\u66f4\u65b0\u65f6\u95f4\uff08\u65e5\u672c\u65f6\u95f4\uff09")),r.a.createElement(F.a,null,Mn(t.next_update_time))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u72b6\u6001")),r.a.createElement(F.a,null,0===t.status_at_magazine&&0===t.magazine_status?"\u8fde\u8f7d\u4e2d":"\u5df2\u5b8c\u7ed3")),r.a.createElement(F.a,null,r.a.createElement(ma.a,{paragraph:!0},t.ps)))),r.a.createElement(C.a,null),r.a.createElement(wn.a,null,n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Dn,{api:Ve+"/"+t.id,size:"small",variant:"outlined",callback:"",className:a.button,id:t.id,name:"\u6f2b\u753b"}),r.a.createElement(Gn,{manga:t})))),r.a.createElement(Vn,{mid:t.id}))}var Kn=t(288);function Xn(e){var a=r.a.useState(!1),t=Object(O.a)(a,2),n=t[0],l=t[1],c=e.level,i=e.mid,o=e.cid,u=e.tid,m=e.lid,s=Object(Z.c)(),d=function(){l(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ha.a,Object.assign({label:"+",size:"small",clickable:!0,onClick:function(){l(!0)}},e)),r.a.createElement(wa.a,{open:n,onClose:d,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u6dfb\u52a0\u6807\u7b7e"),r.a.createElement(Ba.b,{onSubmit:function(e){e.level=c,e.mid=i,e.cid="string"===typeof o?o:"",e.tid="string"===typeof u?u:"",e.lid="string"===typeof m?m:"",Me.a.put("https://api.mikan.mom/tag",e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),s(aa(e.response.data.detail,"error"))}catch(a){s(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(Kn.a,null,"\u989c\u8272"),r.a.createElement(Wa.b,{name:"color",required:!0},r.a.createElement(Cn.a,{value:"red"},r.a.createElement(Ja,{tag:{color:"red",name:"\u7ea2\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"pink"},r.a.createElement(Ja,{tag:{color:"pink",name:"\u7c89\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"blue"},r.a.createElement(Ja,{tag:{color:"blue",name:"\u84dd\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"purple"},r.a.createElement(Ja,{tag:{color:"purple",name:"\u7d2b\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"indigo"},r.a.createElement(Ja,{tag:{color:"indigo",name:"\u975b\u84dd\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"cyan"},r.a.createElement(Ja,{tag:{color:"cyan",name:"\u9752\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"teal"},r.a.createElement(Ja,{tag:{color:"teal",name:"\u6c34\u9e2d\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"lime"},r.a.createElement(Ja,{tag:{color:"lime",name:"\u7eff\u9ec4\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"orange"},r.a.createElement(Ja,{tag:{color:"orange",name:"\u6a58\u9ec4\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"brown"},r.a.createElement(Ja,{tag:{color:"brown",name:"\u68d5\u8272"},size:"small",clickable:!0})),r.a.createElement(Cn.a,{value:"gray"},r.a.createElement(Ja,{tag:{color:"gray",name:"\u7070\u8272"},size:"small",clickable:!0})))),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:d,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{onClick:a,color:"primary"},"\u6dfb\u52a0")))}})))}function Qn(e){var a=e.task,t=Object(Z.c)(),n=Object(b.g)(),l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=function(){o(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,Object.assign({variant:"outlined",size:"small",color:"primary",onClick:function(){o(!0)}},e),"\u7f16\u8f91\u4efb\u52a1"),r.a.createElement(wa.a,{open:i,onClose:u,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u7f16\u8f91\u4efb\u52a1"),r.a.createElement(Ba.b,{onSubmit:function(e){console.log(e),Me.a.post(Ve+"/"+a.mid+"/chapter/"+a.cid+"/task/"+a.id,e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){e.id!==a.id&&n.replace("/manga/"+e.mid+"/"+e.cid+"/"+e.id),window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),t(aa(e.response.data.detail,"error"))}catch(a){t(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},initialValues:{type:a.type,name:a.name,id:a.id},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Sa.a,null,r.a.createElement(Wa.b,{name:"type",label:"\u7c7b\u578b",required:!0},r.a.createElement(Cn.a,{value:0},En(0),"\u5176\u4ed6"),r.a.createElement(Cn.a,{value:1},En(1),"\u56fe\u6e90"),r.a.createElement(Cn.a,{value:2},En(2),"\u7ffb\u8bd1"),r.a.createElement(Cn.a,{value:3},En(3),"\u6821\u5bf9"),r.a.createElement(Cn.a,{value:4},En(4),"\u5d4c\u5b57"),r.a.createElement(Cn.a,{value:5},En(5),"\u5ba1\u6838"),r.a.createElement(Cn.a,{value:6},En(6),"\u53d1\u5e03")),r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u4efb\u52a1\u6807\u9898",type:"string",required:!0,fullWidth:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u4efb\u52a1ID",type:"string",required:!0,fullWidth:!0})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:u,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}function Zn(e){return r.a.createElement(r.a.Fragment,null)}var er=t(467),ar=t.n(er),tr=t(468),nr=t.n(tr);function rr(e){var a=e.status,t=Object(Aa.a)(e,["status"]);return r.a.createElement(r.a.Fragment,null,0===a&&r.a.createElement(gt.a,t),1===a&&r.a.createElement(ar.a,t),2===a&&r.a.createElement(nr.a,t))}var lr=t(347),cr=t(5762),ir=Object(w.a)((function(e){return{root:{width:"100%"},listItem:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(1)},button:{marginLeft:e.spacing(1)}}})),or=function(e){switch(e%4){case 1:return{color:"lightBlue",label:"\u4e09\u6210\u719f"};case 2:return{color:"rgba(255, 255, 0, 0.5)",label:"\u4e94\u6210\u719f"};case 3:return{color:"rgba(255, 82, 82, 0.5)",label:"\u4e03\u6210\u719f"};default:return{color:"rgba(46, 255, 60, 0.7)",label:"\u65b0\u9c9c"}}};function ur(e){var a=ir(),t=e.task,l=e.adminAuth,c=Object(n.useState)(),i=Object(O.a)(c,2),o=i[0],u=i[1],m=Object(Z.c)();r.a.useEffect((function(){u(t)}),[t]);return r.a.createElement("div",{className:a.root},r.a.createElement(F.a,{display:"flex",flexDirection:"column"},r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h6"},"\u627f\u63a5\u4eba")),r.a.createElement(F.a,null,o&&""!==o.accept_by.uid&&r.a.createElement(hn,{user:o.accept_by,onDelete:l&&(0===o.status||2===o.status)&&function(){m(ta(!0)),Me.a.delete(Ve+"/"+o.mid+"/chapter/"+o.cid+"/task/"+o.id+"/charge",{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){u(Object.assign({},o,{accept_by:{uid:"",nickname:"",avatar:""}}))})).catch((function(e){try{console.log(e.response.data.detail),m(aa(e.response.data.detail,"error"))}catch(a){m(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return m(ta(!1))}))}}),o&&""===o.accept_by.uid&&r.a.createElement(mr,Object.assign({taskState:o,setTaskState:u},e)))),r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h6"},"\u72b6\u6001")),r.a.createElement(F.a,null,r.a.createElement(ma.a,{variant:"h6"},o&&0===o.status&&r.a.createElement(rr,{status:0}),o&&1===o.status&&r.a.createElement(rr,{status:1}),o&&2===o.status&&r.a.createElement(rr,{status:2}))),r.a.createElement(F.a,null,o&&r.a.createElement(sr,Object.assign({taskState:o,setTaskState:u},e)))),o&&null!==o.wait_status&&0===o.status&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h6"},"\u9e3d\u5ea6")),console.log(o),r.a.createElement(dr,Object.assign({taskState:o,setTaskState:u},e)))),o&&""!==o.accept_by.uid&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u627f\u63a5\u65f6\u95f4")),r.a.createElement(F.a,null,ia(o.accept_on)))),o&&1===o.status&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u5b8c\u6210\u65f6\u95f4")),r.a.createElement(F.a,null,ia(o.complete_on)))),r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u521b\u5efa\u65f6\u95f4")),r.a.createElement(F.a,null,o&&ia(o.create_on)))),r.a.createElement(Zn,{data:o&&o.data}))}function mr(e){var a=ir(),t=e.taskState,l=e.adminAuth,c=e.setTaskState,i=Object(Z.d)((function(e){return e.user.privilege})),o=Object(Z.d)((function(e){return e.user.uid})),u=Object(Z.c)(),m=Object(n.useState)(!1),s=Object(O.a)(m,2),d=s[0],f=s[1],p=function(){f(!1)},g=function(e){return function(){e===o&&u(Ze()),u(ta(!0)),Me.a.get(Ve+"/"+t.mid+"/chapter/"+t.cid+"/task/"+t.id+"/charge",{params:{assign_to:e},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){c(e)})).catch((function(e){try{console.log(e.response.data.detail),u(aa(e.response.data.detail,"error"))}catch(a){u(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return u(ta(!1))}))}};return 0===i?r.a.createElement(ma.a,null,"\u65e0"):r.a.createElement(r.a.Fragment,null,l&&r.a.createElement(T.a,{variant:"contained",color:"primary",onClick:function(){f(!0)},className:a.button},"\u5206\u914d"),0===t.status&&r.a.createElement(T.a,{variant:"contained",color:"primary",onClick:g(o),className:a.button},"\u627f\u63a5"),r.a.createElement(wa.a,{open:d,onClose:p,"aria-labelledby":"form-dialog-title",maxWidth:"sm",fullWidth:!0},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u5206\u914d"),r.a.createElement(Ba.b,{onSubmit:function(e){g(e.assign_to)(),p()},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Sa.a,null,r.a.createElement(Ba.a,{component:Ia,name:"assign_to",label:"\u5206\u914d"})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:p,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}function sr(e){var a=ir(),t=e.taskState,n=e.adminAuth,l=e.setTaskState,c=Object(Z.d)((function(e){return e.user.uid})),i=Object(Z.c)(),o=function(e){return function(){i(ta(!0)),Me.a.get(Ve+"/"+t.mid+"/chapter/"+t.cid+"/task/"+t.id+"/status",{params:{to:e},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(a){l(a),1===e&&t.accept_by.uid===c&&i(Ze())})).catch((function(e){try{console.log(e.response.data.detail),i(aa(e.response.data.detail,"error"))}catch(a){i(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return i(ta(!1))}))}};return r.a.createElement(r.a.Fragment,null,0===t.status&&r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(T.a,{variant:"contained",color:"secondary",size:"small",onClick:o(2),className:a.button},r.a.createElement(rr,{status:2}),"\u505c\u6b62"),(t.accept_by.uid===c||n)&&""!==t.accept_by.uid&&r.a.createElement(T.a,{variant:"contained",color:"primary",size:"small",onClick:o(1),className:a.button},r.a.createElement(rr,{status:1}),"\u5b8c\u6210")),n&&r.a.createElement(r.a.Fragment,null,t&&1===t.status&&r.a.createElement(T.a,{variant:"contained",color:"primary",size:"small",onClick:o(0),className:a.button},r.a.createElement(rr,{status:0}),"\u518d\u5f00"),t&&2===t.status&&r.a.createElement(T.a,{variant:"contained",color:"primary",size:"small",onClick:o(0),className:a.button},r.a.createElement(rr,{status:0}),"\u5f00\u59cb")))}function dr(e){var a=e.taskState,t=e.adminAuth,l=e.setTaskState,c=Object(n.useState)(a.wait_status),i=Object(O.a)(c,2),o=i[0],u=i[1],m=Object(Z.c)(),s=Object(n.useState)(!1),d=Object(O.a)(s,2),f=d[0],p=d[1],g=function(){p(!1)},E=function(e){return function(){m(ta(!0)),Me.a.get(Ve+"/"+a.mid+"/chapter/"+a.cid+"/task/"+a.id+"/waitStatusChange",{params:{selected_value:e},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){l(e)})).catch((function(e){try{console.log(e.response.data.detail),m(aa(e.response.data.detail,"error"))}catch(a){m(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return m(ta(!1))}))}};return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(Ha.a,{style:{backgroundColor:or(a.wait_status).color},onClick:function(){p(!0)},label:or(a.wait_status).label}),!t&&r.a.createElement(Ha.a,{style:{backgroundColor:or(a.wait_status).color},label:or(a.wait_status).label}),r.a.createElement(wa.a,{open:f,onClose:g,"aria-labelledby":"form-dialog-title",maxWidth:"sm",fullWidth:!0},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u4fee\u6539"),r.a.createElement(Sa.a,null,r.a.createElement(Ht.a,{component:"fieldset"},r.a.createElement(lr.a,{"aria-label":"gender",name:"gender1",value:String(o),onChange:function(e){u(e.target.value)},row:!0},r.a.createElement(ha.a,{value:"4",control:r.a.createElement(cr.a,null),label:"\u65b0\u9c9c"}),r.a.createElement(ha.a,{value:"5",control:r.a.createElement(cr.a,null),label:"\u4e09\u6210\u719f"}),r.a.createElement(ha.a,{value:"6",control:r.a.createElement(cr.a,null),label:"\u4e94\u6210\u719f"}),r.a.createElement(ha.a,{value:"7",control:r.a.createElement(cr.a,null),label:"\u4e03\u6210\u719f"}),r.a.createElement(ha.a,{value:"0",control:r.a.createElement(cr.a,null),label:"\u81ea\u52a8\u8bbe\u7f6e"})))),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:g,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{onClick:function(){E(o)(),g()},color:"primary"},"\u4fdd\u5b58"))))}var fr=Object(w.a)((function(e){return{root:{width:"100%"},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)},button:{marginLeft:e.spacing(1)}}}));function pr(e){var a=fr(),t=e.manga,l=e.chapter,c=e.tid,i=e.adminAuth,o=Object(n.useState)(),u=Object(O.a)(o,2),m=u[0],s=u[1],d=Object(Z.c)();return r.a.useEffect((function(){d(ta(!0)),Me.a.get(Ve+"/"+t.id+"/chapter/"+l.id+"/task/"+c,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){s(e),la(t.name+l.name+e.name)})).catch((function(e){d(aa("\u83b7\u53d6\u4efb\u52a1\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return d(ta(!1))}))}),[c]),r.a.createElement("div",{className:a.root},r.a.createElement(ma.a,{variant:"h5"},"object"===typeof m&&"object"===typeof m.tags&&m.tags.map((function(e,n){return r.a.createElement(Ja,{key:n,size:"small",tag:e,className:a.label,deletable:i?"true":"false",mid:t.id,cid:l.id,tid:c})}))||r.a.createElement(Vt.a,null),"object"===typeof t.tags&&i&&r.a.createElement(Xn,{className:a.label,level:2,mid:t.id,cid:l.id,tid:c})),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h3"},m&&r.a.createElement(r.a.Fragment,null,En(m.type),m.name)||r.a.createElement(Vt.a,null))),m&&i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Dn,{api:Ve+"/"+t.id+"/chapter/"+l.id+"/task/"+c,name:"\u4efb\u52a1",variant:"outlined",size:"small",callback:"/manga/"+t.id,className:a.button}),r.a.createElement(Qn,{task:m,className:a.button}))),m&&r.a.createElement(ur,{task:m,adminAuth:i}))}var gr=t(5797),Er=t(469),br=t.n(Er),hr=t(470),vr=t.n(hr),yr=Object(w.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},details:{alignItems:"center"},staffItem:{marginRight:e.spacing(1)},summary:{width:"100%"}}}));function Or(e){var a=yr(),t=e.chapter,n=e.adminAuth;return r.a.createElement("div",{className:a.root},r.a.createElement(On.a,null,r.a.createElement(xn.a,{expandIcon:r.a.createElement(ba.a,null),"aria-controls":"chapter-summary"},r.a.createElement(ma.a,{className:a.heading,noWrap:!0},t.name)),r.a.createElement(jn.a,{className:a.details},r.a.createElement(F.a,{display:"flex",flexDirection:"column",className:a.summary},r.a.createElement(ma.a,null,"Staff"),r.a.createElement(F.a,{display:"flex",alignItems:"center"},t.tasks.map((function(e,t){if(""!==e.accept_by.uid)return r.a.createElement("span",{className:a.staffItem,key:t},r.a.createElement("span",null,e.name),r.a.createElement(hn,{user:e.accept_by,size:"small"}))}))),r.a.createElement(ma.a,null,"\u5099\u8003"),r.a.createElement(ma.a,{className:a.secondaryHeading},t.ps))),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(wn.a,null,r.a.createElement(Dn,{api:Ve+"/"+t.mid+"/chapter/"+t.id,name:"\u7ae0\u8282",callback:"/manga/"+t.mid,className:a.button,size:"small",variant:"outlined"}),r.a.createElement(In,{chapter:t})))))}var jr=Object(w.a)((function(e){return{root:{width:"100%"}}}));function xr(e){var a=jr(),t=e.manga,l=e.adminAuth,c=Object(b.i)(),i=c.cid,o=c.tid,u=Object(n.useState)(),m=Object(O.a)(u,2),s=m[0],d=m[1],f=Object(Z.c)(),p=Object(b.g)(),g=Object(n.useState)(0),E=Object(O.a)(g,2),h=E[0],v=E[1];r.a.useEffect((function(){f(ta(!0)),Me.a.get(Ve+"/"+t.id+"/chapter/"+i,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){for(var a=0;a<e.tasks.length;a++)if(e.tasks[a].id===o){v(a);break}d(e)})).catch((function(e){f(aa("\u83b7\u53d6\u7ae0\u8282\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return f(ta(!1))}))}),[]);return r.a.createElement("div",{className:a.root},s&&r.a.createElement(Or,{chapter:s,mid:t.id,adminAuth:l}),s&&r.a.createElement(gr.a,{position:"static",activeStep:h,backButton:r.a.createElement(T.a,{size:"small",onClick:function(){p.replace("/manga/"+t.id+"/"+s.id+"/"+s.tasks[h-1].id),v(h-1)},disabled:0===h},r.a.createElement(br.a,null),"\u4e0a\u4e00\u4e2a\u4efb\u52a1"),nextButton:r.a.createElement(T.a,{size:"small",onClick:function(){p.replace("/manga/"+t.id+"/"+s.id+"/"+s.tasks[h+1].id),v(h+1)},disabled:h===s.tasks.length-1},"\u4e0b\u4e00\u4e2a\u4efb\u52a1",r.a.createElement(vr.a,null)),steps:s.tasks.length}),s&&r.a.createElement(pr,Object.assign({chapter:s},e,{tid:s.tasks[h].id})))}var wr=Object(w.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(1)},coverCard:{maxWidth:275,position:"relative"},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)}}}));function kr(e){var a=wr(),t=Object(b.i)().mid,l=Object(b.j)().path,c=Object(Z.c)(),i=Object(Z.d)((function(e){return e.user.privilege})),o=Object(Z.d)((function(e){return e.user.uid})),u=Object(n.useState)(!1),m=Object(O.a)(u,2),s=m[0],d=m[1],f=Object(n.useState)({}),p=Object(O.a)(f,2),g=p[0],h=p[1];return r.a.useEffect((function(){c(ta(!0)),Me.a.get(Ve+"/"+t,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){h(e),la(e.name)})).catch((function(e){c(aa("\u83b7\u53d6\u6f2b\u753b\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return c(ta(!1))}))}),[]),r.a.useEffect((function(){d(i>=2||"object"===typeof g.producer&&g.producer.uid===o)}),[i,o,g]),r.a.createElement(ga.a,{maxWidth:"lg"},r.a.createElement(F.a,{display:"flex",alignItems:"flex-end",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},"object"===typeof g.tags&&g.tags.map((function(e,n){return r.a.createElement(Ja,{key:n,size:"small",tag:e,className:a.label,deletable:s?"true":"false",mid:t})}))||r.a.createElement(Vt.a,null),"object"===typeof g.tags&&s&&r.a.createElement(Xn,{className:a.label,level:0,mid:g.id})),r.a.createElement(ma.a,{variant:"h2"},r.a.createElement(Yn.a,{component:E.b,to:"/manga/"+g.id,color:"inherit"},g.name)||r.a.createElement(Vt.a,null))),r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:l},r.a.createElement(F.a,null,s&&r.a.createElement(Kt,{mid:g.id}))))),r.a.createElement(La.a,{container:!0,spacing:2},r.a.createElement(La.a,{item:!0,xs:12,md:3},r.a.createElement(F.a,{display:"flex",p:1,justifyContent:"center",flexDirection:"column",alignItems:"center"},r.a.createElement(Pa.a,{className:a.coverCard},r.a.createElement(qa.a,{component:"img",image:g.cover||Va.a,title:g.name})),r.a.createElement(Jn,{manga:g,adminAuth:s}))),r.a.createElement(La.a,{item:!0,xs:12,md:9},r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:l},r.a.createElement(Ln,{mid:t,adminAuth:s})),r.a.createElement(b.b,{path:"".concat(l,"/:cid/:tid")},g.id&&r.a.createElement(xr,{adminAuth:s,manga:g}))))))}function Sr(e){var a=e.children,t=Object(Aa.a)(e,["children"]),n=Object(Z.d)((function(e){return e.user.privilege}));return Object(Z.d)((function(e){return e.user.logging}))?r.a.createElement("div",null):r.a.createElement(b.b,Object.assign({},t,{render:function(e){var t=e.location;return n>0?a:r.a.createElement(b.a,{to:{pathname:"/login",state:{from:t}}})}}))}function Cr(e){var a=r.a.useState(),t=Object(O.a)(a,2),n=t[0],l=t[1],c=Object(Z.d)((function(e){return e.user.uid})),i=Object(Z.c)(),o=Object(b.g)();return r.a.useEffect((function(){i(ta(!0)),Me.a.get(Ue+"/"+c+"/tasks",{headers:Xe(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){l(e.tasks)})).catch((function(e){i(aa("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return i(ta(!1))}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ma.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u4efb\u52a1"),r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},n&&r.a.createElement(nt.a,{icons:At,columns:[{title:"\u6f2b\u753b",field:"mname"},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"}},{title:"\u4e0a\u4e00\u6b21\u6d3b\u8dc3",field:"last_update",render:function(e){return ia(e.last_update)}},{title:"\u72b6\u6001",field:"status",render:function(e){return r.a.createElement(rr,{status:e.status})},defaultSort:"asc"}],options:{pageSize:20},data:n,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,t){o.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})))}function _r(e){var a=e.uid,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=Object(Z.c)(),o=function(){c(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{variant:"contained",color:"secondary",style:{marginTop:"0.5rem"},onClick:function(){c(!0)}},"\u4fee\u6539\u5bc6\u7801"),r.a.createElement(wa.a,{open:l,onClose:o},r.a.createElement(Ba.b,{onSubmit:function(e){console.log(e),e.password===e["re-password"]?(i(ta(!0)),Me.a.post(Ue+"/"+a+"/password",e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){c(!1),i(aa("\u4fee\u6539\u6210\u529f","success"))})).catch((function(e){try{console.log(e.response.data.detail),i(aa(e.response.data.detail,"error"))}catch(a){i(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return i(ta(!1))}))):i(aa("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4","error"))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u4fee\u6539\u5bc6\u7801"),r.a.createElement(Sa.a,null,r.a.createElement(kn.a,null,"\u5bc6\u7801\u662f6-32\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7a7a\u683c\u6216\u5982\u4e0b\u7279\u6b8a\u5b57\u7b26\u7684\u7ec4\u5408\u3002-+_!=@#$%^&*?([)].;:"),r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"password",label:"\u65b0\u5bc6\u7801",type:"password",fullWidth:!0,required:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"re-password",label:"\u91cd\u590d\u65b0\u5bc6\u7801",type:"password",fullWidth:!0,required:!0})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:o,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fee\u6539")))}})))}function zr(e){var a=Object(Z.d)((function(e){return e.user.uid})),t=r.a.useState(),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(Z.c)();Object(n.useEffect)((function(){o(ta(!0)),Me.a.get(Ue+"/"+a,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){i(e)})).catch((function(e){o(aa("\u83b7\u53d6\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return o(ta(!1))}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ma.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u8d26\u6237\u8bbe\u7f6e"),r.a.createElement(Ba.b,{initialValues:c&&{uid:c.uid,nickname:c.nickname,introduction:c.introduction},onSubmit:function(e){e.introduction=e.introduction||"",console.log(e),o(ta(!0)),Me.a.post(Ue+"/"+a,e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){o(aa("\u4fee\u6539\u6210\u529f","success"))})).catch((function(e){try{console.log(e.response.data.detail),o(aa(e.response.data.detail,"error"))}catch(a){o(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return o(ta(!1))}))},render:function(e){var t=e.handleSubmit;return r.a.createElement("form",{onSubmit:t},r.a.createElement(F.a,{display:"flex",flexDirection:"column",alignItems:"flex-start"},r.a.createElement(Wa.c,{name:"uid",label:"\u7528\u6237ID",disabled:!0,required:!0}),r.a.createElement(Wa.c,{name:"nickname",label:"\u6635\u79f0",required:!0}),r.a.createElement(Wa.c,{name:"introduction",label:"\u81ea\u6211\u4ecb\u7ecd",multiline:!0,rowsMax:5}),r.a.createElement(_r,{uid:a}),r.a.createElement(T.a,{type:"submit",variant:"contained",color:"primary",style:{marginTop:"1rem"}},"\u4fdd\u5b58")))}}))}var Tr=t(121),Nr=t(471),Ir=t(271),Dr=t.n(Ir);function Ar(e){var a=r.a.useState(),t=Object(O.a)(a,2),n=t[0],l=t[1],c=Object(Z.c)();r.a.useEffect((function(){c(ta(!0)),Me.a.get(qe+"/profile/i_code",{headers:Xe(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){l(e.icodes)})).catch((function(e){c(aa("\u62c9\u53d6\u9080\u8bf7\u7801\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return c(ta(!1))}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ma.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u7ba1\u7406"),r.a.createElement(F.a,{display:"flex",flexDirection:"column"},r.a.createElement(F.a,null,r.a.createElement(Rr,{style:{marginBottom:"1rem"}})),r.a.createElement(F.a,null,r.a.createElement(T.a,{variant:"contained",color:"primary",onClick:function(){Me.a.put(qe+"/profile/i_code",null,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=n.slice(0);a.push(e),l(Object.assign(a))})).catch((function(e){try{console.log(e.response.data.detail),c(aa(e.response.data.detail,"error"))}catch(a){c(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))}},"\u6dfb\u52a0\u9080\u8bf7\u7801"),n&&n.map((function(e,a){return r.a.createElement(Tr.a,{style:{width:"100%"},key:a},r.a.createElement(F.a,{display:"flex",flexDirection:"row",alignItems:"center"},r.a.createElement(Nr.CopyToClipboard,{text:"https://mikan.mom/signup?icode="+e.icode,onCopy:function(){c(aa("\u5df2\u590d\u5236\u9080\u8bf7\u94fe\u63a5","success"))}},r.a.createElement(re.a,null,r.a.createElement(Dr.a,null))),r.a.createElement(ma.a,{variant:"body1",noWrap:!0,flexGrow:1},e.icode)))})))))}function Rr(e){var a=r.a.useState(!1),t=Object(O.a)(a,2),n=t[0],l=t[1],c=Object(Z.c)(),i=Object(Z.d)((function(e){return e.site.broadcast})),o=function(){l(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,Object.assign({variant:"contained",color:"primary",style:{marginTop:"0.5rem"},onClick:function(){l(!0)}},e),"\u4fee\u6539\u516c\u544a"),r.a.createElement(wa.a,{open:n,onClose:o,maxWidth:"md"},r.a.createElement(Ba.b,{onSubmit:function(e){e.broadcast||(e.broadcast=""),console.log(e),c(ta(!0)),Me.a.post(qe+"/env",null,{params:{key:"broadcast",value:e.broadcast},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(a){l(!1),c(ra(e.broadcast)),c(aa("\u4fee\u6539\u6210\u529f","success"))})).catch((function(e){try{console.log(e.response.data.detail),c(aa(e.response.data.detail,"error"))}catch(a){c(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return c(ta(!1))}))},initialValues:{broadcast:i},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u4fee\u6539\u516c\u544a"),r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"broadcast",label:"\u516c\u544a",fullWidth:!0,multiline:!0,rowsMax:5})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:o,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}var Br=Object(w.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(1)}}}));function Wr(e){var a=Br(),t=r.a.useState(0),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(Z.d)((function(e){return e.user.nickname})),u=Object(Z.d)((function(e){return e.user.privilege})),m=Object(R.a)(),s=Object(A.a)(m.breakpoints.up("md")),d=Object(Z.c)(),f=Object(b.g)();Object(n.useEffect)((function(){return la(o)}),[]);return r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1,alignItems:"flex-end"},r.a.createElement(ma.a,{variant:"h5"},"\u6b22\u8fce\u60a8,"),r.a.createElement(ma.a,{variant:"h2"},o)),r.a.createElement(F.a,null,r.a.createElement(T.a,{onClick:function(){window.localStorage.removeItem("access_token"),d({type:"CLEAN_USER"}),f.push("/")}},"\u767b\u51fa"))),r.a.createElement(F.a,{display:"flex",flexGrow:1,alignItems:"flex-start",flexDirection:s?"row":"column"},r.a.createElement(Bn.a,{orientation:s?"vertical":"horizontal",variant:"scrollable",value:c,onChange:function(e,a){i(a)},className:a.tabs},r.a.createElement(Wn.a,{label:"\u4efb\u52a1"}),r.a.createElement(Wn.a,{label:"\u8bbe\u7f6e"}),u>2&&r.a.createElement(Wn.a,{label:"\u7ba1\u7406"})),r.a.createElement(Fr,{value:c,index:0},r.a.createElement(Cr,null)),r.a.createElement(Fr,{value:c,index:1},r.a.createElement(zr,null)),r.a.createElement(Fr,{value:c,index:2},r.a.createElement(Ar,null))))}function Fr(e){var a=e.children,t=e.value,n=e.index,l=Object(Aa.a)(e,["children","value","index"]);return r.a.createElement("div",Object.assign({style:{width:"100%"},hidden:t!==n},l),t===n&&r.a.createElement(F.a,{p:3},a))}var Lr=t(300);function Pr(e){var a=Object(Lr.useSnackbar)(),t=a.enqueueSnackbar,n=a.closeSnackbar,l=Object(Z.d)((function(e){return e.site.snackMsg})),c=function(e){return function(){return n(e)}};return r.a.useEffect((function(){if("object"===typeof l&&"string"===typeof l.message&&""!==l.message){var e={variant:l.variant};l.dismissable&&Object.assign(e,{action:function(e){return r.a.createElement(T.a,{onClick:c(e)},"\u5ffd\u7565")}}),t(l.message,e)}}),[l]),r.a.createElement("div",null)}var Gr=Object(w.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(5)}}}));function Mr(e){var a=Gr(),t=Object(n.useState)(!1),l=Object(O.a)(t,2),c=l[0],i=l[1],o=new URLSearchParams(Object(b.h)().search);return r.a.useEffect((function(){la("\u6388\u6743"),Me.a.get("https://api.mikan.mom/third_party/auth_code",{params:{client_id:o.get("client_id")},headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=e.access_token;window.location.href=o.get("redirect_uri")+"?code="+a+"&state="+o.get("state")})).catch((function(){return i(!0)}))}),[]),r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},c?"\u8bf7\u91cd\u8bd5":"\u767b\u5f55\u5230"+o.get("client_id")),r.a.createElement(ma.a,{variant:"h2"},c?"\u6388\u6743\u5931\u8d25":"\u6b63\u5728\u6388\u6743..."))))}function qr(){return r.a.useEffect((function(){window.location.href="https://pan.mikan.mom"}),[]),r.a.createElement(ga.a,null,r.a.createElement(ma.a,{variant:"h3"},"\u6b63\u5728\u8df3\u8f6c..."),r.a.createElement(ma.a,{variant:"h5"},"\u5982\u65e0\u8df3\u8f6c, ",r.a.createElement("a",{href:"https://pan.mikan.mom"},"\u8bf7\u70b9\u51fb\u8fd9\u91cc\u3002")))}function Ur(e){var a=Object(b.g)(),t=e.users;return r.a.createElement(nt.a,{icons:At,columns:[{title:"\u6635\u79f0",field:"nickname"},{title:"\u7528\u6237ID",field:"uid"}],options:{pageSize:20},data:t,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,t,n){a.push("/user/"+t.uid)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})}var Vr=Object(w.a)((function(e){return{title:{marginTop:e.spacing(5),marginBottom:e.spacing(5)}}}));function Hr(){var e=Vr(),a=Object(n.useState)([]),t=Object(O.a)(a,2),l=t[0],c=t[1],i=Object(n.useState)([]),o=Object(O.a)(i,2),u=o[0],m=o[1],s=Object(n.useState)(""),d=Object(O.a)(s,2),f=d[0],p=d[1],g=Object(Z.c)();return Object(n.useEffect)((function(){la("\u7ec4\u5458"),g(ta(!0)),Me.a.get(Ue,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){c(e.users),m(e.users)})).catch((function(e){g(aa("\u62c9\u53d6\u7ec4\u5458\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return g(ta(!1))}))}),[]),Object(n.useEffect)((function(){if(""===f.trim())m(l);else{var e=new RegExp(f,"i"),a=l.filter((function(a){return a&&Object.values(a).some((function(a){return"string"===typeof a&&e.test(a)}))}));m(a)}}),[f,l]),r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement("div",{className:e.title},r.a.createElement(ma.a,{variant:"h2"},"\u7ec4\u5458")),r.a.createElement(Ta.a,{label:"\u641c\u7d22",fullWidth:!0,margin:"normal",variant:"outlined",value:f,onChange:function(e){return p(e.target.value)}}),0===u.length?r.a.createElement(ma.a,{variant:"body1",color:"textSecondary"},"\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ec4\u5458\u3002"):r.a.createElement(Ur,{users:u})))}var Yr=t(472),$r=Object(w.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},root:{width:"100%"},rootExpanded:{width:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1)},details:{alignItems:"center"},summary:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},userChip:{marginRight:e.spacing(1)},unreadHeading:{fontSize:e.typography.pxToRem(15),fontWeight:"bold"}}}));function Jr(e){var a=$r(),t=Object(n.useState)(),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(n.useState)(""),u=Object(O.a)(o,2),m=u[0],s=u[1],d=Object(Z.c)(),f=function(e){var a,t=[],n=Object(Yr.a)(c);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.mrn!==e&&t.push(r)}}catch(l){n.e(l)}finally{n.f()}i(t)};return Object(n.useEffect)((function(){la("\u901a\u77e5"),d(ta(!0)),Me.a.get(qe+"/profile/inbox",{headers:Xe(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.messages&&i(e.messages)})).catch((function(e){d(aa("\u62c9\u53d6\u5217\u8868\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return d(ta(!1))}))}),[]),r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea,flexDirection:"column"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h2"},"\u6211\u7684\u901a\u77e5")),r.a.createElement(F.a,{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",flexDirection:"column"},c&&c.map((function(e){return r.a.createElement(Kr,{message:e,expanded:m,setExpanded:s,deleteFromList:f,key:e.mrn})})))))}function Kr(e){var a=$r(),t=e.message,l=e.expanded,c=e.setExpanded,i=e.deleteFromList,o=Object(n.useState)(!1),u=Object(O.a)(o,2),m=u[0],s=u[1],d=Object(Z.c)(),f=Object(n.useState)(),p=Object(O.a)(f,2),g=p[0],E=p[1];r.a.useEffect((function(){return s(t.unread)}),[]),r.a.useEffect((function(){l!==t.mrn||g||(d(ta(!0)),Me.a.get(qe+"/message/"+t.mrn,{headers:Xe(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a;"string"===typeof e.body&&E(e.body),m&&(s(!1),d((a=-1,function(e){e(Object.assign({type:"SET_NOTIFICATIONS"},{number:a}))})))})).catch((function(e){d(aa("\u83b7\u53d6\u6d88\u606f\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return d(ta(!1))})))}),[l]);return r.a.createElement("div",{className:l===t.mrn?a.rootExpanded:a.root},r.a.createElement(On.a,{TransitionProps:{unmountOnExit:!0},expanded:l===t.mrn,onChange:function(){l===t.mrn?c(""):c(t.mrn)}},r.a.createElement(xn.a,{expandIcon:r.a.createElement(ba.a,null),"aria-controls":"message-summary"},r.a.createElement(F.a,{display:"flex",alignItems:"center",flexDirection:"row",className:a.summary},r.a.createElement(hn,{user:t.from_by,className:a.userChip}),r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{className:m?a.unreadHeading:a.heading,noWrap:!0},t.title)),r.a.createElement(ma.a,null,ia(t.create_on)))),r.a.createElement(jn.a,{className:a.details},r.a.createElement(ma.a,{variant:"body1"},g)),r.a.createElement(C.a,null),r.a.createElement(wn.a,null,r.a.createElement(T.a,{onClick:function(){d(ta(!0)),Me.a.delete(qe+"/message/"+t.mrn,{headers:Xe(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){i(t.mrn)})).catch((function(e){try{console.log(e.response.data.detail),d(aa(e.response.data.detail,"error"))}catch(a){d(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return d(ta(!1))}))},color:"secondary",variant:"outlined",size:"small"},"\u5220\u9664\u6d88\u606f"))))}var Xr=Object(w.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(1)},coverCard:{maxWidth:275,position:"relative"},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)}}}));function Qr(e){var a=Xr(),t=Object(b.i)().uid,l=Object(Z.c)(),c=Object(b.g)(),i=Object(Z.d)((function(e){return e.user.privilege})),o=Object(n.useState)({}),u=Object(O.a)(o,2),m=u[0],s=u[1],d=Object(n.useState)(),f=Object(O.a)(d,2),p=f[0],g=f[1];return r.a.useEffect((function(){l(ta(!0)),Me.a.get(Ue+"/"+t,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){s(e),la(e.nickname)})).catch((function(e){l(aa("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return l(ta(!1))}))}),[]),r.a.useEffect((function(){l(ta(!0)),Me.a.get(Ue+"/"+t+"/tasks",{headers:Xe(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){g(e.tasks)})).catch((function(e){l(aa("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return l(ta(!1))}))}),[]),r.a.createElement(ga.a,{maxWidth:"lg"},r.a.createElement(F.a,{display:"flex",alignItems:"flex-end",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},"@",m.uid||r.a.createElement(Vt.a,null)),r.a.createElement(ma.a,{variant:"h2"},r.a.createElement(Yn.a,{component:E.b,to:"/user/"+t,color:"inherit"},m.nickname)||r.a.createElement(Vt.a,null))),r.a.createElement(F.a,null,i>2&&r.a.createElement(_r,{uid:m.uid}))),r.a.createElement(La.a,{container:!0,spacing:2},r.a.createElement(La.a,{item:!0,xs:12,md:3},r.a.createElement(F.a,{display:"flex",p:1,justifyContent:"center",flexDirection:"column",alignItems:"center"},m&&""!==m.avatar&&r.a.createElement(Pa.a,{className:a.coverCard},r.a.createElement(qa.a,{component:"img",image:m.avatar,title:m.nickname})),r.a.createElement(F.a,{display:"flex",flexDirection:"column",style:{width:"100%"}},r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u52a0\u5165\u65f6\u95f4")),r.a.createElement(F.a,null,m&&ca(m.join_time))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u6700\u540e\u4e00\u6b21\u6d3b\u8dc3")),r.a.createElement(F.a,null,m&&ca(m.goo_timestamp))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u6743\u9650")),r.a.createElement(F.a,null,m&&m.privilege)),r.a.createElement(F.a,null,r.a.createElement(ma.a,{paragraph:!0},m&&m.introduction))))),r.a.createElement(La.a,{item:!0,xs:12,md:9},r.a.createElement(ma.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u4efb\u52a1"),r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},p&&r.a.createElement(nt.a,{icons:At,columns:[{title:"\u6f2b\u753b",field:"mname"},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"}},{title:"\u4e0a\u4e00\u6b21\u6d3b\u8dc3",field:"last_update",render:function(e){return ia(e.last_update)}},{title:"\u72b6\u6001",field:"status",render:function(e){return r.a.createElement(rr,{status:e.status})},defaultSort:"asc"}],options:{pageSize:20},data:p,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,t){c.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})))))}var Zr=t(272),el=t.n(Zr);function al(){var e=Object(b.g)();Object(n.useEffect)((function(){return la("404")}),[]),Object(n.useEffect)((function(){setTimeout(a,3e3)}));var a=function(){return e.push("")};return r.a.createElement(ga.a,{component:"main"},r.a.createElement(ma.a,{variant:"h1"},r.a.createElement(el.a,{style:{fontSize:90}}),"404\u4ec0\u4e48\u4e5f\u6ca1\u6709\u627e\u5230"))}var tl=Object(w.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function nl(){var e=tl(),a=new URLSearchParams(Object(b.h)().search),t=Object(Z.c)(),l=Object(b.g)();Object(n.useEffect)((function(){return la("\u6ce8\u518c")}),[]);return r.a.createElement(ga.a,{component:"main",maxWidth:"xs"},r.a.createElement(x.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(ge.a,{className:e.avatar},r.a.createElement(Mt.a,null)),r.a.createElement(ma.a,{component:"h1",variant:"h5"},"\u6b22\u8fce\u52a0\u5165\u6c49\u5316\u5de5\u623f\u4e5d\u4e5d\u7ec4"),r.a.createElement(Ba.b,{onSubmit:function(e){e.icode=a.get("icode"),console.log(e),e.password===e["re-password"]?(t(ta(!0)),Me.a.post(qe+"/signup",e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){t(aa("\u6ce8\u518c\u6210\u529f\uff0c\u8bf7\u767b\u5f55\u3002","success")),l.push("/")})).catch((function(e){try{console.log(e.response.data.detail),t(aa(e.response.data.detail,"error"))}catch(a){t(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return t(ta(!1))}))):t(aa("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4","error"))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Wa.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u7528\u6237ID",name:"uid",autoComplete:"uid",autoFocus:!0,helperText:"ID\u5c06\u88ab\u7528\u4e8e\u767b\u5f55"}),r.a.createElement(Wa.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u6635\u79f0",name:"nickname"}),r.a.createElement(Wa.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u5bc6\u7801",type:"password",autoComplete:"current-password",helperText:"\u5bc6\u7801\u662f6-32\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7a7a\u683c\u6216\u5982\u4e0b\u7279\u6b8a\u5b57\u7b26\u7684\u7ec4\u5408\u3002-+_!=@#$%^&*?([)].;:"}),r.a.createElement(Wa.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"re-password",label:"\u91cd\u590d\u5bc6\u7801",type:"password"}),r.a.createElement(T.a,{fullWidth:!0,variant:"contained",color:"primary",type:"submit"},"\u6ce8\u518c"))}})))}var rl=Object(w.a)((function(e){return{userChip:{backgroundColor:"white",color:"black",cursor:"pointer","&:hover":{backgroundColor:"lightgray"}}}}));function ll(e){var a=e.user,t=Object(b.g)(),n=rl();return void 0===a?r.a.createElement(r.a.Fragment,null):r.a.createElement(Ha.a,Object.assign({"aria-label":"User Chip",onClick:function(e){e.stopPropagation(),t.push("/user/"+a.uid)},className:n.userChip,clickable:!0,avatar:r.a.createElement(Fe,{avatar:a.avatar,name:a.nickname}),label:a.nickname},e))}var cl=Object(w.a)((function(e){return{smallBadge:{minWidth:"14px",width:"14px",height:"14px",fontSize:"10px",padding:"0",borderRadius:"50%"},lightBlueBadge:{backgroundColor:"lightBlue"},lightYellowBadge:{backgroundColor:"rgba(255, 255, 0, 0.5)"},lightRedBadge:{backgroundColor:"rgba(255, 82, 82, 0.5)"}}})),il=function(e,a,t){return e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).length},ol=function(e,a,t){var n=e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).map((function(e){return e.wait_status%4}));return n.length>0?Math.max.apply(Math,Object(at.a)(n)):0};function ul(e){var a=cl(),t=Object(b.g)(),n=e.tasks,l=function(e){switch(e){case 1:return"".concat(a.smallBadge," ").concat(a.lightBlueBadge);case 2:return"".concat(a.smallBadge," ").concat(a.lightYellowBadge);case 3:return"".concat(a.smallBadge," ").concat(a.lightRedBadge);default:return a.smallBadge}};return r.a.createElement(nt.a,{icons:At,columns:[{title:"\u6f2b\u753b",field:"mname",defaultGroupOrder:1,render:function(e){var a=e.split("\u9e2a\u9e2a\u9e2a"),t=Object(O.a)(a,2),c=t[0],i=t[1];return r.a.createElement(de.a,{badgeContent:il(n,e,i),anchorOrigin:{vertical:"top",horizontal:"right"},overlap:"rectangle",classes:{badge:l(ol(n,e,i))}},r.a.createElement("span",{style:{paddingRight:"10px"}},c))}},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"},defaultGroupOrder:0},{title:"\u6807\u7b7e",field:"tags",grouping:!1,render:function(e){return r.a.createElement(r.a.Fragment,null,e.tags.map((function(e,a){return r.a.createElement(Ja,{tag:e,size:"small",key:a})})))},sorting:!1},{title:"\u7528\u6237",field:"accept_by",grouping:!1,render:function(e){return r.a.createElement(ll,{user:e.accept_by})}},{title:"\u63a5\u53d6\u65f6\u95f4",field:"accept_on",render:function(e){return ia(e.accept_on)},grouping:!1}],options:{pageSize:20,grouping:!0,rowStyle:function(e){return{backgroundColor:{0:"transparent",1:"lightBlue",2:"rgba(255, 255, 0, 0.5)",3:"rgba(255, 82, 82, 0.5)"}[e.wait_status%4]||"transparent"}}},data:n,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,n){t.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})}var ml=Object(w.a)((function(e){return{title:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},taskListItem:{marginTop:e.spacing(1)}}}));function sl(){var e=ml(),a=Object(n.useState)([]),t=Object(O.a)(a,2),l=t[0],c=t[1],i=Object(Z.c)();return Object(n.useEffect)((function(){la("\u8fdb\u884c\u4e2d\u7684\u4efb\u52a1"),i(ta(!0)),Me.a.get("https://api.mikan.mom/running_task",{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=e.tasks.map((function(e){return Object(_a.a)({},e,{mname:"".concat(e.mname,"\u9e2a\u9e2a\u9e2a").concat(e.type)})}));c(a)})).catch((function(e){i(aa("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return i(ta(!1))}))}),[]),r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement("div",{className:e.title},r.a.createElement(ma.a,{variant:"h2"},"\u8fdb\u884c\u4e2d\u7684\u4efb\u52a1")),r.a.createElement(ul,{tasks:l})))}var dl=t(302),fl=(t(5740),Object(w.a)((function(e){return{calendarContainer:{maxWidth:"350px",minWidth:"280px",margin:"0 auto",padding:"16px",border:"1px solid #ccc",borderRadius:"8px"},weekDayHeader:{display:"grid",gridTemplateColumns:function(e){return 0===e.mode?"repeat(7, 1fr)":"50px repeat(7, 1fr)"},gap:"4px",marginBottom:"8px",fontWeight:"bold"},dayContainer:{display:"grid",gridTemplateColumns:function(e){return 0===e.mode?"repeat(7, 1fr)":"50px repeat(7, 1fr)"},gap:"4px"},weekNumber:{display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",minWidth:"50px"},dayButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",cursor:"pointer",border:"1px solid #ccc",aspectRatio:"1 / 1","&:hover":{backgroundColor:"#f0f0f0"}},selectedDay:{backgroundColor:"#3f51b5",color:"#fff",border:"none"},emptyDay:{visibility:"hidden"}}}))),pl=Object(n.memo)((function(e){var a=e.mode,t=void 0===a?2:a,l=e.value,c=void 0===l?[]:l,i=e.onChange,o=fl({mode:t}),u=Object(n.useMemo)((function(){return["\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03"]}),[]),m=Object(n.useMemo)((function(){return Array.from({length:35},(function(e,a){return a+1}))}),[]),s=Object(n.useMemo)((function(){return Array(0).fill(null).map((function(e,a){return a+1}))}),[1]),d=Object(n.useMemo)((function(){var e=[],a=[],t=1;if(s.forEach((function(){a.push(null)})),m.forEach((function(n){a.push(n),7===a.length&&(e.push({weekNumber:t,days:a}),a=[],t++)})),a.length>0){for(;a.length<7;)a.push(null);e.push({weekNumber:t,days:a})}return e}),[m,s]),f=Object(n.useCallback)((function(e){var a=new Set(c);a.has(e)?a.delete(e):a.add(e),i(Object(at.a)(a))}),[c,i]);return r.a.createElement("div",{className:o.calendarContainer},r.a.createElement(ma.a,{variant:"h6",align:"center",gutterBottom:!0},"\u9009\u62e9\u65e5\u671f"),0!==t&&r.a.createElement("div",{className:o.weekDayHeader},0!==t&&r.a.createElement("div",null),u.map((function(e){return r.a.createElement(ma.a,{key:e,variant:"body2",align:"center"},e)}))),r.a.createElement("div",{className:o.dayContainer},d.map((function(e){return r.a.createElement(r.a.Fragment,{key:e.weekNumber},0!==t&&r.a.createElement("div",{className:o.weekNumber},"\u7b2c",e.weekNumber,"\u5468"),e.days.map((function(e,a){return 0===t&&e&&e>=32?null:e?r.a.createElement("div",{key:e,className:"".concat(o.dayButton," ").concat(c.includes(e)?o.selectedDay:""),onClick:function(){return f(e)}},1===t?"":e):r.a.createElement("div",{key:"empty-".concat(a),className:"".concat(o.dayButton," ").concat(o.emptyDay)})})))}))))})),gl=Object(n.memo)((function(e){var a=e.mode,t=void 0===a?2:a,l=e.value,c=void 0===l?[]:l,i=e.onChange,o=Object(n.useState)(null),u=Object(O.a)(o,2),m=u[0],s=u[1],d=Boolean(m),f=Array.isArray(c)?c:[];return r.a.createElement(F.a,{display:"flex",alignItems:"flex-end",flexGrow:1},r.a.createElement(Ta.a,{value:f.join(", "),onClick:function(e){s(e.currentTarget)},placeholder:"\u9009\u62e9\u65e5\u671f",fullWidth:!0,InputProps:{readOnly:!0}}),r.a.createElement(N.a,{open:d,anchorEl:m,onClose:function(){s(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0},r.a.createElement(pl,{mode:t,value:f,onChange:i})))})),El=t(362),bl=Object(w.a)((function(e){return{container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}}));function hl(){var e=bl(),a=r.a.useState(!1),t=Object(O.a)(a,2),n=t[0],l=t[1],c=r.a.useState(!1),i=Object(O.a)(c,2),o=i[0],u=i[1],m=r.a.useState(0),s=Object(O.a)(m,2),d=s[0],f=s[1],p=r.a.memo(gl),g=Object(Z.c)(),E=function(){l(!1)},b=function(e){u(e.target.checked)},h=function(e){f(e.target.value)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"contained",color:"primary",onClick:function(){l(!0)}},"\u521b\u5efa\u6742\u5fd7"),r.a.createElement(wa.a,{open:n,onClose:E,disableEnforceFocus:!0},r.a.createElement(Ba.b,{onSubmit:function(e){o?(e.magazine_schedule_type=d,e.magazine_schedule_dates&&Array.isArray(e.magazine_schedule_dates)&&(e.magazine_schedule_dates=e.magazine_schedule_dates.join(",")),delete e.next_update_time):(delete e.magazine_schedule_type,delete e.magazine_schedule_dates,delete e.magazine_schedule_time),e.magazine_schedule_flag=o,Me.a.put(He,e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),g(aa(e.response.data.detail,"error"))}catch(a){g(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},initialValues:{magazine_schedule_time:"00:00"},render:function(a){var t=a.handleSubmit;return r.a.createElement("form",{onSubmit:t},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u521b\u5efa\u6742\u5fd7"),r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u6742\u5fd7\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u6742\u5fd7ID",type:"string",fullWidth:!0,required:!0,helperText:"\u6742\u5fd7ID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002\u5efa\u8bae\uff1a\u7f57\u9a6c\u5b57/\u82f1\u6587\u7b80\u5199\u3002"}),r.a.createElement(El.a,null,"\u6ce8\u610f\uff0c\u4ee5\u4e0b\u65f6\u95f4\u5747\u91c7\u7528\u65e5\u672c\u65f6\u95f4"),r.a.createElement(La.a,{container:!0,spacing:2,alignItems:"center"},r.a.createElement(La.a,{item:!0,xs:6}," ",r.a.createElement(ha.a,{control:r.a.createElement(va.a,{checked:o,onChange:b}),label:"\u662f\u5426\u81ea\u52a8\u66f4\u65b0",style:{marginLeft:0},labelPlacement:"start"})," "),o&&r.a.createElement(La.a,{item:!0,xs:3}," ",r.a.createElement(Ht.a,{fullWidth:!0,margin:"dense"},r.a.createElement(dl.a,{value:d,onChange:h},r.a.createElement(Cn.a,{value:0},"\u6309\u65e5\u671f\u66f4\u65b0"),r.a.createElement(Cn.a,{value:1},"\u6309\u5468\u6b21\u66f4\u65b0")))))," ",o&&r.a.createElement(La.a,{container:!0,spacing:2,alignItems:"center"},r.a.createElement(La.a,{item:!0,xs:6},r.a.createElement(Ba.a,{name:"magazine_schedule_dates"},(function(e){var a=e.input;return r.a.createElement(p,{mode:d,value:a.value||[],onChange:function(e){return a.onChange(e)}})}))),r.a.createElement(La.a,{item:!0,xs:6},r.a.createElement(Wa.c,{name:"magazine_schedule_time",id:"time",type:"time",className:e.textField,InputLabelProps:{shrink:!0},inputProps:{step:300}}))),!o&&r.a.createElement(La.a,{container:!0,spacing:2,alignItems:"center"},r.a.createElement(La.a,{item:!0,xs:12},r.a.createElement(Wa.c,{margin:"dense",label:"\u4e0b\u6b21\u66f4\u65b0\u65f6\u95f4",type:"datetime-local",name:"next_update_time",InputLabelProps:{shrink:!0},fullWidth:!0}))),r.a.createElement(Ht.a,{fullWidth:!0,margin:"dense"},r.a.createElement(Kn.a,null,"\u72b6\u6001"),r.a.createElement(Ba.a,{name:"status",defaultValue:0},(function(e){var a=e.input;return r.a.createElement(dl.a,Object.assign({},a,{label:"\u72b6\u6001"}),r.a.createElement(Cn.a,{value:0},"\u8fde\u8f7d\u4e2d"),r.a.createElement(Cn.a,{value:1},"\u5b8c\u7ed3"))}))),r.a.createElement(Wa.c,{margin:"dense",name:"media",label:"\u5a92\u4ecb",type:"string",fullWidth:!0}),r.a.createElement(Ba.a,{component:Da,name:"cover"}),r.a.createElement(Wa.c,{margin:"dense",name:"url",label:"\u6742\u5fd7\u53d1\u5e03URL",type:"string",fullWidth:!0})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:E,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u521b\u5efa")))}})))}var vl=Object(w.a)((function(e){var a;return{root:(a={maxWidth:175},Object(j.a)(a,e.breakpoints.up("md"),{maxWidth:275}),Object(j.a)(a,"position","relative"),Object(j.a)(a,"margin",e.spacing(2)),a),labels:{position:"absolute",right:e.spacing(0),top:e.spacing(0)},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)},content:{width:"100%",position:"absolute",bottom:0,backgroundColor:"black",opacity:.8},details:{opacity:1,color:"white"}}}));function yl(e){var a,t=vl(),l=e.magazine,c=Object(n.useState)(Va.a),i=Object(O.a)(c,2),o=i[0],u=i[1];return a=0===l.status?function(e){var a="";if("number"!==typeof e||isNaN(e))return{message:"\u65f6\u95f4\u9519\u8bef",color:"orange"};if(0===e)return{message:"\u65e0\u65f6\u95f4",color:"orange"};var t=new Date,n=new Date(t.getTime()+324e5),r=new Date(1e3*e);if(r<=n)return{message:"\u4efb\u52a1\u53ef\u66f4\u65b0",color:"orange"};var l=r-n,c=Math.floor(l/864e5),i=Math.floor(l%864e5/36e5),o=Math.floor(l%36e5/6e4);a=c>=1?"".concat(c,"\u5929\u540e"):i>=1?"".concat(i,"\u5c0f\u65f6\u540e"):"".concat(o,"\u5206\u949f\u540e");return{message:a,color:"lime"}}(l.next_update_time):{message:"\u5df2\u5b8c\u7ed3",color:"red"},r.a.useEffect((function(){var e=new Image;e.src=l.cover,e.onload=function(){u(l.cover)}}),[]),r.a.createElement(Pa.a,{className:t.root,component:E.b,to:"/magazine/"+l.id},r.a.createElement(Ga.a,null,r.a.createElement(qa.a,{component:"img",image:o,title:l.name}),r.a.createElement(F.a,{display:"flex",flexDirection:"row-reverse",flexWrap:"wrap",className:t.labels},r.a.createElement(Ha.a,{style:{backgroundColor:"#99D9EA"},className:t.label,size:"small",label:l.inclusion}),"\u65e0\u65f6\u95f4"!==a.message&&r.a.createElement(Ha.a,{style:{backgroundColor:Ya(a.color),color:$a(a.color)},className:t.label,size:"small",label:a.message}),"object"===typeof l.tags&&l.tags.map((function(e,a){return r.a.createElement(Ja,{className:t.label,tag:e,size:"small",key:a})}))),r.a.createElement(Ma.a,{className:t.content},r.a.createElement("div",{className:t.details},r.a.createElement(ma.a,{gutterBottom:!0,variant:"h5",component:"h2"},l.name||r.a.createElement(pe.a,null))))))}function Ol(e){var a=e.showFinished,t=Object(n.useState)([]),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(Z.c)();return r.a.useEffect((function(){o(ta(!0)),Me.a.get(He,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.magazines&&i(e.magazines)})).catch((function(e){o(aa("\u83b7\u53d6\u6f2b\u753b\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return o(ta(!1))}))}),[]),r.a.createElement(La.a,{container:!0,spacing:1},c.map((function(e){if(0===e.status||a)return r.a.createElement(La.a,{item:!0,xs:6,sm:3,md:3,lg:2,key:e.id},r.a.createElement(yl,{magazine:e}))})))}function jl(){var e=r.a.useState(!1),a=Object(O.a)(e,2),t=a[0],n=a[1],l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=r.a.useState(null),m=Object(O.a)(u,2),s=m[0],d=m[1],f=r.a.useState(null),p=Object(O.a)(f,2),g=p[0],E=p[1],b=Object(Z.c)(),h=function(){n(!1),o(!1),d(null),E(null)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"contained",color:"primary",onClick:function(){n(!0)}},"\u5220\u9664\u6742\u5fd7"),r.a.createElement(wa.a,{open:t,onClose:h,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ba.b,{onSubmit:function(e){if(!i)return o(!0),d(e.magazine.name),void E(e.magazine.id);Me.a.delete(He+"/"+g,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),b(aa(e.response.data.detail,"error"))}catch(a){b(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},i?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u786e\u8ba4\u5220\u9664"),r.a.createElement(Sa.a,null,r.a.createElement(kn.a,null,"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u300a",r.a.createElement("strong",null,s),"\u300b\u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u9500\u3002")),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:function(){return o(!1)},color:"primary"},"\u8fd4\u56de"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u5220\u9664"))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u786e\u8ba4\u5220\u9664"),r.a.createElement(Sa.a,null,r.a.createElement(kn.a,null,"\u6ce8\u610f\uff01\u5220\u9664\u540e\u5c06\u4e0d\u53ef\u6062\u590d\uff01"),r.a.createElement(Ba.a,{component:Ra,name:"magazine",label:"\u6742\u5fd7",id:"magazine",fullWidth:!0,isRequired:!0})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:h,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u5220\u9664"))))}})))}var xl=Object(w.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},cardsArea:{margin:e.spacing(5)},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}}}));function wl(e){var a=xl(),t=Object(Z.d)((function(e){return e.user.privilege})),l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=r.a.useState(!1),m=Object(O.a)(u,2),s=m[0],d=m[1];Object(n.useEffect)((function(){return la("")}),[]);return r.a.createElement(ga.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},"\u96d1\u8a8c"),r.a.createElement(ma.a,{variant:"h2"},"\u89c0\u6e2c\u4e2d")),r.a.createElement(F.a,{alignSelf:"flex-end"},r.a.createElement(re.a,{className:Object(ya.default)(a.expand,Object(j.a)({},a.expandOpen,i)),onClick:function(){o(!i)},"aria-expanded":i,"aria-label":"\u66f4\u591a\u9009\u9879"},r.a.createElement(ba.a,null)))),r.a.createElement(Oa.a,{className:a.filterArea,in:i,timeout:"auto",unmountOnExit:!0},r.a.createElement(F.a,{flexGrow:1}),r.a.createElement(F.a,{display:"flex",justifyContent:"flex-end"},t>=2&&r.a.createElement(r.a.Fragment,null,r.a.createElement(F.a,{mr:2},r.a.createElement(hl,null)),r.a.createElement(jl,null)),r.a.createElement(ha.a,{checked:s,onChange:function(e){d(e.target.checked)},value:s,size:"small",control:r.a.createElement(va.a,{color:"primary"}),label:"\u663e\u793a\u5b8c\u7ed3\u6742\u5fd7",labelPlacement:"start"}))),r.a.createElement(Ol,{showFinished:s}))}var kl=Object(w.a)((function(e){return{container:{display:"flex",flexWrap:"wrap"},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200}}}));function Sl(e){var a=kl(),t=e.magazine,n=r.a.useState(!1),l=Object(O.a)(n,2),c=l[0],i=l[1],o=r.a.useState(!1),u=Object(O.a)(o,2),m=u[0],s=u[1],d=r.a.useState(0),f=Object(O.a)(d,2),p=f[0],g=f[1],E=r.a.memo(gl),h=Object(Z.c)(),v=Object(b.g)();r.a.useEffect((function(){t&&(s(t.magazine_schedule_flag),g(t.magazine_schedule_type))}),[t]);var y=function(){i(!1)},j=function(e){s(e.target.checked)},x=function(e){g(e.target.value)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"outlined",color:"primary",size:"small",onClick:function(){i(!0)}},"\u7f16\u8f91\u6742\u5fd7"),r.a.createElement(wa.a,{open:c,onClose:y,adisableEnforceFocus:!0},r.a.createElement(Ba.b,{initialValues:{name:t.name,id:t.id,status:t.status,next_update_time:t.next_update_time?Cl(t.next_update_time):"",media:t.media,url:t.url,magazine_schedule_dates:t.magazine_schedule_dates?t.magazine_schedule_dates.split(",").map(Number):[],magazine_schedule_time:t.magazine_schedule_time?_l(t.magazine_schedule_time):"00:00"},onSubmit:function(e){if(m){if(e.magazine_schedule_type=p,!(e.magazine_schedule_dates&&Array.isArray(e.magazine_schedule_dates)&&e.magazine_schedule_dates.length>0))return void h(aa("\u8bf7\u9009\u62e9\u81f3\u5c11\u4e00\u4e2a\u65e5\u671f","error"));e.magazine_schedule_dates=e.magazine_schedule_dates.join(","),delete e.next_update_time}else delete e.magazine_schedule_type,delete e.magazine_schedule_dates,delete e.magazine_schedule_time;e.magazine_schedule_flag=m,e.cover=document.getElementById("cover").value,Me.a.post(He+"/"+t.id,e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){e.id!==t.id&&v.replace("/magazine/"+e.id),window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),h(aa(e.response.data.detail,"error"))}catch(a){h(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var n=e.handleSubmit;return r.a.createElement("form",{onSubmit:n},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u7f16\u8f91\u6742\u5fd7"),r.a.createElement(Sa.a,null,r.a.createElement(Wa.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u6742\u5fd7\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(Wa.c,{margin:"dense",name:"id",label:"\u6742\u5fd7ID",type:"string",fullWidth:!0,required:!0,helperText:"\u6742\u5fd7ID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002\u5efa\u8bae\uff1a\u7f57\u9a6c\u5b57/\u82f1\u6587\u7b80\u5199\u3002"}),r.a.createElement(El.a,null,"\u6ce8\u610f\uff0c\u4ee5\u4e0b\u65f6\u95f4\u5747\u91c7\u7528\u65e5\u672c\u65f6\u95f4"),r.a.createElement(La.a,{container:!0,spacing:2,alignItems:"center"},r.a.createElement(La.a,{item:!0,xs:6}," ",r.a.createElement(ha.a,{control:r.a.createElement(va.a,{checked:m,onChange:j}),label:"\u662f\u5426\u81ea\u52a8\u66f4\u65b0",style:{marginLeft:0},labelPlacement:"start"})," "),m&&r.a.createElement(La.a,{item:!0,xs:3}," ",r.a.createElement(Ht.a,{fullWidth:!0,margin:"dense"},r.a.createElement(dl.a,{value:p,onChange:x},r.a.createElement(Cn.a,{value:0},"\u6309\u65e5\u671f\u66f4\u65b0"),r.a.createElement(Cn.a,{value:1},"\u6309\u5468\u6b21\u66f4\u65b0")))))," ",m&&r.a.createElement(La.a,{container:!0,spacing:2,alignItems:"center"},r.a.createElement(La.a,{item:!0,xs:6},r.a.createElement(Ba.a,{name:"magazine_schedule_dates"},(function(e){var a=e.input;return r.a.createElement(E,{mode:p,value:a.value||[],onChange:function(e){return a.onChange(e)}})}))),r.a.createElement(La.a,{item:!0,xs:6},r.a.createElement(Wa.c,{name:"magazine_schedule_time",id:"time",type:"time",className:a.textField,InputLabelProps:{shrink:!0},inputProps:{step:300},required:m}))),!m&&r.a.createElement(La.a,{container:!0,spacing:2,alignItems:"center"},r.a.createElement(La.a,{item:!0,xs:12},r.a.createElement(Wa.c,{margin:"dense",label:"\u4e0b\u6b21\u66f4\u65b0\u65f6\u95f4(\u65e5\u672c\u65f6\u95f4)",type:"datetime-local",name:"next_update_time",InputLabelProps:{shrink:!0},fullWidth:!0}))),r.a.createElement(Ht.a,{fullWidth:!0,margin:"dense"},r.a.createElement(Kn.a,null,"\u72b6\u6001"),r.a.createElement(Ba.a,{name:"status",defaultValue:0},(function(e){var a=e.input;return r.a.createElement(dl.a,Object.assign({},a,{label:"\u72b6\u6001"}),r.a.createElement(Cn.a,{value:0},"\u8fde\u8f7d\u4e2d"),r.a.createElement(Cn.a,{value:1},"\u5b8c\u7ed3"))}))),r.a.createElement(Wa.c,{margin:"dense",name:"media",label:"\u5a92\u4ecb",type:"string",fullWidth:!0}),r.a.createElement(Ba.a,{component:Da,name:"cover",initVal:t.cover}),r.a.createElement(Wa.c,{margin:"dense",name:"url",label:"\u6742\u5fd7\u53d1\u5e03URL",type:"string",fullWidth:!0})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:y,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u4fee\u6539")))}})))}function Cl(e){return e?new Date(1e3*e).toISOString().slice(0,16):""}function _l(e){var a=Math.floor(e/3600),t=Math.floor(e%3600/60),n=String(a).padStart(2,"0"),r=String(t).padStart(2,"0");return"".concat(n,":").concat(r)}function zl(e){var a=e.input,t=e.label,n=e.initVal,l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=r.a.useState(!1),m=Object(O.a)(u,2),s=m[0],d=m[1],f=r.a.useState([]),p=Object(O.a)(f,2),g=p[0],E=p[1],b=Object(Z.c)();return r.a.useEffect((function(){i&&!s&&0===g.length&&(d(!0),Me.a.get(He+"/blank/manga",{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.mangas&&E(e.mangas)})).catch((function(e){b(aa("\u62c9\u53d6\u6f2b\u753b\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","error"))})).finally((function(){return d(!1)})))}),[i]),r.a.createElement(za.a,Object.assign({open:i,onOpen:function(){return o(!0)},onClose:function(){return o(!1)},loading:s,loadingText:"\u52a0\u8f7d\u4e2d...",noOptionsText:"\u6ca1\u6709\u6b64\u6f2b\u753b",options:g},e,{onChange:function(e,t){return a.onChange(t?t.id:null)},getOptionLabel:function(e){return e.id},defaultValue:n,renderOption:function(e){return e.name+"@"+e.id},getOptionSelected:function(e,a){return e.id===a.id},filterOptions:function(e,a){var t=a.inputValue;return Object(Na.a)(e,t,{keys:["name","id"]})},renderInput:function(e){return r.a.createElement(Ta.a,Object.assign({required:!0},e,{label:t,InputProps:Object(_a.a)({},e.InputProps,{style:{width:"250px"},endAdornment:r.a.createElement(r.a.Fragment,null,s?r.a.createElement(pe.a,{size:20}):null,e.InputProps.endAdornment)})}))}}))}function Tl(e){var a=e.magazine,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=Object(Z.c)(),o=function(){c(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"outlined",color:"primary",size:"small",onClick:function(){c(!0)}},"\u65b0\u589e\u6f2b\u753b"),r.a.createElement(wa.a,{open:l,onClose:o,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ba.b,{onSubmit:function(e){e.manga_id=document.getElementById("manga_id").value,Me.a.put(He+"/"+a.id+"/manga",e,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{i(aa(e.response.data.detail,"error"))}catch(a){i(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u65b0\u589e\u6f2b\u753b"),r.a.createElement(Sa.a,null,r.a.createElement(Ba.a,{component:zl,name:"manga_id",label:"\u6f2b\u753b",id:"manga_id"})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:o,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u521b\u5efa")))}})))}function Nl(e){var a=e.input,t=e.label,n=e.initVal,l=e.mid,c=r.a.useState(!1),i=Object(O.a)(c,2),o=i[0],u=i[1],m=r.a.useState(!1),s=Object(O.a)(m,2),d=s[0],f=s[1],p=r.a.useState([]),g=Object(O.a)(p,2),E=g[0],b=g[1],h=Object(Z.c)();return r.a.useEffect((function(){o&&!d&&0===E.length&&(f(!0),Me.a.get(He+"/manga/"+l,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.mangas&&b(e.mangas)})).catch((function(e){h(aa("\u62c9\u53d6\u6f2b\u753b\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","error"))})).finally((function(){return f(!1)})))}),[o]),r.a.createElement(za.a,Object.assign({open:o,onOpen:function(){return u(!0)},onClose:function(){return u(!1)},loading:d,loadingText:"\u52a0\u8f7d\u4e2d...",noOptionsText:"\u6ca1\u6709\u6b64\u6f2b\u753b",options:E},e,{onChange:function(e,t){return a.onChange(t?t.id:null)},getOptionLabel:function(e){return e.id},defaultValue:n,renderOption:function(e){return e.name+"@"+e.id},getOptionSelected:function(e,a){return e.id===a.id},filterOptions:function(e,a){var t=a.inputValue;return Object(Na.a)(e,t,{keys:["name","id"]})},renderInput:function(e){return r.a.createElement(Ta.a,Object.assign({required:!0},e,{label:t,InputProps:Object(_a.a)({},e.InputProps,{style:{width:"250px"},endAdornment:r.a.createElement(r.a.Fragment,null,d?r.a.createElement(pe.a,{size:20}):null,e.InputProps.endAdornment)})}))}}))}function Il(e){var a=e.magazine,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=Object(Z.c)(),o=function(){c(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"outlined",color:"primary",size:"small",onClick:function(){c(!0)}},"\u5220\u9664\u6f2b\u753b"),r.a.createElement(wa.a,{open:l,onClose:o,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ba.b,{onSubmit:function(e){Me.a.delete(He+"/manga/"+document.getElementById("manga_id").value,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{i(aa(e.response.data.detail,"error"))}catch(a){i(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var t=e.handleSubmit;return r.a.createElement("form",{onSubmit:t},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u5220\u9664\u6f2b\u753b"),r.a.createElement(Sa.a,null,r.a.createElement(Ba.a,{component:Nl,name:"manga_id",label:"\u6f2b\u753b",id:"manga_id",mid:a.id})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:o,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u5220\u9664")))}})))}var Dl=t(408),Al=t(425),Rl=t(410),Bl=t(407),Wl=t(5801),Fl=t(423),Ll=t(411),Pl=Object(w.a)((function(e){return{customBlue:{backgroundColor:"#87cefa","&:hover":{backgroundColor:"#50abe4"}}}}));function Gl(e){var a=e.manga,t=e.index,l=e.onUpdate,c=Object(n.useState)(a.isUpdating),i=Object(O.a)(c,2),o=i[0],u=i[1],m=Object(n.useState)(a.hasProofreading),s=Object(O.a)(m,2),d=s[0],f=s[1];return r.a.createElement(Ll.a,null,r.a.createElement(Bl.a,null," ",r.a.createElement(Jt.a,{checked:o,onChange:function(e){u(e.target.checked),l(t,e.target.checked,a.nextChapter,d)}})," "),r.a.createElement(Bl.a,null," ",a.manga_name," "),r.a.createElement(Bl.a,null,r.a.createElement(Dl.a,{title:r.a.createElement("div",null," ",a.recentChapters.map((function(e,a){return r.a.createElement("div",{key:a},e)}))," "),placement:"top"},r.a.createElement("span",null,a.latestChapter))),r.a.createElement(Bl.a,null," ",r.a.createElement(Jt.a,{checked:d,onChange:function(e){f(e.target.checked),l(t,o,a.nextChapter,e.target.checked)},disabled:!o})," "),r.a.createElement(Bl.a,null," ",r.a.createElement(Ta.a,{value:a.nextChapter||"",disabled:!o,onChange:function(e){return l(t,o,e.target.value,d)},required:o})," "))}function Ml(e){var a=e.mangas,t=e.onMangasChange;return r.a.createElement(Wl.a,null,r.a.createElement(Al.a,null,r.a.createElement(Fl.a,null,r.a.createElement(Ll.a,null,r.a.createElement(Bl.a,null,"\u662f\u5426\u66f4\u65b0"),r.a.createElement(Bl.a,null,"\u6f2b\u753b"),r.a.createElement(Bl.a,null,"\u4e0a\u4e00\u7ae0"),r.a.createElement(Bl.a,null,"\u6709\u65e0\u6821\u5bf9"),r.a.createElement(Bl.a,null,"\u66f4\u65b0\u7ae0\u8282"))),r.a.createElement(Rl.a,null,a.map((function(e,a){return r.a.createElement(Gl,{key:a,manga:e,index:a,onUpdate:function(e,a,n,r){return t(e,a,n,r)}})})))))}function ql(e){var a=Pl(),t=e.magazine,l=Object(n.useState)([]),c=Object(O.a)(l,2),i=c[0],o=c[1];Object(n.useEffect)((function(){t&&t.manga_list&&o(function(e){var a={};return e.forEach((function(e){a[e.manga_id]||(a[e.manga_id]={manga_id:e.manga_id,manga_name:e.manga_name,chapters:[],isUpdating:!1,hasProofreading:!0}),e.chapter_name&&a[e.manga_id].chapters.push(e.chapter_name)})),Object.keys(a).forEach((function(e){a[e].recentChapters=a[e].chapters,a[e].latestChapter=a[e].chapters[0]||"\u65e0"})),Object.values(a)}(t.manga_list))}),[t]);var u=r.a.useState(!1),m=Object(O.a)(u,2),s=m[0],d=m[1],f=Object(Z.c)(),p=function(){d(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"contained",color:t.need_update?"primary":void 0,className:t.need_update?void 0:a.customBlue,onClick:function(){d(!0)}}," \u66f4\u65b0 "),r.a.createElement(wa.a,{open:s,onClose:p,"aria-labelledby":"form-dialog-title"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var a=i.filter((function(e){return e.isUpdating})).map((function(e){return{manga_id:e.manga_id,nextChapter:e.nextChapter,hasProofreading:e.hasProofreading}}));0!==a.length?Me.a.put(He+"/"+t.id,a,{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(a){try{f(aa(a.response.data.detail,"error"))}catch(e){f(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}})):f(aa("\u6ca1\u6709\u9700\u8981\u66f4\u65b0\u7684\u6f2b\u753b","info"))}}," ",r.a.createElement(Sa.a,null,r.a.createElement(Ml,{mangas:i,onMangasChange:function(e,a,t,n){var r=Object(at.a)(i);r[e]=Object(_a.a)({},r[e],{isUpdating:a,nextChapter:t,hasProofreading:n}),o(r)}})),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:p,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"}," ","\u66f4\u65b0")))))}function Ul(e){var a=e.magazine,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=Object(Z.c)(),o=function(){c(!1)};return r.a.createElement("div",null,r.a.createElement(T.a,{variant:"contained",color:"secondary",onClick:function(){c(!0)}},"\u8df3\u8fc7\u66f4\u65b0"),r.a.createElement(wa.a,{open:l,onClose:o,"aria-labelledby":"form-dialog-title"},r.a.createElement(Ba.b,{onSubmit:function(){Me.a.put(He+"/"+a.id,[],{headers:Xe(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{i(aa(e.response.data.detail,"error"))}catch(a){i(aa("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(Ca.a,{id:"form-dialog-title"},"\u8df3\u8fc7\u66f4\u65b0"),r.a.createElement(Sa.a,null,r.a.createElement(kn.a,null,"\u662f\u5426\u8df3\u8fc7\u672c\u6b21\u66f4\u65b0\uff1f")),r.a.createElement(ka.a,null,r.a.createElement(T.a,{onClick:o,color:"primary"},"\u53d6\u6d88"),r.a.createElement(T.a,{type:"submit",color:"primary"},"\u786e\u5b9a")))}})))}var Vl=Object(w.a)((function(e){return{root:{padding:e.spacing(2)},coverCard:{width:"100%",height:"100%",objectFit:"cover",maxWidth:275,position:"relative"},contentBox:{display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center"},titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(1)},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}}}));function Hl(e){var a=Vl(),t=Object(b.i)().id,l=Object(b.j)().path,c=Object(Z.c)(),i=Object(Z.d)((function(e){return e.user.privilege})),o=Object(n.useState)(!1),u=Object(O.a)(o,2),m=u[0],s=u[1],d=r.a.useState(!1),f=Object(O.a)(d,2),p=f[0],g=f[1],h=r.a.useState(!1),v=Object(O.a)(h,2),y=v[0],x=v[1],w=Object(n.useState)({}),k=Object(O.a)(w,2),S=k[0],C=k[1];return r.a.useEffect((function(){c(ta(!0)),Me.a.get(He+"/"+t,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){C(e),la(e.name)})).catch((function(e){c(aa("\u83b7\u53d6\u6742\u5fd7\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return c(ta(!1))}))}),[]),r.a.useEffect((function(){s(i>=2)}),[i]),r.a.createElement(ga.a,{maxWidth:"lg"},r.a.createElement(F.a,{display:"flex",alignItems:"flex-end",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},"object"===typeof S.tags&&S.tags.map((function(e,n){return r.a.createElement(Ja,{key:n,size:"small",tag:e,className:a.label,deletable:m?"true":"false",lid:t})}))||r.a.createElement(Vt.a,null),"object"===typeof S.tags&&m&&r.a.createElement(Xn,{className:a.label,level:3,lid:S.id})),r.a.createElement(ma.a,{variant:"h2"},r.a.createElement(Yn.a,{component:E.b,to:"/magazine/"+S.id,color:"inherit"},S.name)||r.a.createElement(Vt.a,null))),r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:l},r.a.createElement(F.a,{mr:1},m&&r.a.createElement(Sl,{magazine:S})),r.a.createElement(F.a,{mr:1},m&&r.a.createElement(Tl,{magazine:S})),r.a.createElement(F.a,{mr:1},m&&r.a.createElement(Il,{magazine:S}))))),r.a.createElement("div",{className:a.root},r.a.createElement(La.a,{container:!0,spacing:2},r.a.createElement(La.a,{item:!0,xs:12,md:6},r.a.createElement(F.a,{display:"flex",justifyContent:"center",alignItems:"center"},r.a.createElement(Pa.a,{className:a.coverCard},r.a.createElement(qa.a,{component:"img",image:S.cover||Va.a,title:S.name})))),r.a.createElement(La.a,{item:!0,xs:12,md:6},r.a.createElement(F.a,{display:"flex",flexDirection:"column",className:a.root},r.a.createElement(F.a,{display:"flex"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,{variant:"h5"},"\u8be6\u7ec6\u4fe1\u606f"))),r.a.createElement(F.a,{display:"flex",flexDirection:"column",style:{width:"100%"}},S.url&&r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u51fa\u5904")),r.a.createElement(Yn.a,{href:S.url,target:"_blank",rel:"noopener noreferrer"}," ",S.url," ")),0!==S.next_update_time&&r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u4e0b\u4e00\u6b21\u66f4\u65b0\u65f6\u95f4\uff08\u65e5\u672c\u65f6\u95f4\uff09")),r.a.createElement(F.a,null,Mn(S.next_update_time))),0!==S.next_update_time&&r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u8ddd\u79bb\u4e0b\u6b21\u66f4\u65b0\u5269\u4f59\u65f6\u95f4")),r.a.createElement(F.a,null,function(e){var a="";if("number"!==typeof e||isNaN(e))return"\u65f6\u95f4\u9519\u8bef";if(0===e)return"\u65e0\u65f6\u95f4";var t=new Date,n=new Date(t.getTime()+324e5),r=new Date(1e3*e);if(r<=n)return"\u7b49\u5f85\u4efb\u52a1\u66f4\u65b0\u4e2d\xb7\xb7\xb7\xb7\xb7\xb7";var l=r-n,c=Math.floor(l/864e5),i=Math.floor(l%864e5/36e5),o=Math.floor(l%36e5/6e4);a=c>=1?"".concat(c,"\u5929\u540e"):i>=1?"".concat(i,"\u5c0f\u65f6\u540e"):"".concat(o,"\u5206\u949f\u540e");return a}(S.next_update_time))),S.media&&r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u5a92\u4ecb")),r.a.createElement(F.a,null,S.media)),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ma.a,null,"\u72b6\u6001")),r.a.createElement(F.a,null,0===S.status?"\u8fde\u8f7d\u4e2d":"\u5b8c\u7ed3")),r.a.createElement(F.a,null,r.a.createElement(ma.a,{paragraph:!0},S.ps)))),r.a.createElement(F.a,{className:a.contentBox},r.a.createElement(F.a,{style:{marginRight:"10px"}},m&&0===S.status&&r.a.createElement(ql,{magazine:S})),r.a.createElement(F.a,null,m&&0===S.status&&S.need_update&&r.a.createElement(Ul,{magazine:S})))))),r.a.createElement(F.a,{style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(F.a,null,r.a.createElement(re.a,{className:Object(ya.default)(a.expand,Object(j.a)({},a.expandOpen,p)),onClick:function(){g(!p)},"aria-expanded":p,"aria-label":"\u66f4\u591a\u9009\u9879"},r.a.createElement(ba.a,null)))),r.a.createElement(Oa.a,{in:p,timeout:"auto",unmountOnExit:!0},r.a.createElement(F.a,{flexGrow:1}),r.a.createElement(F.a,{display:"flex",justifyContent:"flex-end"},r.a.createElement(ha.a,{checked:y,onChange:function(e){x(e.target.checked)},size:"small",control:r.a.createElement(va.a,{color:"primary"}),label:"\u663e\u793a\u5b8c\u7ed3\u7684\u4f5c\u54c1",labelPlacement:"start"}))),r.a.createElement(La.a,{container:!0,spacing:1},"object"===typeof S.mangas&&S.mangas.map((function(e){if(0===e.status_at_magazine||y)return r.a.createElement(La.a,{item:!0,xs:6,sm:3,md:3,lg:2,key:e.id},r.a.createElement(Xa,{manga:e}))}))))}function Yl(){return r.a.createElement(E.a,null,r.a.createElement(pa,null,r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:"/"},r.a.createElement(et,null)),r.a.createElement(b.b,{exact:!0,path:"/magazinePage"},r.a.createElement(wl,null)),r.a.createElement(b.b,{path:"/tasks"},r.a.createElement(Pt,null)),r.a.createElement(b.b,{path:"/runningTasks"},r.a.createElement(sl,null)),r.a.createElement(b.b,{path:"/login"},r.a.createElement(Ut,null)),r.a.createElement(b.b,{path:"/signup"},r.a.createElement(nl,null)),r.a.createElement(Sr,{path:"/me"},r.a.createElement(Wr,null)),r.a.createElement(b.b,{path:"/cloud"},r.a.createElement(qr,null)),r.a.createElement(Sr,{path:"/oauth2"},r.a.createElement(Mr,null)),r.a.createElement(Sr,{path:"/users"},r.a.createElement(Hr,null)),r.a.createElement(Sr,{path:"/message"},r.a.createElement(Jr,null)),r.a.createElement(b.b,{path:"/manga/:mid",children:r.a.createElement(kr,null)}),r.a.createElement(b.b,{path:"/magazine/:id",children:r.a.createElement(Hl,null)}),r.a.createElement(Sr,{path:"/user/:uid",children:r.a.createElement(Qr,null)}),r.a.createElement(b.b,{path:"*"},r.a.createElement(al,null)))),r.a.createElement(Pr,null))}var $l=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Jl(e,a){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Kl=t(85),Xl=Object(Kl.c)({site:Pe,user:Je}),Ql=t(473),Zl=Object(Kl.e)(Xl,Object(Kl.a)(Ql.a));c.a.render(r.a.createElement(Z.a,{store:Zl},r.a.createElement(i.a,{theme:g},r.a.createElement(Lr.SnackbarProvider,{anchorOrigin:{vertical:"bottom",horizontal:"right"}},r.a.createElement(Yl,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var a="".concat("","/service-worker.js");$l?(!function(e,a){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Jl(e,a)})).catch((function(){console.log("No internet connection found. Border is running in offline mode.")}))}(a,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Jl(a,e)}))}}()}},[[5618,1,2]]]);
//# sourceMappingURL=main.884e513e.chunk.js.map