(this["webpackJsonpmikan-peel"]=this["webpackJsonpmikan-peel"]||[]).push([[0],{283:function(e,a,t){e.exports=t.p+"static/media/cover.d753b4ce.jpeg"},5617:function(e,a,t){e.exports=t(5739)},5739:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(26),c=t.n(l),i=t(5788),o=t(160),u=t(427),s=t(141),m=t.n(s),d=t(431),f=t.n(d),p=Object(o.a)({palette:{primary:m.a,secondary:f.a}}),g=Object(u.a)(p),E=t(41),b=t(23),h=t(173),v=t.n(h),y=t(268),O=t(10),j=t(39),w=t(5775),k=t(77),x=t(426),S=t(91),C=t(5772),T=t(5746),_=t(5742),N=t(146),z=t(474),R=t(5770),I=t(390),A=t(5741),B=t(27),D=Object(k.a)((function(e){return{popover:{pointerEvents:"none"},paper:{padding:e.spacing(1)},listItem:Object(j.a)({},e.breakpoints.up("md"),{paddingTop:0,paddingBottom:0})}}));function W(e){var a=e.name,t=e.to,n=e.sidebarToggle,l=r.a.useState(null),c=Object(O.a)(l,2),i=c[0],o=c[1],u=Object(b.j)({path:t,exact:"/"===t}),s=D(),m=Object(B.a)(),d=Object(A.a)(m.breakpoints.up("md")),f=function(){o(null)},p=Boolean(i);return r.a.createElement("div",null,r.a.createElement(_.a,{button:!0,disableGutters:d,className:s.listItem,onClick:d?null:n,component:E.b,to:t,selected:null!==u},r.a.createElement(x.a,{smDown:!0},r.a.createElement(N.a,{onMouseEnter:function(e){o(e.currentTarget)},onMouseLeave:f},e.children)),r.a.createElement(x.a,{mdUp:!0},r.a.createElement(R.a,{style:{minWidth:"40px"}},e.children),r.a.createElement(I.a,{primary:a}))),r.a.createElement(z.a,{className:s.popover,classes:{paper:s.paper},open:p,anchorEl:i,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},onClose:f,disableRestoreFocus:!0},a))}var F=t(324),L=t(433),G=t.n(L),P=t(434),M=t.n(P),q=t(435),U=t.n(q),V=t(436),H=t.n(V),Y=t(437),$=t.n(Y),J=t(438),K=t.n(J),X=t(8),Q=t(5803),Z=Object(k.a)((function(e){var a;return{drawer:Object(j.a)({},e.breakpoints.up("md"),{width:80,flexShrink:0}),placeholder:e.mixins.toolbar,drawerPaper:(a={},Object(j.a)(a,e.breakpoints.up("md"),{width:80}),Object(j.a)(a,"width",150),a)}}));function ee(e){var a=e.sidebarToggle,t=e.openStatus,n=Z(),l=Object(B.a)(),c=Object(A.a)(l.breakpoints.up("md")),i=Object(X.d)((function(e){return e.user.privilege})),o=r.a.createElement("span",{style:{height:"100%"}},r.a.createElement(F.a,{style:{height:"100%"},display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"stretch"},r.a.createElement(F.a,null,r.a.createElement("div",{className:n.placeholder}),r.a.createElement(C.a,null),r.a.createElement(T.a,{disablePadding:!0},r.a.createElement(W,{to:"/",name:"\u6f2b\u753b",sidebarToggle:a},r.a.createElement(G.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/tasks",name:"\u4efb\u52a1",sidebarToggle:a},r.a.createElement(M.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/runningTasks",name:"\u8fdb\u884c\u4e2d\u7684\u4efb\u52a1",sidebarToggle:a},r.a.createElement(Q.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/cloud",name:"\u6587\u4ef6",sidebarToggle:a},r.a.createElement(U.a,{style:c?{fontSize:62}:{}})),r.a.createElement(W,{to:"/users",name:"\u6210\u5458",sidebarToggle:a},r.a.createElement(H.a,{style:c?{fontSize:62}:{}})),i>99&&r.a.createElement(W,{to:"/stat",name:"\u7edf\u8ba1",sidebarToggle:a},r.a.createElement($.a,{style:c?{fontSize:62}:{}})))),i>99&&r.a.createElement(F.a,null,r.a.createElement(C.a,null),r.a.createElement(T.a,null,r.a.createElement(W,{name:"\u7ba1\u7406",sidebarToggle:a},r.a.createElement(K.a,{style:c?{fontSize:62}:{}}))))));return r.a.createElement("nav",{className:n.drawer},r.a.createElement(x.a,{mdUp:!0,implementation:"css"},r.a.createElement(S.a,{variant:"temporary",anchor:"left",open:t,onClose:a,classes:{paper:n.drawerPaper},ModalProps:{keepMounted:!0}},o)),r.a.createElement(x.a,{smDown:!0,implementation:"css"},r.a.createElement(S.a,{classes:{paper:n.drawerPaper},variant:"permanent",open:!0},o)))}var ae=t(341),te=t(175),ne=t(440),re=t.n(ne),le=t(5773),ce=t(443),ie=t.n(ce),oe=t(442),ue=t.n(oe),se=t(5774),me=t(342),de=t(401),fe=t(5801),pe=t(209),ge=t.n(pe),Ee=t(210),be=t.n(Ee),he=t(272),ve=t.n(he),ye=t(211),Oe=t.n(ye),je=t(212),we=t.n(je),ke=t(273),xe=t.n(ke),Se=t(274),Ce=t.n(Se),Te=t(275),_e=t.n(Te),Ne=t(276),ze=t.n(Ne),Re=t(143),Ie=t.n(Re);function Ae(e){switch(e){case 0:return ge.a[500];case 1:return be.a[300];case 2:return ve.a[500];case 3:return Oe.a[900];case 4:return we.a[500];case 5:return xe.a[500];case 6:return Ce.a[500];case 7:return _e.a[600];case 8:return m.a[500];case 9:return ze.a[500];case 10:return Ie.a[500];default:return Ie.a[200]}}function Be(e){switch(e){case 0:case 1:case 2:case 3:case 4:return"white";case 5:return"black";case 6:return"white";case 7:case 8:return"black";case 9:return"white";case 10:default:return"black"}}function De(e){var a=e.avatar,t=e.name,n=function(e){var a,t=0;for(a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t|=0;return t};return r.a.createElement(fe.a,Object.assign({alt:t,src:a},e,{style:{color:Be(n(t)%11),backgroundColor:Ae(n(t)%11)}}),t[0]?t[0]:"\u67d1")}var We=t(441),Fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{broadcast:"",snackMsg:{message:""},busy:0,showCherry:!0},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_BROADCAST":return Object.assign({},e,{broadcast:a.broadcast});case"SET_SNACK_MSG":return Object.assign({},e,{snackMsg:a.snackMsg});case"SET_BUSY":return Object.assign({},e,{busy:e.busy+(a.isBusy?1:-1)});case"SET_SHOW_CHERRY":return Object.assign({},e,{showCherry:a.showCherry});default:return e}},Le=t(15),Ge=t.n(Le),Pe="https://api.mikan.mom",Me=Pe+"/user",qe=Pe+"/manga";var Ue=t(439),Ve=t.n(Ue),He=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{privilege:0,logging:!0},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"FILL_USER":return{uid:a.uid,nickname:a.nickname,avatar:a.avatar,privilege:a.privilege,number_of_notifications:a.number_of_notifications,goo_timestamp:a.goo_timestamp};case"CLEAN_USER":return{privilege:0};case"SET_LOGGING":return Object.assign({},e,{logging:a.logging});case"SET_NOTIFICATIONS":return Object.assign({},e,{number_of_notifications:e.number_of_notifications+a.number});case"SET_GOO":return Object.assign({},e,{goo_timestamp:a.goo_timestamp});default:return e}};function Ye(){return function(){var e=Object(y.a)(v.a.mark((function e(a){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(Je(!0)),a(Ze(!0)),e.next=4,Ge.a.get(Pe+"/profile",{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){a(Object.assign({type:"FILL_USER"},e)),Ge.a.get(Pe+"/refresh_token",{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){window.localStorage.setItem("access_token",e.access_token)}))})).catch((function(e){console.log("\u672a\u767b\u5f55")})).finally((function(){a(Ze(!1)),a(Je(!1))}));case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}()}function $e(){return{Authorization:"Bearer "+window.localStorage.getItem("access_token")}}function Je(e){return function(a){a({type:"SET_LOGGING",logging:e})}}function Ke(){var e=new Date;return function(a){a(Object.assign({type:"SET_GOO"},{goo_timestamp:(Date.now()-6e4*e.getTimezoneOffset())/1e3}))}}function Xe(){return function(e){"1"===window.localStorage.getItem("noCherry")&&e(ea(!1)),Ge.a.get(Pe+"/env",{params:{key:"broadcast"},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(a){e(aa(a.result))})).catch((function(a){try{console.log(a.response.data.detail),e(Qe(a.response.data.detail,"error"))}catch(t){e(Qe("\u65e0\u6cd5\u62c9\u53d6\u7ad9\u70b9\uff0c\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return e(Ze(!1))}))}}function Qe(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(n){return n(Object.assign({type:"SET_SNACK_MSG"},{snackMsg:{message:e,variant:a,dismissable:t}}))}}function Ze(e){return function(a){a(Object.assign({type:"SET_BUSY"},{isBusy:e}))}}function ea(e){return window.localStorage.setItem("noCherry",e?"0":"1"),function(a){return a(Object.assign({type:"SET_SHOW_CHERRY"},{showCherry:e}))}}function aa(e){return function(a){return a(Object.assign({type:"SET_BROADCAST"},{broadcast:e}))}}function ta(e){"string"===typeof e&&(document.title=""!==e?e+"-\u6c49\u5316\u5de5\u623f\u4e5d\u4e5d\u7ec4":"\u6c49\u5316\u5de5\u623f\u4e5d\u4e5d\u7ec4")}function na(e){if("number"!==typeof e)return"";var a=new Date;return e+=60*a.getTimezoneOffset(),(a=new Date(1e3*e)).getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5"}function ra(e){if("number"!==typeof e)return"";var a=new Date;return e+=60*a.getTimezoneOffset(),(a=new Date(1e3*e)).getFullYear()+"\u5e74"+(a.getMonth()+1)+"\u6708"+a.getDate()+"\u65e5 "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)}var la=Object(k.a)((function(e){var a;return{menuButton:(a={},Object(j.a)(a,e.breakpoints.up("md"),{display:"none"}),Object(j.a)(a,"padding",0),a),appBar:{zIndex:e.zIndex.drawer+1},popover:{pointerEvents:"none"},buttonProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}}));function ca(e){var a=e.sidebarToggle,t=la(),n=Object(X.c)(),l=Object(X.d)((function(e){return e.user.privilege})),c=Object(X.d)((function(e){return e.site.busy})),i=Object(X.d)((function(e){return e.user.logging})),o=Object(X.d)((function(e){return e.user.number_of_notifications})),u=Object(X.d)((function(e){return e.user.nickname})),s=Object(X.d)((function(e){return e.user.avatar})),m=Object(X.d)((function(e){return e.user.goo_timestamp})),d=r.a.useState(null),f=Object(O.a)(d,2),p=f[0],g=f[1],b=r.a.useState(""),h=Object(O.a)(b,2),v=h[0],y=h[1],j=function(e,a){y(a),g(e.currentTarget)},w=function(){g(null)},k=Boolean(p);return r.a.createElement(le.a,{position:"fixed",className:t.appBar},r.a.createElement(ae.a,null,r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(F.a,{display:"flex",justifyContent:"space-between",alignItems:"center"},r.a.createElement(F.a,null,r.a.createElement(te.a,{onClick:a,className:t.menuButton},r.a.createElement(re.a,null))),r.a.createElement(F.a,null,l>0&&r.a.createElement(te.a,{onMouseEnter:function(e){return j(e,"\u5495~")},onMouseLeave:w,"aria-label":"goo",onClick:function(){n(Qe(function(e){if("number"!==typeof e)return"";var a=new Date;return e+=60*a.getTimezoneOffset(),a=new Date(1e3*e),function(e){var a=(e=(e-e%1e3)/1e3)%60,t=(e=(e-a)/60)%60,n=(e=(e-t)/60)%24,r=(e-n)/24;return(0!==r?r+"\u5929":"")+(0!==n||0!==r?("0"+n).slice(-2)+"\u5c0f\u65f6":"")+(0!==t||0!==n||0!==r?("0"+t).slice(-2)+"\u5206\u949f":"")+("0"+a).slice(-2)+"\u79d2"}((new Date).getTime()-a)}(m),"info"))}},r.a.createElement(We.a,{fontSize:"large"})),l>0&&r.a.createElement(te.a,{onMouseEnter:function(e){return j(e,"\u901a\u77e5")},onMouseLeave:w,"aria-label":"notification",component:E.b,to:"/message"},r.a.createElement(se.a,{badgeContent:o,overlap:"circle",color:"secondary"},r.a.createElement(ue.a,{fontSize:"large"}))),r.a.createElement(te.a,{onMouseEnter:function(e){return j(e,u||"\u767b\u5f55")},onMouseLeave:w,"aria-label":"account",component:E.b,to:"/me"},u?r.a.createElement(De,{name:u,avatar:s}):r.a.createElement(ie.a,{fontSize:"large"}),i&&r.a.createElement(de.a,{size:24,className:t.buttonProgress})))))),c>0?r.a.createElement(me.a,null):r.a.createElement(r.a.Fragment,null),r.a.createElement(z.a,{className:t.popover,classes:{paper:t.paper},open:k,anchorEl:p,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:w,disableRestoreFocus:!0},v))}var ia=t(55),oa=Object(k.a)((function(e){return{placeholder:{height:e.spacing(4)}}}));function ua(e){var a=e.ver,t=oa(),l=r.a.useState("0"),c=Object(O.a)(l,2),i=c[0],o=c[1],u=Object(X.c)();return Object(n.useEffect)((function(){u(Ze(!0)),Ge.a.get(Pe+"/ver",{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){o(e.version)})).catch((function(e){u(Qe("\u83b7\u53d6\u540e\u53f0\u7248\u672c\u5931\u8d25","error"))})).finally((function(){return u(Ze(!1))}))}),[]),r.a.createElement("div",null,r.a.createElement("div",{className:t.placeholder}),r.a.createElement(C.a,null),r.a.createElement(ia.a,{variant:"body2",color:"textSecondary",align:"center"},"Mikan v",i,", Mikan-Peel v",a))}var sa=Object(k.a)((function(e){var a;return{root:{display:"flex",alignItems:"stretch"},placeholder:e.mixins.toolbar,content:{flexGrow:1},mainArea:(a={minWidth:600,width:600},Object(j.a)(a,e.breakpoints.up("md"),{width:960}),Object(j.a)(a,e.breakpoints.up("lg"),{width:"calc(1280px - ".concat(80,"px)")}),Object(j.a)(a,e.breakpoints.up("xl"),{width:"calc(1920px - ".concat(80,"px)")}),a)}}));var ma=function(e){var a=sa(),t=Object(X.c)(),n=r.a.useState(!1),l=Object(O.a)(n,2),c=l[0],i=l[1];r.a.useEffect((function(){function e(){return(e=Object(y.a)(v.a.mark((function e(){return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(Xe()),e.next=3,t(Ye());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var o=function(){i(!c)};return r.a.createElement("div",{className:a.root},r.a.createElement(w.a,null),r.a.createElement(ca,{sidebarToggle:o}),r.a.createElement(ee,{sidebarToggle:o,openStatus:c}),r.a.createElement("main",{className:a.content},r.a.createElement("div",{className:a.placeholder}),e.children,r.a.createElement(ua,{ver:"0.2.1"})))},da=t(5783),fa=t(108),pa=t.n(fa),ga=t(218),Ea=t(5753),ba=t(2),ha=t(402),va=t(5799),ya=t(5784),Oa=t(5751),ja=t(5754),wa=t(5752),ka=t(5777),xa=t(129),Sa=t(5760),Ca=t(176),Ta=t(471);function _a(e){var a=e.input,t=e.label,n=e.initVal,l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=r.a.useState(!1),s=Object(O.a)(u,2),m=s[0],d=s[1],f=r.a.useState([]),p=Object(O.a)(f,2),g=p[0],E=p[1],b=Object(X.c)();return r.a.useEffect((function(){i&&!m&&0===g.length&&(d(!0),Ge.a.get(Me,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.users&&E(e.users)})).catch((function(e){b(Qe("\u62c9\u53d6\u7528\u6237\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5","error"))})).finally((function(){return d(!1)})))}),[i]),r.a.createElement(Sa.a,Object.assign({open:i,onOpen:function(){return o(!0)},onClose:function(){return o(!1)},loading:m,loadingText:"\u52a0\u8f7d\u4e2d...",noOptionsText:"\u6ca1\u6709\u8fd9\u4e2a\u4eba",options:g},e,{onChange:function(e,t){return a.onChange(t?t.uid:null)},getOptionLabel:function(e){return e.uid},defaultValue:n,renderOption:function(e){return e.nickname+"@"+e.uid},getOptionSelected:function(e,a){return e.uid===a.uid},filterOptions:function(e,a){var t=a.inputValue;return Object(Ta.a)(e,t,{keys:["nickname","uid"]})},renderInput:function(e){return r.a.createElement(Ca.a,Object.assign({required:!0},e,{label:t,InputProps:Object(xa.a)({},e.InputProps,{endAdornment:r.a.createElement(r.a.Fragment,null,m?r.a.createElement(de.a,{size:20}):null,e.InputProps.endAdornment)})}))}}))}var Na=t(24),za=t(25);function Ra(e){var a=e.input,t=e.initVal;return r.a.useEffect((function(){var e=document.createElement("script");e.src="https://imgchr.com/sdk/pup.js",e.setAttribute("data-url","https://imgchr.com/upload"),e.setAttribute("data-auto-insert","direct-links"),e.setAttribute("data-mode","manual"),e.async=!0,document.head.appendChild(e)}),[]),r.a.createElement(F.a,{display:"flex",alignItems:"flex-end"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(Ca.a,{margin:"dense",id:"cover",name:"cover",label:"\u5c01\u9762URL",type:"string",fullWidth:!0,defaultValue:t,onChange:function(e){return a.onChange(e.target.value)}})),r.a.createElement(F.a,null,r.a.createElement(N.a,{"data-chevereto-pup-trigger":!0,"data-target":"#cover",ariant:"contained",color:"secondary",component:"span"},"\u56fe\u5e8a\u4e0a\u4f20")))}function Ia(){var e=r.a.useState(!1),a=Object(O.a)(e,2),t=a[0],n=a[1],l=Object(X.c)(),c=function(){n(!1)};return r.a.createElement("div",null,r.a.createElement(N.a,{variant:"contained",color:"primary",onClick:function(){n(!0)}},"\u521b\u5efa\u6f2b\u753b"),r.a.createElement(Oa.a,{open:t,onClose:c,"aria-labelledby":"form-dialog-title"},r.a.createElement(Na.b,{onSubmit:function(e){e.cover=document.getElementById("cover").value,e.cherry=!0===e.cherry,e.ps="",console.log(e),Ge.a.put(qe,e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),l(Qe(e.response.data.detail,"error"))}catch(a){l(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u521b\u5efa\u6f2b\u753b"),r.a.createElement(wa.a,null,r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u6f2b\u753b\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(za.c,{margin:"dense",name:"id",label:"\u6f2b\u753bID",type:"string",fullWidth:!0,required:!0,helperText:"\u6f2b\u753bID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002\u5efa\u8bae\uff1a\u7f57\u9a6c\u5b57/\u82f1\u6587\u7b80\u5199\u3002"}),r.a.createElement(za.a,{name:"cherry",data:{label:"\u590f\u871c\u6a31\u6843",value:"cherry"}}),r.a.createElement(Na.a,{component:_a,name:"producer",label:"\u5236\u4f5c\u4eba",id:"producer"}),r.a.createElement(Na.a,{component:Ra,name:"cover"})),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:c,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u521b\u5efa")))}})))}var Aa=t(5782),Ba=t(5778),Da=t(5779),Wa=t(5781),Fa=t(5780),La=t(283),Ga=t.n(La),Pa=t(428);function Ma(e){switch(e){case"red":return ge.a[500];case"pink":return be.a[300];case"purple":return ve.a[500];case"indigo":return Oe.a[900];case"blue":return we.a[500];case"cyan":return xe.a[500];case"teal":return Ce.a[500];case"lime":return _e.a[600];case"orange":return m.a[500];case"brown":return ze.a[500];case"grey":return Ie.a[500];default:return Ie.a[200]}}function qa(e){switch(e){case"red":case"pink":case"purple":case"indigo":case"blue":return"white";case"cyan":return"black";case"teal":return"white";case"lime":case"orange":return"black";case"brown":return"white";case"grey":default:return"black"}}function Ua(e){var a=e.tag,t=e.mid,n=e.cid,l=e.tid,c=e.deletable,i=Object(X.c)();return r.a.createElement(Pa.a,Object.assign({style:{backgroundColor:Ma(a.color),color:qa(a.color)},label:a.name,onDelete:"true"===c?function(){var e=2;"string"!==typeof l&&(e=1),"string"!==typeof n&&(e=0),Ge.a.post("https://api.mikan.mom/tag_delete",{name:a.name,color:a.color,mid:t,cid:e>0?n:"",tid:e>1?l:"",level:e},{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),i(Qe(e.response.data.detail,"error"))}catch(a){i(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))}:null},e))}var Va=Object(k.a)((function(e){var a;return{root:(a={maxWidth:175},Object(j.a)(a,e.breakpoints.up("md"),{maxWidth:275}),Object(j.a)(a,"position","relative"),Object(j.a)(a,"margin",e.spacing(2)),a),labels:{position:"absolute",right:e.spacing(0),top:e.spacing(0)},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)},content:{width:"100%",position:"absolute",bottom:0,backgroundColor:"black",opacity:.8},details:{opacity:1,color:"white"}}}));function Ha(e){var a=Va(),t=e.manga,l=Object(n.useState)(Ga.a),c=Object(O.a)(l,2),i=c[0],o=c[1];return r.a.useEffect((function(){var e=new Image;e.src=t.cover,e.onload=function(){o(t.cover)}}),[]),r.a.createElement(Ba.a,{className:a.root,component:E.b,to:"/manga/"+t.id},r.a.createElement(Da.a,null,r.a.createElement(Fa.a,{component:"img",image:i,title:t.name}),r.a.createElement(F.a,{display:"flex",flexDirection:"row-reverse",flexWrap:"wrap",className:a.labels},"object"===typeof t.tags&&t.tags.map((function(e,t){return r.a.createElement(Ua,{className:a.label,tag:e,size:"small",key:t})}))),r.a.createElement(Wa.a,{className:a.content},r.a.createElement("div",{className:a.details},r.a.createElement(ia.a,{gutterBottom:!0,variant:"h5",component:"h2"},t.name||r.a.createElement(de.a,null))))))}function Ya(e){var a=e.showFinished,t=Object(n.useState)([]),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(X.d)((function(e){return e.site.showCherry})),u=Object(X.c)();return r.a.useEffect((function(){u(Ze(!0)),Ge.a.get(qe,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.mangas&&i(e.mangas)})).catch((function(e){u(Qe("\u83b7\u53d6\u6f2b\u753b\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return u(Ze(!1))}))}),[]),r.a.createElement(Aa.a,{container:!0,spacing:1},c.map((function(e){if((!e.cherry||o)&&(0===e.status||a))return r.a.createElement(Aa.a,{item:!0,xs:6,sm:3,md:3,lg:2,key:e.id},r.a.createElement(Ha,{manga:e}))})))}var $a=Object(k.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},cardsArea:{margin:e.spacing(5)},expand:{transform:"rotate(0deg)",marginLeft:"auto",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest})},expandOpen:{transform:"rotate(180deg)"}}}));function Ja(e){var a=$a(),t=Object(X.d)((function(e){return e.user.privilege})),l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=r.a.useState(!1),s=Object(O.a)(u,2),m=s[0],d=s[1],f=Object(X.d)((function(e){return e.site.showCherry})),p=Object(X.d)((function(e){return e.site.broadcast})),g=Object(X.c)();Object(n.useEffect)((function(){return ta("")}),[]);return r.a.createElement(da.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h5"},"\u6c49\u5316\u5de5\u623f"),r.a.createElement(ia.a,{variant:"h2"},"\u4e5d\u4e5d\u7ec4")),r.a.createElement(F.a,{alignSelf:"flex-end"},r.a.createElement(te.a,{className:Object(ba.default)(a.expand,Object(j.a)({},a.expandOpen,i)),onClick:function(){o(!i)},"aria-expanded":i,"aria-label":"\u66f4\u591a\u9009\u9879"},r.a.createElement(pa.a,null)))),r.a.createElement(ha.a,{className:a.filterArea,in:i,timeout:"auto",unmountOnExit:!0},r.a.createElement(F.a,{flexGrow:1}),r.a.createElement(F.a,{display:"flex",justifyContent:"flex-end"},t>=2&&r.a.createElement(Ia,null),r.a.createElement(ga.a,{checked:f,onChange:function(e){g(ea(e.target.checked))},value:f,size:"small",control:r.a.createElement(Ea.a,{color:"primary"}),label:"\u663e\u793a\u590f\u871c\u6a31\u6843\u7684\u4f5c\u54c1",labelPlacement:"start"}),r.a.createElement(ga.a,{checked:m,onChange:function(e){d(e.target.checked)},value:f,size:"small",control:r.a.createElement(Ea.a,{color:"primary"}),label:"\u663e\u793a\u4e0d\u518d\u66f4\u65b0\u7684\u4f5c\u54c1",labelPlacement:"start"}))),""!==p&&r.a.createElement(va.a,{variant:"outlined",severity:"info"},r.a.createElement(ya.a,null,"\u516c\u544a"),p),r.a.createElement(Ya,{showFinished:m}))}var Ka=t(294),Xa=t(89),Qa=t.n(Xa),Za=t(450),et=t.n(Za),at=t(451),tt=t.n(at),nt=t(354),rt=t.n(nt),lt=t(452),ct=t.n(lt),it=t(355),ot=t.n(it),ut=t(291),st=t.n(ut),mt=t(453),dt=t.n(mt),ft=t(454),pt=t.n(ft),gt=t(455),Et=t.n(gt),bt=t(456),ht=t.n(bt),vt=t(457),yt=t.n(vt),Ot=t(458),jt=t.n(Ot),wt=t(459),kt=t.n(wt),xt=t(460),St=t.n(xt),Ct=t(461),Tt=t.n(Ct),_t={Add:Object(n.forwardRef)((function(e,a){return r.a.createElement(et.a,Object.assign({},e,{ref:a}))})),Check:Object(n.forwardRef)((function(e,a){return r.a.createElement(tt.a,Object.assign({},e,{ref:a}))})),Clear:Object(n.forwardRef)((function(e,a){return r.a.createElement(rt.a,Object.assign({},e,{ref:a}))})),Delete:Object(n.forwardRef)((function(e,a){return r.a.createElement(ct.a,Object.assign({},e,{ref:a}))})),DetailPanel:Object(n.forwardRef)((function(e,a){return r.a.createElement(ot.a,Object.assign({},e,{ref:a}))})),Edit:Object(n.forwardRef)((function(e,a){return r.a.createElement(st.a,Object.assign({},e,{ref:a}))})),Export:Object(n.forwardRef)((function(e,a){return r.a.createElement(dt.a,Object.assign({},e,{ref:a}))})),Filter:Object(n.forwardRef)((function(e,a){return r.a.createElement(pt.a,Object.assign({},e,{ref:a}))})),FirstPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(Et.a,Object.assign({},e,{ref:a}))})),LastPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(ht.a,Object.assign({},e,{ref:a}))})),NextPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(ot.a,Object.assign({},e,{ref:a}))})),PreviousPage:Object(n.forwardRef)((function(e,a){return r.a.createElement(yt.a,Object.assign({},e,{ref:a}))})),ResetSearch:Object(n.forwardRef)((function(e,a){return r.a.createElement(rt.a,Object.assign({},e,{ref:a}))})),Search:Object(n.forwardRef)((function(e,a){return r.a.createElement(jt.a,Object.assign({},e,{ref:a}))})),SortArrow:Object(n.forwardRef)((function(e,a){return r.a.createElement(kt.a,Object.assign({},e,{ref:a}))})),ThirdStateCheck:Object(n.forwardRef)((function(e,a){return r.a.createElement(St.a,Object.assign({},e,{ref:a}))})),ViewColumn:Object(n.forwardRef)((function(e,a){return r.a.createElement(Tt.a,Object.assign({},e,{ref:a}))}))},Nt=Object(k.a)((function(e){return{smallBadge:{minWidth:"14px",width:"14px",height:"14px",fontSize:"10px",padding:"0",borderRadius:"50%"},lightBlueBadge:{backgroundColor:"lightBlue"},lightYellowBadge:{backgroundColor:"rgba(255, 255, 0, 0.5)"},lightRedBadge:{backgroundColor:"rgba(255, 82, 82, 0.5)"}}})),zt=function(e,a,t){return e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).length},Rt=function(e,a,t){var n=e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).map((function(e){return e.wait_status%4}));return n.length>0?Math.max.apply(Math,Object(Ka.a)(n)):0};function It(e){var a=Nt(),t=Object(b.g)(),n=e.tasks,l=function(e){switch(e){case 1:return"".concat(a.smallBadge," ").concat(a.lightBlueBadge);case 2:return"".concat(a.smallBadge," ").concat(a.lightYellowBadge);case 3:return"".concat(a.smallBadge," ").concat(a.lightRedBadge);default:return a.smallBadge}};return r.a.createElement(Qa.a,{icons:_t,columns:[{title:"\u6f2b\u753b",field:"mname",defaultGroupOrder:1,render:function(e){var a=e.split("\u9e2a\u9e2a\u9e2a"),t=Object(O.a)(a,2),c=t[0],i=t[1];return r.a.createElement(se.a,{badgeContent:zt(n,e,i),anchorOrigin:{vertical:"top",horizontal:"right"},overlap:"rectangle",classes:{badge:l(Rt(n,e,i))}},r.a.createElement("span",{style:{paddingRight:"10px"}},c))}},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"},defaultGroupOrder:0},{title:"\u6807\u7b7e",field:"tags",grouping:!1,render:function(e){return r.a.createElement(r.a.Fragment,null,e.tags.map((function(e,a){return r.a.createElement(Ua,{tag:e,size:"small",key:a})})))},sorting:!1},{title:"\u4e0a\u4e00\u6b21\u6d3b\u8dc3",field:"last_update",render:function(e){return ra(e.last_update)},grouping:!1}],options:{pageSize:20,grouping:!0,rowStyle:function(e){return{backgroundColor:{0:"transparent",1:"lightBlue",2:"rgba(255, 255, 0, 0.5)",3:"rgba(255, 82, 82, 0.5)"}[e.wait_status%4]||"transparent"}}},data:n,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,n){t.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})}var At=Object(k.a)((function(e){return{title:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},taskListItem:{marginTop:e.spacing(1)}}}));function Bt(){var e=At(),a=Object(n.useState)([]),t=Object(O.a)(a,2),l=t[0],c=t[1],i=Object(X.c)();return Object(n.useEffect)((function(){ta("\u4efb\u52a1\u5e7f\u573a"),i(Ze(!0)),Ge.a.get("https://api.mikan.mom/task",{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=e.tasks.map((function(e){return Object(xa.a)({},e,{mname:"".concat(e.mname,"\u9e2a\u9e2a\u9e2a").concat(e.type)})}));c(a)})).catch((function(e){i(Qe("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return i(Ze(!1))}))}),[]),r.a.createElement(da.a,null,r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement("div",{className:e.title},r.a.createElement(ia.a,{variant:"h2"},"\u4efb\u52a1\u5e7f\u573a")),r.a.createElement(It,{tasks:l})))}var Dt=t(159),Wt=t.n(Dt),Ft=Object(k.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function Lt(){var e=Ft(),a=Object(X.c)(),t=Object(b.g)(),l=(Object(b.h)().state||{from:{pathname:"/"}}).from;Object(n.useEffect)((function(){return ta("\u767b\u5f55")}),[]);return r.a.createElement(da.a,{component:"main",maxWidth:"xs"},r.a.createElement(w.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(fe.a,{className:e.avatar},r.a.createElement(Wt.a,null)),r.a.createElement(ia.a,{component:"h1",variant:"h5"},"\u767b\u5f55"),r.a.createElement("form",{className:e.form,onSubmit:function(e){e.preventDefault(),e.stopPropagation(),a(function(e,a,t,n){return function(r){r(Ze(!0)),Ge.a.post(Pe+"/token",Ve.a.stringify({username:e,password:a}),{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){window.localStorage.setItem("access_token",e.access_token),r(Ye()),t.replace(n)})).catch((function(e){try{console.log(e.response.data.detail),r(Qe(e.response.data.detail,"error"))}catch(a){r(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return r(Ze(!1))}))}}(document.getElementById("uid").value,document.getElementById("pass").value,t,l))}},r.a.createElement(Ca.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"uid",label:"\u7528\u6237ID",name:"uid",autoComplete:"uid",autoFocus:!0}),r.a.createElement(Ca.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"pass",label:"\u5bc6\u7801",type:"password",id:"pass",autoComplete:"current-password"}),r.a.createElement(N.a,{fullWidth:!0,variant:"contained",color:"primary",className:e.submit,type:"submit"},"\u767b\u5f55"))))}var Gt=t(5798),Pt=t(147),Mt=t(300),qt=t(359),Ut=t(349);function Vt(e){var a=e.mid,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=r.a.useState({no1:!0,no2:!1,no4:!0,no8:!0,empty:!1}),o=Object(O.a)(i,2),u=o[0],s=o[1],m=Object(X.c)(),d=function(){c(!1)},f=function(e){s(Object(xa.a)({},u,Object(j.a)({},e.target.name,e.target.checked)))};return r.a.createElement("div",null,r.a.createElement(N.a,{color:"primary",onClick:function(){c(!0)},variant:"outlined"},"\u65b0\u5efa\u7ae0\u8282"),r.a.createElement(Oa.a,{open:l,onClose:d,"aria-labelledby":"form-dialog-title"},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u65b0\u5efa\u7ae0\u8282"),r.a.createElement(Na.b,{onSubmit:function(e){var t=u.no1?1:0;t+=u.no2?2:0,t+=u.no4?4:0,t+=u.no8?8:0,t+=u.empty?16:0,e.ps="",console.log(t),console.log(e),Ge.a.put(qe+"/"+a+"/chapter",e,{params:{type:t},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),m(Qe(e.response.data.detail,"error"))}catch(a){m(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(wa.a,null,r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u7ae0\u8282\u6807\u9898",type:"string",fullWidth:!0,required:!0}),r.a.createElement(za.c,{margin:"dense",name:"id",label:"\u7ae0\u8282ID",type:"string",fullWidth:!0,required:!0,helperText:"\u7ae0\u8282ID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u540c\u4e00\u6f2b\u753b\u5185\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002"}),r.a.createElement(Pt.a,{component:"fieldset"},r.a.createElement(Mt.a,{component:"legend"},"\u81ea\u5b9a\u4e49\u4efb\u52a1\u6d41\u7a0b"),r.a.createElement(qt.a,{row:!0},r.a.createElement(ga.a,{control:r.a.createElement(Ut.a,{checked:u.no1,onChange:f,name:"no1"}),label:"\u65e0\u56fe\u6e90",disabled:u.empty}),r.a.createElement(ga.a,{control:r.a.createElement(Ut.a,{checked:u.no2,onChange:f,name:"no2"}),label:"\u65e0\u6821\u5bf9",disabled:u.empty}),r.a.createElement(ga.a,{control:r.a.createElement(Ut.a,{checked:u.no4,onChange:f,name:"no4"}),label:"\u65e0\u5ba1\u6838",disabled:u.empty}),r.a.createElement(ga.a,{control:r.a.createElement(Ut.a,{checked:u.no8,onChange:f,name:"no8"}),label:"\u65e0\u53d1\u5e03",disabled:u.empty}),r.a.createElement(ga.a,{control:r.a.createElement(Ut.a,{checked:u.empty,onChange:f,name:"empty"}),label:"\u7a7a\u9879\u76ee"})))),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:d,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}var Ht=t(5797),Yt=t(5796),$t=t(5757),Jt=t(5795),Kt=t(256),Xt=t.n(Kt),Qt=t(257),Zt=t.n(Qt),en=t(462),an=t.n(en),tn=t(258),nn=t.n(tn),rn=t(259),ln=t.n(rn),cn=t(260),on=t.n(cn),un=t(261),sn=t.n(un);function mn(e){return{0:r.a.createElement(Xt.a,null),1:r.a.createElement(Zt.a,null),2:r.a.createElement(an.a,null),3:r.a.createElement(nn.a,null),4:r.a.createElement(ln.a,null),5:r.a.createElement(on.a,null),6:r.a.createElement(sn.a,null)}[e]}function dn(e){var a=e.label;return r.a.createElement("div",null,r.a.createElement(Pa.a,Object.assign({},e,{variant:""===a.accept_by.uid?"outlined":"default",icon:mn(a.type),color:0===a.status||1===a.status?"primary":2===a.status?"secondary":"",size:"small",label:a.name,clickable:!0,"aria-label":"Task Chip",to:"/manga/"+a.mid+"/"+a.cid+"/"+a.id})))}function fn(e){var a=e.user,t=Object(b.g)();if(void 0===a)return r.a.createElement(r.a.Fragment,null);return r.a.createElement(Pa.a,Object.assign({variant:"outlined","aria-label":"User Chip",onClick:function(){t.push("/user/"+a.uid)},clickable:!0,avatar:r.a.createElement(De,{avatar:a.avatar,name:a.nickname}),label:a.nickname},e))}var pn=Object(k.a)((function(e){return{root:{width:"100%"},nominee:{marginBottom:10},completed:{color:e.palette.primary}}}));function gn(e){var a=pn(),t=e.vertical,n=e.chapter,l=e.mid,c=n.tasks,i=n.id;return r.a.createElement("div",{className:a.root},r.a.createElement(Ht.a,{alternativeLabel:!t,nonLinear:!0,activeStep:-1,orientation:t?"vertical":"horizontal"},c.map((function(e,a){return r.a.createElement(Jt.a,{key:e.name},r.a.createElement(Yt.a,{component:E.b,to:"/manga/"+l+"/"+i+"/"+e.id,completed:1===e.status},r.a.createElement($t.a,null,r.a.createElement(dn,{label:e}))),0!==e.accept_on&&(t?r.a.createElement($t.a,{icon:r.a.createElement("span",{style:{display:"inline-block",width:"24px",height:"24px"}})},r.a.createElement(fn,{user:e.accept_by,size:"small",style:{marginTop:"5px"}})):r.a.createElement($t.a,{icon:null},r.a.createElement(fn,{user:e.accept_by,size:"small"}))))}))))}var En=t(5802),bn=t(5791),hn=t(5792),vn=t(5790),yn=t(5789),On=t(472),jn=t(344);function wn(e){var a=e.chapter,t=e.order,n=Object(X.c)(),l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=function(){o(!1)};return r.a.createElement("div",null,r.a.createElement(N.a,{size:"small",color:"primary",onClick:function(){o(!0)}},"\u65b0\u5efa\u4efb\u52a1"),r.a.createElement(Oa.a,{open:i,onClose:u,"aria-labelledby":"form-dialog-title"},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u65b0\u5efa\u4efb\u52a1"),r.a.createElement(Na.b,{onSubmit:function(e){console.log(e),Ge.a.put(qe+"/"+a.mid+"/chapter/"+a.id+"/task",e,{params:{order:t},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),n(Qe(e.response.data.detail,"error"))}catch(a){n(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},initialValues:{type:0},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(wa.a,null,r.a.createElement(za.b,{name:"type",label:"\u7c7b\u578b",required:!0},r.a.createElement(jn.a,{value:0},mn(0),"\u5176\u4ed6"),r.a.createElement(jn.a,{value:1},mn(1),"\u56fe\u6e90"),r.a.createElement(jn.a,{value:2},mn(2),"\u7ffb\u8bd1"),r.a.createElement(jn.a,{value:3},mn(3),"\u6821\u5bf9"),r.a.createElement(jn.a,{value:4},mn(4),"\u5d4c\u5b57"),r.a.createElement(jn.a,{value:5},mn(5),"\u5ba1\u6838"),r.a.createElement(jn.a,{value:6},mn(6),"\u53d1\u5e03")),r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u4efb\u52a1\u6807\u9898",type:"string",required:!0,fullWidth:!0}),r.a.createElement(za.c,{margin:"dense",name:"id",label:"\u4efb\u52a1ID",type:"string",required:!0,fullWidth:!0})),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:u,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}var kn=t(5776),xn=t(463),Sn=t.n(xn);function Cn(e){var a=e.chapter,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=Object(X.c)(),o=Object(b.g)(),u=function(){c(!1)},s=r.a.useState([]),m=Object(O.a)(s,2),d=m[0],f=m[1];r.a.useEffect((function(){for(var e=a.tasks.slice(),t=0;t<e.length;t++)e[t].order=t;f(e)}),[]);return r.a.createElement("div",null,r.a.createElement(N.a,{variant:"outlined",size:"small",color:"primary",onClick:function(){c(!0)}},"\u7f16\u8f91\u7ae0\u8282"),r.a.createElement(Oa.a,{open:l,onClose:u,"aria-labelledby":"form-dialog-title"},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u7f16\u8f91\u7ae0\u8282"),r.a.createElement(Na.b,{onSubmit:function(e){e.tasks=d.map((function(e){return e.order})),e.ps=e.ps?e.ps:"",console.log(e),Ge.a.post(qe+"/"+a.mid+"/chapter/"+a.id,e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){e.id!==a.id&&o.replace("/manga/"+e.mid),window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),i(Qe(e.response.data.detail,"error"))}catch(a){i(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},initialValues:{name:a.name,id:a.id,ps:a.ps},render:function(e){var t=e.handleSubmit;return r.a.createElement("form",{onSubmit:t},r.a.createElement(wa.a,null,r.a.createElement(za.c,{margin:"dense",name:"name",label:"\u7ae0\u8282\u6807\u9898",type:"string",fullWidth:!0}),r.a.createElement(za.c,{margin:"dense",name:"id",label:"\u7ae0\u8282ID",type:"string",fullWidth:!0,helperText:"\u7ae0\u8282ID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u540c\u4e00\u6f2b\u753b\u5185\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002\u5efa\u8bae\uff1a\u7ae0\u8282\u6570\u5b57\u3002"}),r.a.createElement(za.c,{name:"ps",label:"\u5099\u8003",multiline:!0,rowsMax:5}),r.a.createElement(T.a,{subheader:r.a.createElement(kn.a,{component:"div"},r.a.createElement(F.a,{display:"flex",flexDirection:"row",alignItems:"flex-end"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(yn.a,null,"\u4efb\u52a1")),r.a.createElement(F.a,null,r.a.createElement(wn,{chapter:a,order:a.tasks.length}))))},r.a.createElement(On.a,{list:d,setList:f,animation:150},d.map((function(e,a){return r.a.createElement(_.a,{key:a},r.a.createElement(R.a,null,mn(e.type)),r.a.createElement(I.a,{primary:e.name}),r.a.createElement(Sn.a,null))}))))),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:u,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}var Tn=t(130);function _n(e){var a=e.id,t=e.name,n=e.api,l=e.callback,c=e.reload,i=Object(Tn.a)(e,["id","name","api","callback","reload"]),o=r.a.useState(!1),u=Object(O.a)(o,2),s=u[0],m=u[1],d=r.a.useState(),f=Object(O.a)(d,2),p=f[0],g=f[1],E=Object(X.c)(),h=Object(b.g)(),v=function(){m(!1)};return r.a.createElement("div",null,r.a.createElement(N.a,Object.assign({variant:"contained",color:"secondary",onClick:function(){m(!0)}},i),"\u5220\u9664",t),r.a.createElement(Oa.a,{open:s,onClose:v,"aria-labelledby":"form-dialog-title"},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u786e\u8ba4\u5220\u9664"),r.a.createElement(wa.a,null,r.a.createElement(yn.a,null,"\u5220\u9664\u540e\u5c06\u4e0d\u53ef\u6062\u590d"),a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(yn.a,null,"\u8bf7\u5728\u4e0b\u65b9\u91cd\u590d\u8f93\u5165ID\u4ee5\u786e\u8ba4"),r.a.createElement(Ca.a,{autoFocus:!0,margin:"dense",name:"name",label:a,type:"string",onChange:function(e){g(e.target.value)},fullWidth:!0,required:!0}))),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:v,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{onClick:function(){Ge.a.delete(n,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){c&&window.location.reload(),h.replace(l)})).catch((function(e){try{console.log(e.response.data.detail),E(Qe(e.response.data.detail,"error"))}catch(a){E(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},variant:"contained",color:"secondary",disabled:p!==a},"\u5220\u9664"))))}var Nn=Object(k.a)((function(e){return{root:{width:"100%"},rootExpanded:{width:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15)},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},details:{alignItems:"center"},taskChip:{marginRight:e.spacing(1)},summary:{width:"100%"}}}));function zn(e){var a=Nn(),t=Object(B.a)(),n=Object(A.a)(t.breakpoints.up("md")),l=e.chapter,c=e.adminAuth,i=e.mid,o=e.expanded,u=e.setExpanded;return r.a.createElement("div",{className:o===l.id?a.rootExpanded:a.root},r.a.createElement(En.a,{TransitionProps:{unmountOnExit:!0},expanded:o===l.id,onChange:function(){o===l.id?u(""):u(l.id)}},r.a.createElement(hn.a,{expandIcon:r.a.createElement(pa.a,null),"aria-controls":"chapter-summary"},r.a.createElement(F.a,{display:"flex",flexDirection:"row",className:a.summary},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{className:a.heading,noWrap:!0},l.name)),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},l.tasks.map((function(e,t){return 0===e.status&&r.a.createElement(dn,{label:e,key:t,className:a.taskChip,component:E.b})}))))),r.a.createElement(bn.a,{className:a.details},r.a.createElement(F.a,{display:"flex",flexDirection:"column",className:a.summary},r.a.createElement(gn,{vertical:!n,chapter:l,mid:i}),r.a.createElement(ia.a,{className:a.secondaryHeading},l.ps))),c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(vn.a,null,r.a.createElement(_n,{api:qe+"/"+i+"/chapter/"+l.id,callback:"/manga/"+i,className:a.button,size:"small",variant:"outlined",reload:!0}),r.a.createElement(Cn,{chapter:l})))))}var Rn=t(5800),In=t(5786),An=Object(k.a)((function(e){return{root:{width:"100%"}}}));function Bn(e){var a=An(),t=e.mid,n=e.adminAuth,l=r.a.useState(0),c=Object(O.a)(l,2),i=c[0],o=c[1];return r.a.createElement("div",{className:a.root},r.a.createElement(le.a,{position:"static",color:"transparent"},r.a.createElement(Rn.a,{value:i,onChange:function(e,a){o(a)}},r.a.createElement(In.a,{label:"\u672a\u5b8c\u6210"}),r.a.createElement(In.a,{label:"\u5df2\u5b8c\u6210"}))),r.a.createElement(Dn,{mid:t,listName:i,adminAuth:n}))}function Dn(e){var a=e.mid,t=e.listName,l=e.adminAuth,c=Object(n.useState)(!0),i=Object(O.a)(c,2),o=i[0],u=i[1],s=Object(n.useState)([]),m=Object(O.a)(s,2),d=m[0],f=m[1],p=Object(n.useState)(""),g=Object(O.a)(p,2),E=g[0],b=g[1],h=Object(X.c)();return r.a.useEffect((function(){u(!0),f([]),Ge.a.get(qe+"/"+a+"/chapter",{params:{query_status:t},withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.chapters&&f(e.chapters)})).catch((function(e){h(Qe("\u62c9\u53d6\u5217\u8868\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return u(!1)}))}),[t]),r.a.createElement(r.a.Fragment,null,o?r.a.createElement(me.a,null):d.map((function(e){return r.a.createElement(zn,{chapter:e,adminAuth:l,mid:a,key:e.id,expanded:E,setExpanded:b})})))}function Wn(e){var a=e.manga,t=Object(X.d)((function(e){return e.user.privilege})),n=r.a.useState(!1),l=Object(O.a)(n,2),c=l[0],i=l[1],o=Object(X.c)(),u=Object(b.g)(),s=function(){i(!1)};return r.a.createElement("div",null,r.a.createElement(N.a,{variant:"outlined",color:"primary",size:"small",onClick:function(){i(!0)}},"\u7f16\u8f91\u6f2b\u753b"),r.a.createElement(Oa.a,{open:c,onClose:s,"aria-labelledby":"form-dialog-title"},r.a.createElement(Na.b,{initialValues:{name:a.name,id:a.id,cherry:a.cherry,status:1===a.status,ps:a.ps},onSubmit:function(e){e.producer=document.getElementById("producer").value,e.cover=document.getElementById("cover").value,e.cherry=!0===e.cherry,e.status=!0===e.status?1:0,e.ps=e.ps?e.ps:"",console.log(e),Ge.a.post(qe+"/"+a.id,e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){e.id!==a.id&&u.replace("/manga/"+e.id),window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),o(Qe(e.response.data.detail,"error"))}catch(a){o(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var n=e.handleSubmit;return r.a.createElement("form",{onSubmit:n},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u7f16\u8f91\u6f2b\u753b"),r.a.createElement(wa.a,null,r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u6f2b\u753b\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(za.c,{margin:"dense",name:"id",label:"\u6f2b\u753bID",type:"string",fullWidth:!0,required:!0,helperText:"\u6f2b\u753bID\u4f1a\u51fa\u73b0\u5728URL\u4e0a\uff0c\u4e0d\u53ef\u91cd\u540d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u6c49\u5b57\u3002"}),r.a.createElement(za.a,{name:"cherry",data:{label:"\u590f\u871c\u6a31\u6843",value:"cherry"}}),r.a.createElement(za.a,{name:"status",data:{label:"\u4e0d\u518d\u66f4\u65b0",value:"cherry"}}),r.a.createElement(Na.a,{component:_a,name:"producer",label:"\u5236\u4f5c\u4eba",id:"producer",disabled:t<2,initVal:a.producer}),r.a.createElement(Na.a,{component:Ra,name:"cover",initVal:a.cover}),r.a.createElement(za.c,{name:"ps",label:"\u5099\u8003",multiline:!0,rowsMax:5})),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:s,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fee\u6539")))}})))}function Fn(e){var a=Object(b.g)(),t=e.auths;return r.a.createElement(Qa.a,{icons:_t,columns:[{title:"\u7528\u6237",field:"nickname"},{title:"\u5b8c\u6210\u8bdd\u6570",field:"count"},{title:"\u6700\u8fd1\u6d3b\u8dc3",field:"lastComplete",render:function(e){return na(e.lastComplete)}}],options:{pageSize:7,paging:!1},data:t,components:{Pagination:function(){return null},Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,t,n){a.push("/user/"+t.accept_uid)}})}var Ln=Object(k.a)((function(e){return{root:{width:"100%"},tabsWrap:{"& .MuiTabs-scrollableX":{overflowX:"auto"},"& .MuiTabs-flexContainer":{justifyContent:"space-around",flexWrap:"wrap"},"& .MuiTab-root":{minWidth:"33%",textAlign:"center"}}}}));function Gn(e){var a=Ln(),t=e.mid,n=r.a.useState(0),l=Object(O.a)(n,2),c=l[0],i=l[1],o=r.a.useState(!1),u=Object(O.a)(o,2),s=u[0],m=u[1],d=r.a.useState("\u8fd1\u671f"),f=Object(O.a)(d,2),p=f[0],g=f[1];return r.a.createElement("div",{className:a.root},r.a.createElement(Aa.a,{container:!0,alignItems:"center",spacing:0},r.a.createElement(Aa.a,{item:!0,xs:!0},r.a.createElement(Rn.a,{value:c,onChange:function(e,a){i(a)},className:a.tabsWrap},r.a.createElement(In.a,{label:"\u7ffb\u8bd1"}),r.a.createElement(In.a,{label:"\u6821\u5bf9"}),r.a.createElement(In.a,{label:"\u5d4c\u5b57"}))),r.a.createElement(Aa.a,{item:!0},r.a.createElement(N.a,{variant:"outlined",onClick:function(){g(s?"\u8fd1\u671f":"\u6240\u6709"),m(!s)},style:{borderColor:"lightblue",color:"#34ACE8","&:hover":{backgroundColor:"lightblue",borderColor:"lightblue"}}},p))),r.a.createElement(Pn,{mid:t,listNumber:c,isAll:s}))}function Pn(e){var a=e.mid,t=e.listNumber,l=e.isAll,c=Object(n.useState)(!0),i=Object(O.a)(c,2),o=(i[0],i[1]),u=Object(n.useState)([]),s=Object(O.a)(u,2),m=s[0],d=s[1],f=Object(X.c)();return r.a.useEffect((function(){void 0!==a&&null!==a&&(o(!0),d([]),Ge.a.get("".concat(qe,"/").concat(a,"/chapterAuth"),{params:{query_status:t,is_all_flag:l},withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.chapterauth&&d(e.chapterauth)})).catch((function(e){f(Qe("\u62c9\u53d6\u5217\u8868\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return o(!1)})))}),[a,t,l]),r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement(Fn,{auths:m}))}var Mn=Object(k.a)((function(e){return{root:{width:"100%",marginTop:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15)},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},details:{alignItems:"center"}}}));function qn(e){var a=Mn(),t=e.manga,n=e.adminAuth,l=r.a.useState(!0),c=Object(O.a)(l,2),i=c[0],o=c[1];return r.a.createElement(F.a,{display:"flex",flexDirection:"column",className:a.root},r.a.createElement(F.a,{display:"flex"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h5"},"\u8be6\u7ec6\u4fe1\u606f")),r.a.createElement(F.a,{alignSelf:"flex-end"},r.a.createElement(te.a,{className:Object(ba.default)(a.expand,Object(j.a)({},a.expandOpen,i)),onClick:function(){o(!i)},"aria-expanded":i,"aria-label":"\u8be6\u60c5"},r.a.createElement(pa.a,null)))),r.a.createElement(ha.a,{in:i,timeout:"auto",unmountOnExit:!0},r.a.createElement(bn.a,{className:a.details},r.a.createElement(F.a,{display:"flex",flexDirection:"column",style:{width:"100%"}},r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u5236\u4f5c\u4eba")),r.a.createElement(F.a,null,r.a.createElement(fn,{user:t.producer,size:"small"}))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u5f00\u5751\u65f6\u95f4")),r.a.createElement(F.a,null,na(t.create_on))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u6700\u540e\u4e00\u6b21\u6d3b\u8dc3")),r.a.createElement(F.a,null,na(t.last_update))),r.a.createElement(F.a,null,r.a.createElement(ia.a,{paragraph:!0},t.ps)))),r.a.createElement(C.a,null),r.a.createElement(vn.a,null,n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(_n,{api:qe+"/"+t.id,size:"small",variant:"outlined",callback:"",className:a.button,id:t.id,name:"\u6f2b\u753b"}),r.a.createElement(Wn,{manga:t})))),r.a.createElement(Gn,{mid:t.id}))}var Un=t(279);function Vn(e){var a=r.a.useState(!1),t=Object(O.a)(a,2),n=t[0],l=t[1],c=e.level,i=e.mid,o=e.cid,u=e.tid,s=Object(X.c)(),m=function(){l(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Pa.a,Object.assign({label:"+",size:"small",clickable:!0,onClick:function(){l(!0)}},e)),r.a.createElement(Oa.a,{open:n,onClose:m,"aria-labelledby":"form-dialog-title"},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u6dfb\u52a0\u6807\u7b7e"),r.a.createElement(Na.b,{onSubmit:function(e){e.level=c,e.mid=i,e.cid="string"===typeof o?o:"",e.tid="string"===typeof u?u:"",console.log(e),Ge.a.put("https://api.mikan.mom/tag",e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),s(Qe(e.response.data.detail,"error"))}catch(a){s(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(wa.a,null,r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u540d\u79f0",type:"string",fullWidth:!0,required:!0}),r.a.createElement(Un.a,null,"\u989c\u8272"),r.a.createElement(za.b,{name:"color",required:!0},r.a.createElement(jn.a,{value:"red"},r.a.createElement(Ua,{tag:{color:"red",name:"\u7ea2\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"pink"},r.a.createElement(Ua,{tag:{color:"pink",name:"\u7c89\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"blue"},r.a.createElement(Ua,{tag:{color:"blue",name:"\u84dd\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"purple"},r.a.createElement(Ua,{tag:{color:"purple",name:"\u7d2b\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"indigo"},r.a.createElement(Ua,{tag:{color:"indigo",name:"\u975b\u84dd\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"cyan"},r.a.createElement(Ua,{tag:{color:"cyan",name:"\u9752\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"teal"},r.a.createElement(Ua,{tag:{color:"teal",name:"\u6c34\u9e2d\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"lime"},r.a.createElement(Ua,{tag:{color:"lime",name:"\u7eff\u9ec4\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"orange"},r.a.createElement(Ua,{tag:{color:"orange",name:"\u6a58\u9ec4\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"brown"},r.a.createElement(Ua,{tag:{color:"brown",name:"\u68d5\u8272"},size:"small",clickable:!0})),r.a.createElement(jn.a,{value:"gray"},r.a.createElement(Ua,{tag:{color:"gray",name:"\u7070\u8272"},size:"small",clickable:!0})))),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:m,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{onClick:a,color:"primary"},"\u6dfb\u52a0")))}})))}var Hn=t(5793);function Yn(e){var a=e.task,t=Object(X.c)(),n=Object(b.g)(),l=r.a.useState(!1),c=Object(O.a)(l,2),i=c[0],o=c[1],u=function(){o(!1)};return r.a.createElement("div",null,r.a.createElement(N.a,Object.assign({variant:"outlined",size:"small",color:"primary",onClick:function(){o(!0)}},e),"\u7f16\u8f91\u4efb\u52a1"),r.a.createElement(Oa.a,{open:i,onClose:u,"aria-labelledby":"form-dialog-title"},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u7f16\u8f91\u4efb\u52a1"),r.a.createElement(Na.b,{onSubmit:function(e){console.log(e),Ge.a.post(qe+"/"+a.mid+"/chapter/"+a.cid+"/task/"+a.id,e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){e.id!==a.id&&n.replace("/manga/"+e.mid+"/"+e.cid+"/"+e.id),window.location.reload()})).catch((function(e){try{console.log(e.response.data.detail),t(Qe(e.response.data.detail,"error"))}catch(a){t(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))},initialValues:{type:a.type,name:a.name,id:a.id},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(wa.a,null,r.a.createElement(za.b,{name:"type",label:"\u7c7b\u578b",required:!0},r.a.createElement(jn.a,{value:0},mn(0),"\u5176\u4ed6"),r.a.createElement(jn.a,{value:1},mn(1),"\u56fe\u6e90"),r.a.createElement(jn.a,{value:2},mn(2),"\u7ffb\u8bd1"),r.a.createElement(jn.a,{value:3},mn(3),"\u6821\u5bf9"),r.a.createElement(jn.a,{value:4},mn(4),"\u5d4c\u5b57"),r.a.createElement(jn.a,{value:5},mn(5),"\u5ba1\u6838"),r.a.createElement(jn.a,{value:6},mn(6),"\u53d1\u5e03")),r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"name",label:"\u4efb\u52a1\u6807\u9898",type:"string",required:!0,fullWidth:!0}),r.a.createElement(za.c,{margin:"dense",name:"id",label:"\u4efb\u52a1ID",type:"string",required:!0,fullWidth:!0})),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:u,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}function $n(e){return r.a.createElement(r.a.Fragment,null)}var Jn=t(464),Kn=t.n(Jn),Xn=t(465),Qn=t.n(Xn);function Zn(e){var a=e.status,t=Object(Tn.a)(e,["status"]);return r.a.createElement(r.a.Fragment,null,0===a&&r.a.createElement(st.a,t),1===a&&r.a.createElement(Kn.a,t),2===a&&r.a.createElement(Qn.a,t))}var er=t(343),ar=t(5759),tr=Object(k.a)((function(e){return{root:{width:"100%"},listItem:{marginLeft:e.spacing(1),marginRight:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(1)},button:{marginLeft:e.spacing(1)}}})),nr=function(e){switch(e%4){case 1:return{color:"lightBlue",label:"\u4e09\u6210\u719f"};case 2:return{color:"rgba(255, 255, 0, 0.5)",label:"\u4e94\u6210\u719f"};case 3:return{color:"rgba(255, 82, 82, 0.5)",label:"\u4e03\u6210\u719f"};default:return{color:"rgba(46, 255, 60, 0.7)",label:"\u65b0\u9c9c"}}};function rr(e){var a=tr(),t=e.task,l=e.adminAuth,c=Object(n.useState)(),i=Object(O.a)(c,2),o=i[0],u=i[1],s=Object(X.c)();r.a.useEffect((function(){u(t)}),[t]);return r.a.createElement("div",{className:a.root},r.a.createElement(F.a,{display:"flex",flexDirection:"column"},r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h6"},"\u627f\u63a5\u4eba")),r.a.createElement(F.a,null,o&&""!==o.accept_by.uid&&r.a.createElement(fn,{user:o.accept_by,onDelete:l&&(0===o.status||2===o.status)&&function(){s(Ze(!0)),Ge.a.delete(qe+"/"+o.mid+"/chapter/"+o.cid+"/task/"+o.id+"/charge",{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){u(Object.assign({},o,{accept_by:{uid:"",nickname:"",avatar:""}}))})).catch((function(e){try{console.log(e.response.data.detail),s(Qe(e.response.data.detail,"error"))}catch(a){s(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return s(Ze(!1))}))}}),o&&""===o.accept_by.uid&&r.a.createElement(lr,Object.assign({taskState:o,setTaskState:u},e)))),r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h6"},"\u72b6\u6001")),r.a.createElement(F.a,null,r.a.createElement(ia.a,{variant:"h6"},o&&0===o.status&&r.a.createElement(Zn,{status:0}),o&&1===o.status&&r.a.createElement(Zn,{status:1}),o&&2===o.status&&r.a.createElement(Zn,{status:2}))),r.a.createElement(F.a,null,o&&r.a.createElement(cr,Object.assign({taskState:o,setTaskState:u},e)))),o&&null!==o.wait_status&&0===o.status&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h6"},"\u9e3d\u5ea6")),console.log(o),r.a.createElement(ir,Object.assign({taskState:o,setTaskState:u},e)))),o&&""!==o.accept_by.uid&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u627f\u63a5\u65f6\u95f4")),r.a.createElement(F.a,null,ra(o.accept_on)))),o&&1===o.status&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u5b8c\u6210\u65f6\u95f4")),r.a.createElement(F.a,null,ra(o.complete_on)))),r.a.createElement(C.a,null),r.a.createElement(F.a,{display:"flex",className:a.listItem},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u521b\u5efa\u65f6\u95f4")),r.a.createElement(F.a,null,o&&ra(o.create_on)))),r.a.createElement($n,{data:o&&o.data}))}function lr(e){var a=tr(),t=e.taskState,l=e.adminAuth,c=e.setTaskState,i=Object(X.d)((function(e){return e.user.privilege})),o=Object(X.d)((function(e){return e.user.uid})),u=Object(X.c)(),s=Object(n.useState)(!1),m=Object(O.a)(s,2),d=m[0],f=m[1],p=function(){f(!1)},g=function(e){return function(){e===o&&u(Ke()),u(Ze(!0)),Ge.a.get(qe+"/"+t.mid+"/chapter/"+t.cid+"/task/"+t.id+"/charge",{params:{assign_to:e},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){c(e)})).catch((function(e){try{console.log(e.response.data.detail),u(Qe(e.response.data.detail,"error"))}catch(a){u(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return u(Ze(!1))}))}};return 0===i?r.a.createElement(ia.a,null,"\u65e0"):r.a.createElement(r.a.Fragment,null,l&&r.a.createElement(N.a,{variant:"contained",color:"primary",onClick:function(){f(!0)},className:a.button},"\u5206\u914d"),0===t.status&&r.a.createElement(N.a,{variant:"contained",color:"primary",onClick:g(o),className:a.button},"\u627f\u63a5"),r.a.createElement(Oa.a,{open:d,onClose:p,"aria-labelledby":"form-dialog-title",maxWidth:"sm",fullWidth:!0},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u5206\u914d"),r.a.createElement(Na.b,{onSubmit:function(e){g(e.assign_to)(),p()},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(wa.a,null,r.a.createElement(Na.a,{component:_a,name:"assign_to",label:"\u5206\u914d"})),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:p,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}function cr(e){var a=tr(),t=e.taskState,n=e.adminAuth,l=e.setTaskState,c=Object(X.d)((function(e){return e.user.uid})),i=Object(X.c)(),o=function(e){return function(){i(Ze(!0)),Ge.a.get(qe+"/"+t.mid+"/chapter/"+t.cid+"/task/"+t.id+"/status",{params:{to:e},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(a){l(a),1===e&&t.accept_by.uid===c&&i(Ke())})).catch((function(e){try{console.log(e.response.data.detail),i(Qe(e.response.data.detail,"error"))}catch(a){i(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return i(Ze(!1))}))}};return r.a.createElement(r.a.Fragment,null,0===t.status&&r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(N.a,{variant:"contained",color:"secondary",size:"small",onClick:o(2),className:a.button},r.a.createElement(Zn,{status:2}),"\u505c\u6b62"),(t.accept_by.uid===c||n)&&""!==t.accept_by.uid&&r.a.createElement(N.a,{variant:"contained",color:"primary",size:"small",onClick:o(1),className:a.button},r.a.createElement(Zn,{status:1}),"\u5b8c\u6210")),n&&r.a.createElement(r.a.Fragment,null,t&&1===t.status&&r.a.createElement(N.a,{variant:"contained",color:"primary",size:"small",onClick:o(0),className:a.button},r.a.createElement(Zn,{status:0}),"\u518d\u5f00"),t&&2===t.status&&r.a.createElement(N.a,{variant:"contained",color:"primary",size:"small",onClick:o(0),className:a.button},r.a.createElement(Zn,{status:0}),"\u5f00\u59cb")))}function ir(e){var a=e.taskState,t=e.adminAuth,l=e.setTaskState,c=Object(n.useState)(a.wait_status),i=Object(O.a)(c,2),o=i[0],u=i[1],s=Object(X.c)(),m=Object(n.useState)(!1),d=Object(O.a)(m,2),f=d[0],p=d[1],g=function(){p(!1)},E=function(e){return function(){s(Ze(!0)),Ge.a.get(qe+"/"+a.mid+"/chapter/"+a.cid+"/task/"+a.id+"/waitStatusChange",{params:{selected_value:e},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){l(e)})).catch((function(e){try{console.log(e.response.data.detail),s(Qe(e.response.data.detail,"error"))}catch(a){s(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return s(Ze(!1))}))}};return r.a.createElement(r.a.Fragment,null,t&&r.a.createElement(Pa.a,{style:{backgroundColor:nr(a.wait_status).color},onClick:function(){p(!0)},label:nr(a.wait_status).label}),!t&&r.a.createElement(Pa.a,{style:{backgroundColor:nr(a.wait_status).color},label:nr(a.wait_status).label}),r.a.createElement(Oa.a,{open:f,onClose:g,"aria-labelledby":"form-dialog-title",maxWidth:"sm",fullWidth:!0},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u4fee\u6539"),r.a.createElement(wa.a,null,r.a.createElement(Pt.a,{component:"fieldset"},r.a.createElement(er.a,{"aria-label":"gender",name:"gender1",value:String(o),onChange:function(e){u(e.target.value)},row:!0},r.a.createElement(ga.a,{value:"4",control:r.a.createElement(ar.a,null),label:"\u65b0\u9c9c"}),r.a.createElement(ga.a,{value:"5",control:r.a.createElement(ar.a,null),label:"\u4e09\u6210\u719f"}),r.a.createElement(ga.a,{value:"6",control:r.a.createElement(ar.a,null),label:"\u4e94\u6210\u719f"}),r.a.createElement(ga.a,{value:"7",control:r.a.createElement(ar.a,null),label:"\u4e03\u6210\u719f"}),r.a.createElement(ga.a,{value:"0",control:r.a.createElement(ar.a,null),label:"\u81ea\u52a8\u8bbe\u7f6e"})))),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:g,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{onClick:function(){E(o)(),g()},color:"primary"},"\u4fdd\u5b58"))))}var or=Object(k.a)((function(e){return{root:{width:"100%"},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)},button:{marginLeft:e.spacing(1)}}}));function ur(e){var a=or(),t=e.manga,l=e.chapter,c=e.tid,i=e.adminAuth,o=Object(n.useState)(),u=Object(O.a)(o,2),s=u[0],m=u[1],d=Object(X.c)();return r.a.useEffect((function(){d(Ze(!0)),Ge.a.get(qe+"/"+t.id+"/chapter/"+l.id+"/task/"+c,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){m(e),ta(t.name+l.name+e.name)})).catch((function(e){d(Qe("\u83b7\u53d6\u4efb\u52a1\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return d(Ze(!1))}))}),[c]),r.a.createElement("div",{className:a.root},r.a.createElement(ia.a,{variant:"h5"},"object"===typeof s&&"object"===typeof s.tags&&s.tags.map((function(e,n){return r.a.createElement(Ua,{key:n,size:"small",tag:e,className:a.label,deletable:i?"true":"false",mid:t.id,cid:l.id,tid:c})}))||r.a.createElement(Gt.a,null),"object"===typeof t.tags&&i&&r.a.createElement(Vn,{className:a.label,level:2,mid:t.id,cid:l.id,tid:c})),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h3"},s&&r.a.createElement(r.a.Fragment,null,mn(s.type),s.name)||r.a.createElement(Gt.a,null))),s&&i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(_n,{api:qe+"/"+t.id+"/chapter/"+l.id+"/task/"+c,name:"\u4efb\u52a1",variant:"outlined",size:"small",callback:"/manga/"+t.id,className:a.button}),r.a.createElement(Yn,{task:s,className:a.button}))),s&&r.a.createElement(rr,{task:s,adminAuth:i}))}var sr=t(5794),mr=t(466),dr=t.n(mr),fr=t(467),pr=t.n(fr),gr=Object(k.a)((function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},details:{alignItems:"center"},staffItem:{marginRight:e.spacing(1)},summary:{width:"100%"}}}));function Er(e){var a=gr(),t=e.chapter,n=e.adminAuth;return r.a.createElement("div",{className:a.root},r.a.createElement(En.a,null,r.a.createElement(hn.a,{expandIcon:r.a.createElement(pa.a,null),"aria-controls":"chapter-summary"},r.a.createElement(ia.a,{className:a.heading,noWrap:!0},t.name)),r.a.createElement(bn.a,{className:a.details},r.a.createElement(F.a,{display:"flex",flexDirection:"column",className:a.summary},r.a.createElement(ia.a,null,"Staff"),r.a.createElement(F.a,{display:"flex",alignItems:"center"},t.tasks.map((function(e,t){if(""!==e.accept_by.uid)return r.a.createElement("span",{className:a.staffItem,key:t},r.a.createElement("span",null,e.name),r.a.createElement(fn,{user:e.accept_by,size:"small"}))}))),r.a.createElement(ia.a,null,"\u5099\u8003"),r.a.createElement(ia.a,{className:a.secondaryHeading},t.ps))),n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null),r.a.createElement(vn.a,null,r.a.createElement(_n,{api:qe+"/"+t.mid+"/chapter/"+t.id,name:"\u7ae0\u8282",callback:"/manga/"+t.mid,className:a.button,size:"small",variant:"outlined"}),r.a.createElement(Cn,{chapter:t})))))}var br=Object(k.a)((function(e){return{root:{width:"100%"}}}));function hr(e){var a=br(),t=e.manga,l=e.adminAuth,c=Object(b.i)(),i=c.cid,o=c.tid,u=Object(n.useState)(),s=Object(O.a)(u,2),m=s[0],d=s[1],f=Object(X.c)(),p=Object(b.g)(),g=Object(n.useState)(0),E=Object(O.a)(g,2),h=E[0],v=E[1];r.a.useEffect((function(){f(Ze(!0)),Ge.a.get(qe+"/"+t.id+"/chapter/"+i,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){for(var a=0;a<e.tasks.length;a++)if(e.tasks[a].id===o){v(a);break}d(e)})).catch((function(e){f(Qe("\u83b7\u53d6\u7ae0\u8282\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return f(Ze(!1))}))}),[]);return r.a.createElement("div",{className:a.root},m&&r.a.createElement(Er,{chapter:m,mid:t.id,adminAuth:l}),m&&r.a.createElement(sr.a,{position:"static",activeStep:h,backButton:r.a.createElement(N.a,{size:"small",onClick:function(){p.replace("/manga/"+t.id+"/"+m.id+"/"+m.tasks[h-1].id),v(h-1)},disabled:0===h},r.a.createElement(dr.a,null),"\u4e0a\u4e00\u4e2a\u4efb\u52a1"),nextButton:r.a.createElement(N.a,{size:"small",onClick:function(){p.replace("/manga/"+t.id+"/"+m.id+"/"+m.tasks[h+1].id),v(h+1)},disabled:h===m.tasks.length-1},"\u4e0b\u4e00\u4e2a\u4efb\u52a1",r.a.createElement(pr.a,null)),steps:m.tasks.length}),m&&r.a.createElement(ur,Object.assign({chapter:m},e,{tid:m.tasks[h].id})))}var vr=Object(k.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(1)},coverCard:{maxWidth:275,position:"relative"},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)}}}));function yr(e){var a=vr(),t=Object(b.i)().mid,l=Object(b.j)().path,c=Object(X.c)(),i=Object(X.d)((function(e){return e.user.privilege})),o=Object(X.d)((function(e){return e.user.uid})),u=Object(n.useState)(!1),s=Object(O.a)(u,2),m=s[0],d=s[1],f=Object(n.useState)({}),p=Object(O.a)(f,2),g=p[0],h=p[1];return r.a.useEffect((function(){c(Ze(!0)),Ge.a.get(qe+"/"+t,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){h(e),ta(e.name)})).catch((function(e){c(Qe("\u83b7\u53d6\u6f2b\u753b\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return c(Ze(!1))}))}),[]),r.a.useEffect((function(){d(i>=2||"object"===typeof g.producer&&g.producer.uid===o)}),[i,o,g]),r.a.createElement(da.a,{maxWidth:"lg"},r.a.createElement(F.a,{display:"flex",alignItems:"flex-end",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h5"},"object"===typeof g.tags&&g.tags.map((function(e,n){return r.a.createElement(Ua,{key:n,size:"small",tag:e,className:a.label,deletable:m?"true":"false",mid:t})}))||r.a.createElement(Gt.a,null),"object"===typeof g.tags&&m&&r.a.createElement(Vn,{className:a.label,level:0,mid:g.id})),r.a.createElement(ia.a,{variant:"h2"},r.a.createElement(Hn.a,{component:E.b,to:"/manga/"+g.id,color:"inherit"},g.name)||r.a.createElement(Gt.a,null))),r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:l},r.a.createElement(F.a,null,m&&r.a.createElement(Vt,{mid:g.id}))))),r.a.createElement(Aa.a,{container:!0,spacing:2},r.a.createElement(Aa.a,{item:!0,xs:12,md:3},r.a.createElement(F.a,{display:"flex",p:1,justifyContent:"center",flexDirection:"column",alignItems:"center"},r.a.createElement(Ba.a,{className:a.coverCard},r.a.createElement(Fa.a,{component:"img",image:g.cover||Ga.a,title:g.name})),r.a.createElement(qn,{manga:g,adminAuth:m}))),r.a.createElement(Aa.a,{item:!0,xs:12,md:9},r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:l},r.a.createElement(Bn,{mid:t,adminAuth:m})),r.a.createElement(b.b,{path:"".concat(l,"/:cid/:tid")},g.id&&r.a.createElement(hr,{adminAuth:m,manga:g}))))))}function Or(e){var a=e.children,t=Object(Tn.a)(e,["children"]),n=Object(X.d)((function(e){return e.user.privilege}));return Object(X.d)((function(e){return e.user.logging}))?r.a.createElement("div",null):r.a.createElement(b.b,Object.assign({},t,{render:function(e){var t=e.location;return n>0?a:r.a.createElement(b.a,{to:{pathname:"/login",state:{from:t}}})}}))}function jr(e){var a=r.a.useState(),t=Object(O.a)(a,2),n=t[0],l=t[1],c=Object(X.d)((function(e){return e.user.uid})),i=Object(X.c)(),o=Object(b.g)();return r.a.useEffect((function(){i(Ze(!0)),Ge.a.get(Me+"/"+c+"/tasks",{headers:$e(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){l(e.tasks)})).catch((function(e){i(Qe("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return i(Ze(!1))}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ia.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u4efb\u52a1"),r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},n&&r.a.createElement(Qa.a,{icons:_t,columns:[{title:"\u6f2b\u753b",field:"mname"},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"}},{title:"\u4e0a\u4e00\u6b21\u6d3b\u8dc3",field:"last_update",render:function(e){return ra(e.last_update)}},{title:"\u72b6\u6001",field:"status",render:function(e){return r.a.createElement(Zn,{status:e.status})},defaultSort:"asc"}],options:{pageSize:20},data:n,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,t){o.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})))}function wr(e){var a=e.uid,t=r.a.useState(!1),n=Object(O.a)(t,2),l=n[0],c=n[1],i=Object(X.c)(),o=function(){c(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,{variant:"contained",color:"secondary",style:{marginTop:"0.5rem"},onClick:function(){c(!0)}},"\u4fee\u6539\u5bc6\u7801"),r.a.createElement(Oa.a,{open:l,onClose:o},r.a.createElement(Na.b,{onSubmit:function(e){console.log(e),e.password===e["re-password"]?(i(Ze(!0)),Ge.a.post(Me+"/"+a+"/password",e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){c(!1),i(Qe("\u4fee\u6539\u6210\u529f","success"))})).catch((function(e){try{console.log(e.response.data.detail),i(Qe(e.response.data.detail,"error"))}catch(a){i(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return i(Ze(!1))}))):i(Qe("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4","error"))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u4fee\u6539\u5bc6\u7801"),r.a.createElement(wa.a,null,r.a.createElement(yn.a,null,"\u5bc6\u7801\u662f6-32\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7a7a\u683c\u6216\u5982\u4e0b\u7279\u6b8a\u5b57\u7b26\u7684\u7ec4\u5408\u3002-+_!=@#$%^&*?([)].;:"),r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"password",label:"\u65b0\u5bc6\u7801",type:"password",fullWidth:!0,required:!0}),r.a.createElement(za.c,{margin:"dense",name:"re-password",label:"\u91cd\u590d\u65b0\u5bc6\u7801",type:"password",fullWidth:!0,required:!0})),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:o,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fee\u6539")))}})))}function kr(e){var a=Object(X.d)((function(e){return e.user.uid})),t=r.a.useState(),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(X.c)();Object(n.useEffect)((function(){o(Ze(!0)),Ge.a.get(Me+"/"+a,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){i(e)})).catch((function(e){o(Qe("\u83b7\u53d6\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return o(Ze(!1))}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ia.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u8d26\u6237\u8bbe\u7f6e"),r.a.createElement(Na.b,{initialValues:c&&{uid:c.uid,nickname:c.nickname,introduction:c.introduction},onSubmit:function(e){e.introduction=e.introduction||"",console.log(e),o(Ze(!0)),Ge.a.post(Me+"/"+a,e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){o(Qe("\u4fee\u6539\u6210\u529f","success"))})).catch((function(e){try{console.log(e.response.data.detail),o(Qe(e.response.data.detail,"error"))}catch(a){o(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return o(Ze(!1))}))},render:function(e){var t=e.handleSubmit;return r.a.createElement("form",{onSubmit:t},r.a.createElement(F.a,{display:"flex",flexDirection:"column",alignItems:"flex-start"},r.a.createElement(za.c,{name:"uid",label:"\u7528\u6237ID",disabled:!0,required:!0}),r.a.createElement(za.c,{name:"nickname",label:"\u6635\u79f0",required:!0}),r.a.createElement(za.c,{name:"introduction",label:"\u81ea\u6211\u4ecb\u7ecd",multiline:!0,rowsMax:5}),r.a.createElement(wr,{uid:a}),r.a.createElement(N.a,{type:"submit",variant:"contained",color:"primary",style:{marginTop:"1rem"}},"\u4fdd\u5b58")))}}))}var xr=t(113),Sr=t(468),Cr=t(262),Tr=t.n(Cr);function _r(e){var a=r.a.useState(),t=Object(O.a)(a,2),n=t[0],l=t[1],c=Object(X.c)();r.a.useEffect((function(){c(Ze(!0)),Ge.a.get(Pe+"/profile/i_code",{headers:$e(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){l(e.icodes)})).catch((function(e){c(Qe("\u62c9\u53d6\u9080\u8bf7\u7801\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return c(Ze(!1))}))}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ia.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u7ba1\u7406"),r.a.createElement(F.a,{display:"flex",flexDirection:"column"},r.a.createElement(F.a,null,r.a.createElement(Nr,{style:{marginBottom:"1rem"}})),r.a.createElement(F.a,null,r.a.createElement(N.a,{variant:"contained",color:"primary",onClick:function(){Ge.a.put(Pe+"/profile/i_code",null,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=n.slice(0);a.push(e),l(Object.assign(a))})).catch((function(e){try{console.log(e.response.data.detail),c(Qe(e.response.data.detail,"error"))}catch(a){c(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}}))}},"\u6dfb\u52a0\u9080\u8bf7\u7801"),n&&n.map((function(e,a){return r.a.createElement(xr.a,{style:{width:"100%"},key:a},r.a.createElement(F.a,{display:"flex",flexDirection:"row",alignItems:"center"},r.a.createElement(Sr.CopyToClipboard,{text:"https://mikan.mom/signup?icode="+e.icode,onCopy:function(){c(Qe("\u5df2\u590d\u5236\u9080\u8bf7\u94fe\u63a5","success"))}},r.a.createElement(te.a,null,r.a.createElement(Tr.a,null))),r.a.createElement(ia.a,{variant:"body1",noWrap:!0,flexGrow:1},e.icode)))})))))}function Nr(e){var a=r.a.useState(!1),t=Object(O.a)(a,2),n=t[0],l=t[1],c=Object(X.c)(),i=Object(X.d)((function(e){return e.site.broadcast})),o=function(){l(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(N.a,Object.assign({variant:"contained",color:"primary",style:{marginTop:"0.5rem"},onClick:function(){l(!0)}},e),"\u4fee\u6539\u516c\u544a"),r.a.createElement(Oa.a,{open:n,onClose:o,maxWidth:"md"},r.a.createElement(Na.b,{onSubmit:function(e){e.broadcast||(e.broadcast=""),console.log(e),c(Ze(!0)),Ge.a.post(Pe+"/env",null,{params:{key:"broadcast",value:e.broadcast},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(a){l(!1),c(aa(e.broadcast)),c(Qe("\u4fee\u6539\u6210\u529f","success"))})).catch((function(e){try{console.log(e.response.data.detail),c(Qe(e.response.data.detail,"error"))}catch(a){c(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return c(Ze(!1))}))},initialValues:{broadcast:i},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(ka.a,{id:"form-dialog-title"},"\u4fee\u6539\u516c\u544a"),r.a.createElement(wa.a,null,r.a.createElement(za.c,{autoFocus:!0,margin:"dense",name:"broadcast",label:"\u516c\u544a",fullWidth:!0,multiline:!0,rowsMax:5})),r.a.createElement(ja.a,null,r.a.createElement(N.a,{onClick:o,color:"primary"},"\u53d6\u6d88"),r.a.createElement(N.a,{type:"submit",color:"primary"},"\u4fdd\u5b58")))}})))}var zr=Object(k.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(1)}}}));function Rr(e){var a=zr(),t=r.a.useState(0),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(X.d)((function(e){return e.user.nickname})),u=Object(X.d)((function(e){return e.user.privilege})),s=Object(B.a)(),m=Object(A.a)(s.breakpoints.up("md")),d=Object(X.c)(),f=Object(b.g)();Object(n.useEffect)((function(){return ta(o)}),[]);return r.a.createElement(da.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1,alignItems:"flex-end"},r.a.createElement(ia.a,{variant:"h5"},"\u6b22\u8fce\u60a8,"),r.a.createElement(ia.a,{variant:"h2"},o)),r.a.createElement(F.a,null,r.a.createElement(N.a,{onClick:function(){window.localStorage.removeItem("access_token"),d({type:"CLEAN_USER"}),f.push("/")}},"\u767b\u51fa"))),r.a.createElement(F.a,{display:"flex",flexGrow:1,alignItems:"flex-start",flexDirection:m?"row":"column"},r.a.createElement(Rn.a,{orientation:m?"vertical":"horizontal",variant:"scrollable",value:c,onChange:function(e,a){i(a)},className:a.tabs},r.a.createElement(In.a,{label:"\u4efb\u52a1"}),r.a.createElement(In.a,{label:"\u8bbe\u7f6e"}),u>2&&r.a.createElement(In.a,{label:"\u7ba1\u7406"})),r.a.createElement(Ir,{value:c,index:0},r.a.createElement(jr,null)),r.a.createElement(Ir,{value:c,index:1},r.a.createElement(kr,null)),r.a.createElement(Ir,{value:c,index:2},r.a.createElement(_r,null))))}function Ir(e){var a=e.children,t=e.value,n=e.index,l=Object(Tn.a)(e,["children","value","index"]);return r.a.createElement("div",Object.assign({style:{width:"100%"},hidden:t!==n},l),t===n&&r.a.createElement(F.a,{p:3},a))}var Ar=t(292);function Br(e){var a=Object(Ar.useSnackbar)(),t=a.enqueueSnackbar,n=a.closeSnackbar,l=Object(X.d)((function(e){return e.site.snackMsg})),c=function(e){return function(){return n(e)}};return r.a.useEffect((function(){if("object"===typeof l&&"string"===typeof l.message&&""!==l.message){var e={variant:l.variant};l.dismissable&&Object.assign(e,{action:function(e){return r.a.createElement(N.a,{onClick:c(e)},"\u5ffd\u7565")}}),t(l.message,e)}}),[l]),r.a.createElement("div",null)}var Dr=Object(k.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(5)}}}));function Wr(e){var a=Dr(),t=Object(n.useState)(!1),l=Object(O.a)(t,2),c=l[0],i=l[1],o=new URLSearchParams(Object(b.h)().search);return r.a.useEffect((function(){ta("\u6388\u6743"),Ge.a.get("https://api.mikan.mom/third_party/auth_code",{params:{client_id:o.get("client_id")},headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=e.access_token;window.location.href=o.get("redirect_uri")+"?code="+a+"&state="+o.get("state")})).catch((function(){return i(!0)}))}),[]),r.a.createElement(da.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h5"},c?"\u8bf7\u91cd\u8bd5":"\u767b\u5f55\u5230"+o.get("client_id")),r.a.createElement(ia.a,{variant:"h2"},c?"\u6388\u6743\u5931\u8d25":"\u6b63\u5728\u6388\u6743..."))))}function Fr(){return r.a.useEffect((function(){window.location.href="https://pan.mikan.mom"}),[]),r.a.createElement(da.a,null,r.a.createElement(ia.a,{variant:"h3"},"\u6b63\u5728\u8df3\u8f6c..."),r.a.createElement(ia.a,{variant:"h5"},"\u5982\u65e0\u8df3\u8f6c, ",r.a.createElement("a",{href:"https://pan.mikan.mom"},"\u8bf7\u70b9\u51fb\u8fd9\u91cc\u3002")))}function Lr(e){var a=Object(b.g)(),t=e.users;return r.a.createElement(Qa.a,{icons:_t,columns:[{title:"\u6635\u79f0",field:"nickname"},{title:"\u7528\u6237ID",field:"uid"}],options:{pageSize:20},data:t,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,t,n){a.push("/user/"+t.uid)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})}var Gr=Object(k.a)((function(e){return{title:{marginTop:e.spacing(5),marginBottom:e.spacing(5)}}}));function Pr(){var e=Gr(),a=Object(n.useState)([]),t=Object(O.a)(a,2),l=t[0],c=t[1],i=Object(n.useState)([]),o=Object(O.a)(i,2),u=o[0],s=o[1],m=Object(n.useState)(""),d=Object(O.a)(m,2),f=d[0],p=d[1],g=Object(X.c)();return Object(n.useEffect)((function(){ta("\u7ec4\u5458"),g(Ze(!0)),Ge.a.get(Me,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){c(e.users),s(e.users)})).catch((function(e){g(Qe("\u62c9\u53d6\u7ec4\u5458\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return g(Ze(!1))}))}),[]),Object(n.useEffect)((function(){if(""===f.trim())s(l);else{var e=new RegExp(f,"i"),a=l.filter((function(a){return a&&Object.values(a).some((function(a){return"string"===typeof a&&e.test(a)}))}));s(a)}}),[f,l]),r.a.createElement(da.a,null,r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement("div",{className:e.title},r.a.createElement(ia.a,{variant:"h2"},"\u7ec4\u5458")),r.a.createElement(Ca.a,{label:"\u641c\u7d22",fullWidth:!0,margin:"normal",variant:"outlined",value:f,onChange:function(e){return p(e.target.value)}}),0===u.length?r.a.createElement(ia.a,{variant:"body1",color:"textSecondary"},"\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ec4\u5458\u3002"):r.a.createElement(Lr,{users:u})))}var Mr=t(469),qr=Object(k.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},root:{width:"100%"},rootExpanded:{width:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1)},details:{alignItems:"center"},summary:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15)},userChip:{marginRight:e.spacing(1)},unreadHeading:{fontSize:e.typography.pxToRem(15),fontWeight:"bold"}}}));function Ur(e){var a=qr(),t=Object(n.useState)(),l=Object(O.a)(t,2),c=l[0],i=l[1],o=Object(n.useState)(""),u=Object(O.a)(o,2),s=u[0],m=u[1],d=Object(X.c)(),f=function(e){var a,t=[],n=Object(Mr.a)(c);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.mrn!==e&&t.push(r)}}catch(l){n.e(l)}finally{n.f()}i(t)};return Object(n.useEffect)((function(){ta("\u901a\u77e5"),d(Ze(!0)),Ge.a.get(Pe+"/profile/inbox",{headers:$e(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){"object"===typeof e.messages&&i(e.messages)})).catch((function(e){d(Qe("\u62c9\u53d6\u5217\u8868\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return d(Ze(!1))}))}),[]),r.a.createElement(da.a,null,r.a.createElement(F.a,{display:"flex",className:a.titleArea,flexDirection:"column"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h2"},"\u6211\u7684\u901a\u77e5")),r.a.createElement(F.a,{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",flexDirection:"column"},c&&c.map((function(e){return r.a.createElement(Vr,{message:e,expanded:s,setExpanded:m,deleteFromList:f,key:e.mrn})})))))}function Vr(e){var a=qr(),t=e.message,l=e.expanded,c=e.setExpanded,i=e.deleteFromList,o=Object(n.useState)(!1),u=Object(O.a)(o,2),s=u[0],m=u[1],d=Object(X.c)(),f=Object(n.useState)(),p=Object(O.a)(f,2),g=p[0],E=p[1];r.a.useEffect((function(){return m(t.unread)}),[]),r.a.useEffect((function(){l!==t.mrn||g||(d(Ze(!0)),Ge.a.get(Pe+"/message/"+t.mrn,{headers:$e(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a;"string"===typeof e.body&&E(e.body),s&&(m(!1),d((a=-1,function(e){e(Object.assign({type:"SET_NOTIFICATIONS"},{number:a}))})))})).catch((function(e){d(Qe("\u83b7\u53d6\u6d88\u606f\u5931\u8d25, \u8bf7\u5237\u65b0\u91cd\u8bd5","error"))})).finally((function(){return d(Ze(!1))})))}),[l]);return r.a.createElement("div",{className:l===t.mrn?a.rootExpanded:a.root},r.a.createElement(En.a,{TransitionProps:{unmountOnExit:!0},expanded:l===t.mrn,onChange:function(){l===t.mrn?c(""):c(t.mrn)}},r.a.createElement(hn.a,{expandIcon:r.a.createElement(pa.a,null),"aria-controls":"message-summary"},r.a.createElement(F.a,{display:"flex",alignItems:"center",flexDirection:"row",className:a.summary},r.a.createElement(fn,{user:t.from_by,className:a.userChip}),r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{className:s?a.unreadHeading:a.heading,noWrap:!0},t.title)),r.a.createElement(ia.a,null,ra(t.create_on)))),r.a.createElement(bn.a,{className:a.details},r.a.createElement(ia.a,{variant:"body1"},g)),r.a.createElement(C.a,null),r.a.createElement(vn.a,null,r.a.createElement(N.a,{onClick:function(){d(Ze(!0)),Ge.a.delete(Pe+"/message/"+t.mrn,{headers:$e(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){i(t.mrn)})).catch((function(e){try{console.log(e.response.data.detail),d(Qe(e.response.data.detail,"error"))}catch(a){d(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return d(Ze(!1))}))},color:"secondary",variant:"outlined",size:"small"},"\u5220\u9664\u6d88\u606f"))))}var Hr=Object(k.a)((function(e){return{titleArea:{marginTop:e.spacing(5),marginBottom:e.spacing(1)},coverCard:{maxWidth:275,position:"relative"},label:{marginTop:e.spacing(.5),marginRight:e.spacing(.5)}}}));function Yr(e){var a=Hr(),t=Object(b.i)().uid,l=Object(X.c)(),c=Object(b.g)(),i=Object(X.d)((function(e){return e.user.privilege})),o=Object(n.useState)({}),u=Object(O.a)(o,2),s=u[0],m=u[1],d=Object(n.useState)(),f=Object(O.a)(d,2),p=f[0],g=f[1];return r.a.useEffect((function(){l(Ze(!0)),Ge.a.get(Me+"/"+t,{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){m(e),ta(e.nickname)})).catch((function(e){l(Qe("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25","error"))})).finally((function(){return l(Ze(!1))}))}),[]),r.a.useEffect((function(){l(Ze(!0)),Ge.a.get(Me+"/"+t+"/tasks",{headers:$e(),withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){g(e.tasks)})).catch((function(e){l(Qe("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return l(Ze(!1))}))}),[]),r.a.createElement(da.a,{maxWidth:"lg"},r.a.createElement(F.a,{display:"flex",alignItems:"flex-end",className:a.titleArea},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,{variant:"h5"},"@",s.uid||r.a.createElement(Gt.a,null)),r.a.createElement(ia.a,{variant:"h2"},r.a.createElement(Hn.a,{component:E.b,to:"/user/"+t,color:"inherit"},s.nickname)||r.a.createElement(Gt.a,null))),r.a.createElement(F.a,null,i>2&&r.a.createElement(wr,{uid:s.uid}))),r.a.createElement(Aa.a,{container:!0,spacing:2},r.a.createElement(Aa.a,{item:!0,xs:12,md:3},r.a.createElement(F.a,{display:"flex",p:1,justifyContent:"center",flexDirection:"column",alignItems:"center"},s&&""!==s.avatar&&r.a.createElement(Ba.a,{className:a.coverCard},r.a.createElement(Fa.a,{component:"img",image:s.avatar,title:s.nickname})),r.a.createElement(F.a,{display:"flex",flexDirection:"column",style:{width:"100%"}},r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u52a0\u5165\u65f6\u95f4")),r.a.createElement(F.a,null,s&&na(s.join_time))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u6700\u540e\u4e00\u6b21\u6d3b\u8dc3")),r.a.createElement(F.a,null,s&&na(s.goo_timestamp))),r.a.createElement(F.a,{display:"flex",flexDirection:"row"},r.a.createElement(F.a,{flexGrow:1},r.a.createElement(ia.a,null,"\u6743\u9650")),r.a.createElement(F.a,null,s&&s.privilege)),r.a.createElement(F.a,null,r.a.createElement(ia.a,{paragraph:!0},s&&s.introduction))))),r.a.createElement(Aa.a,{item:!0,xs:12,md:9},r.a.createElement(ia.a,{variant:"h5",style:{marginBottom:"2rem"}},"\u4efb\u52a1"),r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},p&&r.a.createElement(Qa.a,{icons:_t,columns:[{title:"\u6f2b\u753b",field:"mname"},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"}},{title:"\u4e0a\u4e00\u6b21\u6d3b\u8dc3",field:"last_update",render:function(e){return ra(e.last_update)}},{title:"\u72b6\u6001",field:"status",render:function(e){return r.a.createElement(Zn,{status:e.status})},defaultSort:"asc"}],options:{pageSize:20},data:p,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,t){c.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})))))}var $r=t(263),Jr=t.n($r);function Kr(){var e=Object(b.g)();Object(n.useEffect)((function(){return ta("404")}),[]),Object(n.useEffect)((function(){setTimeout(a,3e3)}));var a=function(){return e.push("")};return r.a.createElement(da.a,{component:"main"},r.a.createElement(ia.a,{variant:"h1"},r.a.createElement(Jr.a,{style:{fontSize:90}}),"404\u4ec0\u4e48\u4e5f\u6ca1\u6709\u627e\u5230"))}var Xr=Object(k.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}}));function Qr(){var e=Xr(),a=new URLSearchParams(Object(b.h)().search),t=Object(X.c)(),l=Object(b.g)();Object(n.useEffect)((function(){return ta("\u6ce8\u518c")}),[]);return r.a.createElement(da.a,{component:"main",maxWidth:"xs"},r.a.createElement(w.a,null),r.a.createElement("div",{className:e.paper},r.a.createElement(fe.a,{className:e.avatar},r.a.createElement(Wt.a,null)),r.a.createElement(ia.a,{component:"h1",variant:"h5"},"\u6b22\u8fce\u52a0\u5165\u6c49\u5316\u5de5\u623f\u4e5d\u4e5d\u7ec4"),r.a.createElement(Na.b,{onSubmit:function(e){e.icode=a.get("icode"),console.log(e),e.password===e["re-password"]?(t(Ze(!0)),Ge.a.post(Pe+"/signup",e,{headers:$e(),validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){t(Qe("\u6ce8\u518c\u6210\u529f\uff0c\u8bf7\u767b\u5f55\u3002","success")),l.push("/")})).catch((function(e){try{console.log(e.response.data.detail),t(Qe(e.response.data.detail,"error"))}catch(a){t(Qe("\u672a\u77e5\u7684\u9519\u8bef","error"))}})).finally((function(){return t(Ze(!1))}))):t(Qe("\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4","error"))},render:function(e){var a=e.handleSubmit;return r.a.createElement("form",{onSubmit:a},r.a.createElement(za.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u7528\u6237ID",name:"uid",autoComplete:"uid",autoFocus:!0,helperText:"ID\u5c06\u88ab\u7528\u4e8e\u767b\u5f55"}),r.a.createElement(za.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,label:"\u6635\u79f0",name:"nickname"}),r.a.createElement(za.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"\u5bc6\u7801",type:"password",autoComplete:"current-password",helperText:"\u5bc6\u7801\u662f6-32\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u7a7a\u683c\u6216\u5982\u4e0b\u7279\u6b8a\u5b57\u7b26\u7684\u7ec4\u5408\u3002-+_!=@#$%^&*?([)].;:"}),r.a.createElement(za.c,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"re-password",label:"\u91cd\u590d\u5bc6\u7801",type:"password"}),r.a.createElement(N.a,{fullWidth:!0,variant:"contained",color:"primary",type:"submit"},"\u6ce8\u518c"))}})))}var Zr=Object(k.a)((function(e){return{userChip:{backgroundColor:"white",color:"black",cursor:"pointer","&:hover":{backgroundColor:"lightgray"}}}}));function el(e){var a=e.user,t=Object(b.g)(),n=Zr();return void 0===a?r.a.createElement(r.a.Fragment,null):r.a.createElement(Pa.a,Object.assign({"aria-label":"User Chip",onClick:function(e){e.stopPropagation(),t.push("/user/"+a.uid)},className:n.userChip,clickable:!0,avatar:r.a.createElement(De,{avatar:a.avatar,name:a.nickname}),label:a.nickname},e))}var al=Object(k.a)((function(e){return{smallBadge:{minWidth:"14px",width:"14px",height:"14px",fontSize:"10px",padding:"0",borderRadius:"50%"},lightBlueBadge:{backgroundColor:"lightBlue"},lightYellowBadge:{backgroundColor:"rgba(255, 255, 0, 0.5)"},lightRedBadge:{backgroundColor:"rgba(255, 82, 82, 0.5)"}}})),tl=function(e,a,t){return e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).length},nl=function(e,a,t){var n=e.filter((function(e){return e.mname===a&&String(e.type)===t&&e.wait_status%4>0})).map((function(e){return e.wait_status%4}));return n.length>0?Math.max.apply(Math,Object(Ka.a)(n)):0};function rl(e){var a=al(),t=Object(b.g)(),n=e.tasks,l=function(e){switch(e){case 1:return"".concat(a.smallBadge," ").concat(a.lightBlueBadge);case 2:return"".concat(a.smallBadge," ").concat(a.lightYellowBadge);case 3:return"".concat(a.smallBadge," ").concat(a.lightRedBadge);default:return a.smallBadge}};return r.a.createElement(Qa.a,{icons:_t,columns:[{title:"\u6f2b\u753b",field:"mname",defaultGroupOrder:1,render:function(e){var a=e.split("\u9e2a\u9e2a\u9e2a"),t=Object(O.a)(a,2),c=t[0],i=t[1];return r.a.createElement(se.a,{badgeContent:tl(n,e,i),anchorOrigin:{vertical:"top",horizontal:"right"},overlap:"rectangle",classes:{badge:l(nl(n,e,i))}},r.a.createElement("span",{style:{paddingRight:"10px"}},c))}},{title:"\u7ae0\u8282",field:"cname"},{title:"\u4efb\u52a1",field:"name"},{title:"\u7c7b\u578b",field:"type",lookup:{0:"\u5176\u4ed6",1:"\u56fe\u6e90",2:"\u7ffb\u8bd1",3:"\u6821\u5bf9",4:"\u5d4c\u5b57",5:"\u5ba1\u6838",6:"\u53d1\u5e03"},defaultGroupOrder:0},{title:"\u6807\u7b7e",field:"tags",grouping:!1,render:function(e){return r.a.createElement(r.a.Fragment,null,e.tags.map((function(e,a){return r.a.createElement(Ua,{tag:e,size:"small",key:a})})))},sorting:!1},{title:"\u7528\u6237",field:"accept_by",grouping:!1,render:function(e){return r.a.createElement(el,{user:e.accept_by})}},{title:"\u63a5\u53d6\u65f6\u95f4",field:"accept_on",render:function(e){return ra(e.accept_on)},grouping:!1}],options:{pageSize:20,grouping:!0,rowStyle:function(e){return{backgroundColor:{0:"transparent",1:"lightBlue",2:"rgba(255, 255, 0, 0.5)",3:"rgba(255, 82, 82, 0.5)"}[e.wait_status%4]||"transparent"}}},data:n,components:{Toolbar:function(e){return r.a.createElement(r.a.Fragment,null)}},onRowClick:function(e,a,n){t.push("/manga/"+a.mid+"/"+a.cid+"/"+a.id)},localization:{grouping:{placeholder:"\u62d6\u62fd\u8868\u5934\u81f3\u6b64\u4ee5\u805a\u5408\u663e\u793a...",groupedBy:"\u805a\u5408:"},pagination:{labelDisplayedRows:"\u7b2c{from}\u5230{to}\u884c \u5171 {count}\u884c",labelRowsSelect:"\u884c",labelRowsPerPage:"\u6bcf\u9875\u884c\u6570:",firstAriaLabel:"\u9996\u9875",firstTooltip:"\u9996\u9875",previousAriaLabel:"\u4e0a\u4e00\u9875",previousTooltip:"\u4e0a\u4e00\u9875",nextAriaLabel:"\u4e0b\u4e00\u9875",nextTooltip:"\u4e0b\u4e00\u9875",lastAriaLabel:"\u672b\u9875",lastTooltip:"\u672b\u9875"}}})}var ll=Object(k.a)((function(e){return{title:{marginTop:e.spacing(5),marginBottom:e.spacing(5)},taskListItem:{marginTop:e.spacing(1)}}}));function cl(){var e=ll(),a=Object(n.useState)([]),t=Object(O.a)(a,2),l=t[0],c=t[1],i=Object(X.c)();return Object(n.useEffect)((function(){ta("\u8fdb\u884c\u4e2d\u7684\u4efb\u52a1"),i(Ze(!0)),Ge.a.get("https://api.mikan.mom/running_task",{withCredentials:!0,validateStatus:function(e){return 200===e}}).then((function(e){return e.data})).then((function(e){var a=e.tasks.map((function(e){return Object(xa.a)({},e,{mname:"".concat(e.mname,"\u9e2a\u9e2a\u9e2a").concat(e.type)})}));c(a)})).catch((function(e){i(Qe("\u62c9\u53d6\u4efb\u52a1\u5217\u8868\u5931\u8d25","error"))})).finally((function(){return i(Ze(!1))}))}),[]),r.a.createElement(da.a,null,r.a.createElement(F.a,{display:"flex",style:{width:"100%"},flexDirection:"column"},r.a.createElement("div",{className:e.title},r.a.createElement(ia.a,{variant:"h2"},"\u8fdb\u884c\u4e2d\u7684\u4efb\u52a1")),r.a.createElement(rl,{tasks:l})))}function il(){return r.a.createElement(E.a,null,r.a.createElement(ma,null,r.a.createElement(b.d,null,r.a.createElement(b.b,{exact:!0,path:"/"},r.a.createElement(Ja,null)),r.a.createElement(b.b,{path:"/tasks"},r.a.createElement(Bt,null)),r.a.createElement(b.b,{path:"/runningTasks"},r.a.createElement(cl,null)),r.a.createElement(b.b,{path:"/login"},r.a.createElement(Lt,null)),r.a.createElement(b.b,{path:"/signup"},r.a.createElement(Qr,null)),r.a.createElement(Or,{path:"/me"},r.a.createElement(Rr,null)),r.a.createElement(b.b,{path:"/cloud"},r.a.createElement(Fr,null)),r.a.createElement(Or,{path:"/oauth2"},r.a.createElement(Wr,null)),r.a.createElement(Or,{path:"/users"},r.a.createElement(Pr,null)),r.a.createElement(Or,{path:"/message"},r.a.createElement(Ur,null)),r.a.createElement(b.b,{path:"/manga/:mid",children:r.a.createElement(yr,null)}),r.a.createElement(Or,{path:"/user/:uid",children:r.a.createElement(Yr,null)}),r.a.createElement(b.b,{path:"*"},r.a.createElement(Kr,null)))),r.a.createElement(Br,null))}var ol=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ul(e,a){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var sl=t(82),ml=Object(sl.c)({site:Fe,user:He}),dl=t(470),fl=Object(sl.e)(ml,Object(sl.a)(dl.a));c.a.render(r.a.createElement(X.a,{store:fl},r.a.createElement(i.a,{theme:g},r.a.createElement(Ar.SnackbarProvider,{anchorOrigin:{vertical:"bottom",horizontal:"right"}},r.a.createElement(il,null)))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var a="".concat("","/service-worker.js");ol?(!function(e,a){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ul(e,a)})).catch((function(){console.log("No internet connection found. Border is running in offline mode.")}))}(a,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ul(a,e)}))}}()}},[[5617,1,2]]]);
//# sourceMappingURL=main.0f0f318a.chunk.js.map